import{j as e,S as g,f as Rt,G as Lt,h as Bt,M as Vs,d as ae,_ as Hs,i as Ys,a as Wt,s as Ut,b as zt,g as Vt}from"./index-CiRwLPeh-1769119750716.js";import{r as c,R as gs}from"./charts-C6jPuoY4-1769119750716.js";import{u as Ht,i as te,a as Yt,b as Re}from"./LoyaltyProgram-C9XIFcjK-1769119750716.js";import{p as ie}from"./dateUtils-BfUzTcZq-1769119750716.js";import{NotificationService as Gt}from"./NotificationService-zFEosYM1-1769119750716.js";import{g as Jt}from"./location-C_GypjLJ-1769119750716.js";import{f as Zs,d as be,c as Fe,q as es,l as Qt,o as ss,h as et,u as Me,a as st,s as Gs,i as qt,j as Js,g as Kt,k as Xt}from"./firebase-Dp89RMPZ-1769119750716.js";import"./vendor-COd4auuD-1769119750716.js";const Qs=({user:n,onLogout:u,onContactSupport:h})=>{const[y,A]=c.useState(!1),k=c.useRef(null);Ht(),c.useEffect(()=>{const p=N=>{k.current&&!k.current.contains(N.target)&&A(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const j=p=>p.split(" ").map(N=>N[0]).join("").toUpperCase().slice(0,2);return e.jsxs("div",{className:"relative",ref:k,children:[e.jsx("button",{onClick:()=>A(!y),className:"w-10 h-10 rounded-full bg-gradient-to-br from-primary to-primary-dark flex items-center justify-center text-black font-bold text-sm shadow-lg hover:scale-105 transition-transform",children:n.avatar?e.jsx("img",{src:n.avatar,alt:n.name,className:"w-full h-full rounded-full object-cover"}):j(n.name)}),y&&e.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-slate-800 rounded-xl shadow-2xl border border-white/10 overflow-hidden z-50",children:[e.jsxs("div",{className:"p-4 border-b border-white/10",children:[e.jsx("p",{className:"font-bold text-white",children:n.name}),e.jsx("p",{className:"text-sm text-slate-400",children:n.email}),n.role&&e.jsx("span",{className:"inline-block mt-2 px-2 py-1 bg-primary/20 text-primary text-xs font-bold rounded-lg uppercase",children:n.role})]}),e.jsxs("div",{className:"p-2",children:[h&&n.role==="client"&&e.jsxs("button",{onClick:()=>{h(),A(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-left text-primary hover:bg-primary/10 rounded-lg transition-colors mb-1",children:[e.jsx("span",{className:"material-symbols-outlined text-xl",children:"support_agent"}),e.jsx("span",{className:"font-medium",children:te.t("contact_support")})]}),e.jsxs("button",{onClick:()=>{u(),A(!1)},className:"w-full flex items-center gap-3 px-3 py-2 text-left text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:[e.jsx("span",{className:"material-symbols-outlined text-xl",children:"logout"}),e.jsx("span",{className:"font-medium",children:te.t("logout")})]})]})]})]})},Zt=({discounts:n,navigate:u,currentUser:h,createDiscount:y,updateDiscount:A,deleteDiscount:k,showToast:j})=>{const[p,N]=c.useState(!1),[C,_]=c.useState(null),[S,l]=c.useState({code:"",type:"percentage",value:0,description:"",active:!0,validFrom:"",validUntil:"",usageLimit:void 0,applicableTo:"all",minimumOrderAmount:void 0}),d=t=>{t?(_(t),l({code:t.code,type:t.type,value:t.value,description:t.description,active:t.active,validFrom:t.validFrom||"",validUntil:t.validUntil||"",usageLimit:t.usageLimit,applicableTo:t.applicableTo,minimumOrderAmount:t.minimumOrderAmount})):(_(null),l({code:"",type:"percentage",value:0,description:"",active:!0,validFrom:"",validUntil:"",usageLimit:void 0,applicableTo:"all",minimumOrderAmount:void 0})),N(!0)},m=async()=>{if(!S.code||!S.description||S.value<=0){j("Please fill all required fields","error");return}try{const t={code:S.code.toUpperCase(),type:S.type,value:S.value,description:S.description,active:S.active,validFrom:S.validFrom||void 0,validUntil:S.validUntil||void 0,usageLimit:S.usageLimit,applicableTo:S.applicableTo,minimumOrderAmount:S.minimumOrderAmount,createdBy:h.id,createdDate:new Date().toISOString()};C?(await A(C.id,t),j("Discount updated successfully","success")):(await y(t),j("Discount created successfully","success")),N(!1)}catch{j("Error saving discount","error")}},f=async t=>{if(confirm("Are you sure you want to delete this discount?"))try{await k(t),j("Discount deleted","info")}catch{j("Error deleting discount","error")}},F=async t=>{try{await A(t.id,{active:!t.active}),j(`Discount ${t.active?"deactivated":"activated"}`,"success")}catch{j("Error updating discount","error")}},v=n.filter(t=>t.active),T=n.filter(t=>!t.active);return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white",children:[e.jsxs("header",{className:"p-4 border-b border-white/5 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>u(g.ADMIN_DASHBOARD),className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Discount Codes"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Manage promotional codes"})]})]}),e.jsxs("button",{onClick:()=>d(),className:"bg-primary hover:bg-primary-dark transition-colors px-4 py-2 rounded-lg font-bold flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined",children:"add"}),"New Discount"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-lg font-bold mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-green-400",children:"check_circle"}),"Active Discounts (",v.length,")"]}),e.jsx("div",{className:"space-y-3",children:v.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-500",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-20",children:"discount"}),e.jsx("p",{children:"No active discounts"})]}):v.map(t=>e.jsxs("div",{className:"bg-surface-dark rounded-xl p-4 border border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-bold text-primary",children:t.code}),e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-green-500/20 text-green-400",children:"Active"})]}),e.jsx("p",{className:"text-sm text-slate-300",children:t.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>d(t),className:"p-2 hover:bg-white/5 rounded-lg transition-colors",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),e.jsx("button",{onClick:()=>F(t),className:"p-2 hover:bg-white/5 rounded-lg transition-colors",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"visibility_off"})}),e.jsx("button",{onClick:()=>f(t.id),className:"p-2 hover:bg-red-500/10 rounded-lg transition-colors text-red-400",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{className:"bg-black/20 rounded-lg p-2",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Discount"}),e.jsx("p",{className:"font-bold text-primary",children:t.type==="percentage"?`${t.value}%`:`$${t.value}`})]}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-2",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Used"}),e.jsxs("p",{className:"font-bold",children:[t.usageCount,t.usageLimit?`/${t.usageLimit}`:""]})]}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-2",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Valid Until"}),e.jsx("p",{className:"font-bold text-xs",children:t.validUntil?new Date(t.validUntil).toLocaleDateString():"No limit"})]}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-2",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Min. Order"}),e.jsx("p",{className:"font-bold text-xs",children:t.minimumOrderAmount?`$${t.minimumOrderAmount}`:"None"})]})]})]},t.id))})]}),T.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-bold mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"cancel"}),"Inactive Discounts (",T.length,")"]}),e.jsx("div",{className:"space-y-3",children:T.map(t=>e.jsx("div",{className:"bg-surface-dark/50 rounded-xl p-4 border border-white/5 opacity-60",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-lg font-bold",children:t.code}),e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-slate-500/20 text-slate-400",children:"Inactive"})]}),e.jsx("p",{className:"text-sm text-slate-400",children:t.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>F(t),className:"p-2 hover:bg-white/5 rounded-lg transition-colors",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"visibility"})}),e.jsx("button",{onClick:()=>f(t.id),className:"p-2 hover:bg-red-500/10 rounded-lg transition-colors text-red-400",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]})},t.id))})]})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-surface-dark rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center sticky top-0 bg-surface-dark",children:[e.jsx("h2",{className:"text-xl font-bold",children:C?"Edit Discount":"New Discount"}),e.jsx("button",{onClick:()=>N(!1),className:"p-2 hover:bg-white/5 rounded-lg",children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Discount Code *"}),e.jsx("input",{type:"text",value:S.code,onChange:t=>l({...S,code:t.target.value.toUpperCase()}),className:"w-full bg-black/20 border border-white/10 rounded-lg px-4 py-3 text-white uppercase",placeholder:"SUMMER2024"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Description *"}),e.jsx("input",{type:"text",value:S.description,onChange:t=>l({...S,description:t.target.value}),className:"w-full bg-black/20 border border-white/10 rounded-lg px-4 py-3 text-white",placeholder:"Summer promotion discount"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Type *"}),e.jsxs("select",{value:S.type,onChange:t=>l({...S,type:t.target.value}),className:"w-full bg-black/20 border border-white/10 rounded-lg px-4 py-3 text-white",children:[e.jsx("option",{value:"percentage",className:"bg-surface-dark text-white",children:"Percentage"}),e.jsx("option",{value:"fixed",className:"bg-surface-dark text-white",children:"Fixed Amount"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Value *"}),e.jsx("input",{type:"number",value:S.value,onChange:t=>l({...S,value:parseFloat(t.target.value)}),className:"w-full bg-black/20 border border-white/10 rounded-lg px-4 py-3 text-white",placeholder:S.type==="percentage"?"10":"5.00",step:S.type==="percentage"?"1":"0.01"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Valid From (Optional)"}),e.jsx("input",{type:"date",value:S.validFrom,onChange:t=>l({...S,validFrom:t.target.value}),className:"w-full bg-black/20 border border-white/10 rounded-lg px-4 py-3 text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Valid Until (Optional)"}),e.jsx("input",{type:"date",value:S.validUntil,onChange:t=>l({...S,validUntil:t.target.value}),className:"w-full bg-black/20 border border-white/10 rounded-lg px-4 py-3 text-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Usage Limit (Optional)"}),e.jsx("input",{type:"number",value:S.usageLimit||"",onChange:t=>l({...S,usageLimit:t.target.value?parseInt(t.target.value):void 0}),className:"w-full bg-black/20 border border-white/10 rounded-lg px-4 py-3 text-white",placeholder:"Unlimited"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Min. Order Amount (Optional)"}),e.jsx("input",{type:"number",value:S.minimumOrderAmount||"",onChange:t=>l({...S,minimumOrderAmount:t.target.value?parseFloat(t.target.value):void 0}),className:"w-full bg-black/20 border border-white/10 rounded-lg px-4 py-3 text-white",placeholder:"No minimum",step:"0.01"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Applicable To"}),e.jsxs("select",{value:S.applicableTo,onChange:t=>l({...S,applicableTo:t.target.value}),className:"w-full bg-black/20 border border-white/10 rounded-lg px-4 py-3 text-white",children:[e.jsx("option",{value:"all",className:"bg-surface-dark text-white",children:"All Services"}),e.jsx("option",{value:"packages",className:"bg-surface-dark text-white",children:"Packages Only"}),e.jsx("option",{value:"addons",className:"bg-surface-dark text-white",children:"Add-ons Only"}),e.jsx("option",{value:"total",className:"bg-surface-dark text-white",children:"Order Total"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:S.active,onChange:t=>l({...S,active:t.target.checked}),className:"w-5 h-5"}),e.jsx("label",{className:"text-sm font-bold",children:"Active (visible to clients)"})]})]}),e.jsxs("div",{className:"p-6 border-t border-white/5 flex gap-3",children:[e.jsx("button",{onClick:()=>N(!1),className:"flex-1 bg-white/5 hover:bg-white/10 transition-colors rounded-lg py-3 font-bold",children:"Cancel"}),e.jsxs("button",{onClick:m,className:"flex-1 bg-primary hover:bg-primary-dark transition-colors rounded-lg py-3 font-bold",children:[C?"Update":"Create"," Discount"]})]})]})}),e.jsx(ea,{active:g.ADMIN_DISCOUNTS,navigate:u})]})},ea=({active:n,navigate:u})=>e.jsx("div",{className:"sticky bottom-0 bg-background-dark border-t border-white/10 p-2 flex justify-around z-20 overflow-x-auto",children:e.jsx("div",{className:"flex justify-around w-full max-w-lg mx-auto min-w-[350px]",children:[{s:g.ADMIN_DASHBOARD,i:"grid_view",l:"Orders"},{s:g.ADMIN_TEAM,i:"group",l:"Team"},{s:g.ADMIN_CLIENTS,i:"person",l:"Clients"},{s:g.ADMIN_PRICING,i:"sell",l:"Services"},{s:g.ADMIN_ANALYTICS,i:"monitoring",l:"Metrics"}].map(h=>e.jsxs("button",{onClick:()=>u(h.s),className:`flex flex-col items-center p-2 min-w-[50px] ${n===h.s?"text-primary":"text-slate-500"}`,children:[e.jsx("span",{className:"material-symbols-outlined text-xl",children:h.i}),e.jsx("span",{className:"text-[10px] mt-1 font-medium",children:h.l})]},h.s))})}),sa=({bonuses:n,team:u,navigate:h,currentUser:y,createBonus:A,updateBonus:k,deleteBonus:j,showToast:p})=>{const[N,C]=c.useState(!1),[_,S]=c.useState({washerId:"",washerName:"",amount:0,reason:""}),l=u.filter(t=>t.role==="washer"&&t.status==="Active"),d=n.filter(t=>t.status==="pending"),m=n.filter(t=>t.status==="applied"),f=()=>{S({washerId:"",washerName:"",amount:0,reason:""}),C(!0)},F=async()=>{if(!_.washerId||!_.amount||!_.reason){p("Please fill all fields","error");return}try{await A({washerId:_.washerId,washerName:_.washerName,amount:_.amount,reason:_.reason,date:new Date().toISOString(),createdBy:y.id,createdByName:y.name}),p("Bonus created successfully","success"),C(!1)}catch{p("Error creating bonus","error")}},v=async t=>{if(confirm("Are you sure you want to delete this bonus?"))try{await j(t),p("Bonus deleted","info")}catch{p("Error deleting bonus","error")}},T=t=>{const L=l.find(B=>B.id===t);S({..._,washerId:t,washerName:(L==null?void 0:L.name)||""})};return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white",children:[e.jsxs("header",{className:"p-4 border-b border-white/5 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Bonus Management"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Reward your washers"})]}),e.jsxs("button",{onClick:f,className:"bg-primary hover:bg-primary-dark transition-colors px-4 py-2 rounded-lg font-bold flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined",children:"add"}),"New Bonus"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 pb-20",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-lg font-bold mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-yellow-400",children:"schedule"}),"Pending Bonuses (",d.length,")"]}),e.jsx("div",{className:"space-y-3",children:d.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-500",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-20",children:"card_giftcard"}),e.jsx("p",{children:"No pending bonuses"})]}):d.map(t=>e.jsxs("div",{className:"bg-surface-dark rounded-xl p-4 border border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xl font-bold",children:t.washerName}),e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-yellow-500/20 text-yellow-400",children:"Pending"})]}),e.jsx("p",{className:"text-sm text-slate-300 mb-2",children:t.reason}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Created by ",t.createdByName," on ",new Date(t.date).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2",children:[e.jsxs("span",{className:"text-2xl font-bold text-green-400",children:["+$",t.amount.toFixed(2)]}),e.jsx("button",{onClick:()=>v(t.id),className:"p-2 hover:bg-red-500/10 rounded-lg transition-colors text-red-400",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]}),e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-2 text-xs text-yellow-400",children:[e.jsx("span",{className:"material-symbols-outlined text-sm mr-1",children:"info"}),"Will be applied on next payment"]})]},t.id))})]}),m.length>0&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-bold mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-green-400",children:"check_circle"}),"Applied Bonuses (",m.length,")"]}),e.jsx("div",{className:"space-y-3",children:m.map(t=>e.jsx("div",{className:"bg-surface-dark/50 rounded-xl p-4 border border-white/5 opacity-70",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-bold",children:t.washerName}),e.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-green-500/20 text-green-400",children:"Applied"})]}),e.jsx("p",{className:"text-sm text-slate-400",children:t.reason}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:new Date(t.date).toLocaleDateString()})]}),e.jsxs("span",{className:"text-lg font-bold text-green-400",children:["+$",t.amount.toFixed(2)]})]})},t.id))})]})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-surface-dark rounded-2xl w-full max-w-md",children:[e.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"New Bonus"}),e.jsx("button",{onClick:()=>C(!1),className:"p-2 hover:bg-white/5 rounded-lg",children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Washer *"}),e.jsxs("select",{value:_.washerId,onChange:t=>T(t.target.value),className:"w-full bg-black/20 border border-white/10 rounded-lg px-4 py-3 text-white",children:[e.jsx("option",{value:"",children:"Select a washer"}),l.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Amount *"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",children:"$"}),e.jsx("input",{type:"number",value:_.amount||"",onChange:t=>S({..._,amount:parseFloat(t.target.value)||0}),className:"w-full bg-black/20 border border-white/10 rounded-lg pl-8 pr-4 py-3 text-white",placeholder:"50.00",step:"0.01"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Reason *"}),e.jsx("textarea",{value:_.reason,onChange:t=>S({..._,reason:t.target.value}),className:"w-full bg-black/20 border border-white/10 rounded-lg px-4 py-3 text-white resize-none",placeholder:"Excellent customer service, went above and beyond...",rows:3})]})]}),e.jsxs("div",{className:"p-6 border-t border-white/5 flex gap-3",children:[e.jsx("button",{onClick:()=>C(!1),className:"flex-1 bg-white/5 hover:bg-white/10 transition-colors rounded-lg py-3 font-bold",children:"Cancel"}),e.jsx("button",{onClick:F,className:"flex-1 bg-primary hover:bg-primary-dark transition-colors rounded-lg py-3 font-bold",children:"Create Bonus"})]})]})}),e.jsx(ta,{active:g.ADMIN_PAYROLL,navigate:h})]})},ta=({active:n,navigate:u})=>e.jsx("div",{className:"sticky bottom-0 bg-background-dark border-t border-white/10 p-2 flex justify-around z-20 overflow-x-auto",children:e.jsx("div",{className:"flex justify-around w-full max-w-lg mx-auto min-w-[350px]",children:[{s:g.ADMIN_DASHBOARD,i:"grid_view",l:"Orders"},{s:g.ADMIN_TEAM,i:"group",l:"Team"},{s:g.ADMIN_CLIENTS,i:"person",l:"Clients"},{s:g.ADMIN_PRICING,i:"sell",l:"Services"},{s:g.ADMIN_ANALYTICS,i:"monitoring",l:"Metrics"}].map(h=>e.jsxs("button",{onClick:()=>u(h.s),className:`flex flex-col items-center p-2 min-w-[50px] ${n===h.s?"text-primary":"text-slate-500"}`,children:[e.jsx("span",{className:"material-symbols-outlined text-xl",children:h.i}),e.jsx("span",{className:"text-[10px] mt-1 font-medium",children:h.l})]},h.s))})}),qs=[{name:"Los Angeles",lat:34.0522,lng:-118.2437},{name:"Santa Monica",lat:34.0195,lng:-118.4912},{name:"Beverly Hills",lat:34.0736,lng:-118.4004},{name:"West Hollywood",lat:34.09,lng:-118.3617},{name:"Pasadena",lat:34.1478,lng:-118.1445},{name:"Long Beach",lat:33.7701,lng:-118.1937},{name:"Glendale",lat:34.1425,lng:-118.2474},{name:"Burbank",lat:34.1808,lng:-118.309},{name:"Inglewood",lat:33.9617,lng:-118.3531},{name:"Culver City",lat:34.0211,lng:-118.3965},{name:"Torrance",lat:33.8358,lng:-118.3406},{name:"Compton",lat:33.8958,lng:-118.2201},{name:"Downey",lat:33.9401,lng:-118.1332},{name:"Norwalk",lat:33.9022,lng:-118.0817},{name:"Anaheim",lat:33.8366,lng:-117.9143},{name:"Santa Ana",lat:33.7455,lng:-117.8677},{name:"Irvine",lat:33.6846,lng:-117.8265},{name:"Huntington Beach",lat:33.6603,lng:-117.9992},{name:"Newport Beach",lat:33.6189,lng:-117.9289},{name:"Malibu",lat:34.0259,lng:-118.7798}],aa={width:"100%",height:"100%"},la=["places","geometry"],ra=({serviceArea:n,onSave:u})=>{const{isLoaded:h}=Rt({id:"google-map-script",googleMapsApiKey:"AIzaSyAJsxt6sbl2mwtXehLgB6cF1rjiOD8x2PU",libraries:la}),[y,A]=c.useState((n==null?void 0:n.centerLat)||34.0522),[k,j]=c.useState((n==null?void 0:n.centerLng)||-118.2437),[p,N]=c.useState((n==null?void 0:n.radiusMiles)||15),[C,_]=c.useState((n==null?void 0:n.cityName)||"Los Angeles"),[S,l]=c.useState(null);c.useEffect(()=>{n&&(A(n.centerLat),j(n.centerLng),N(n.radiusMiles),_(n.cityName||""))},[n]);const d=()=>{u({centerLat:y,centerLng:k,radiusMiles:p,cityName:C})},m=c.useMemo(()=>qs.filter(v=>Jt(v.lat,v.lng,y,k)<=p),[y,k,p]),f=c.useCallback(v=>{l(v)},[]),F=c.useCallback(v=>{l(null)},[]);return c.useEffect(()=>{S&&S.panTo({lat:y,lng:k})},[y,k,S]),h?e.jsxs("div",{className:"bg-surface-dark rounded-2xl border border-white/10 p-6 flex flex-col md:flex-row gap-6 h-[800px]",children:[e.jsxs("div",{className:"w-full md:w-1/3 flex flex-col h-full",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-primary",children:"location_on"}),"Service Area"]}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs uppercase text-slate-400 font-bold mb-2",children:"City Name"}),e.jsx("input",{type:"text",value:C,onChange:v=>_(v.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:border-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs uppercase text-slate-400 font-bold mb-2",children:["Radius: ",e.jsxs("span",{className:"text-primary text-lg ml-1",children:[p," miles"]})]}),e.jsx("input",{type:"range",min:"1",max:"80",value:p,onChange:v=>N(Number(v.target.value)),className:"w-full h-2 bg-white/10 rounded-full appearance-none cursor-pointer accent-primary"})]})]}),e.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col bg-black/20 rounded-xl border border-white/5",children:[e.jsx("div",{className:"p-3 border-b border-white/5 bg-white/5",children:e.jsxs("h4",{className:"font-bold text-sm",children:["Covered Cities (",m.length,")"]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:[m.map(v=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-green-500/10 text-green-400 border border-green-500/20",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"check_circle"}),e.jsx("span",{className:"text-sm font-bold",children:v.name})]},v.name)),m.length===0&&e.jsx("p",{className:"text-slate-500 text-sm text-center py-4",children:"No cities in range"})]})]}),e.jsxs("button",{onClick:d,className:"w-full py-4 bg-primary rounded-xl font-bold text-black hover:bg-primary/90 transition-colors mt-4 flex items-center justify-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined",children:"save"}),"Save Configuration"]})]}),e.jsxs("div",{className:"flex-1 rounded-2xl overflow-hidden border border-white/10 relative z-0",children:[e.jsxs(Lt,{mapContainerStyle:aa,center:{lat:y,lng:k},zoom:10,onLoad:f,onUnmount:F,options:{styles:[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]}],disableDefaultUI:!0,zoomControl:!0},children:[e.jsx(Bt,{center:{lat:y,lng:k},radius:p*1609.34,options:{fillColor:"#136dec",fillOpacity:.2,strokeColor:"#136dec",strokeOpacity:.8,strokeWeight:2,clickable:!1,draggable:!1,editable:!1}}),e.jsx(Vs,{position:{lat:y,lng:k},draggable:!0,onDragEnd:v=>{v.latLng&&(A(v.latLng.lat()),j(v.latLng.lng()))}}),qs.map(v=>{const T=m.some(t=>t.name===v.name);return e.jsx(Vs,{position:{lat:v.lat,lng:v.lng},opacity:T?1:.5,icon:{path:google.maps.SymbolPath.CIRCLE,scale:5,fillColor:T?"#22c55e":"#ef4444",fillOpacity:1,strokeWeight:0},title:v.name},v.name)})]}),e.jsxs("div",{className:"absolute top-4 right-4 bg-black/80 backdrop-blur-sm p-3 rounded-xl border border-white/10 z-10 w-fit",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs mb-1",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-primary/20 border border-primary"}),e.jsx("span",{className:"text-white",children:"Service Area"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-green-400",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"circle"}),e.jsx("span",{className:"text-white",children:"Covered City"})]})]}),e.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 bg-black/70 backdrop-blur-md px-4 py-2 rounded-full text-xs text-white border border-white/20 z-10",children:"Drag the center marker to move service area"})]})]}):e.jsx("div",{className:"w-full h-[800px] bg-slate-800 animate-pulse rounded-xl flex items-center justify-center text-slate-500",children:"Loading Maps..."})},ia=[{id:"compact_car",name:"Compact Car",mainCategory:"cars_suvs",subCategory:"car",size:"small",basePrice:50,icon:"ðŸš—",examples:["Honda Civic","Toyota Corolla","Mazda 3"],description:"Small sedans and hatchbacks",active:!0,order:1},{id:"midsize_sedan",name:"Mid-Size Sedan",mainCategory:"cars_suvs",subCategory:"car",size:"medium",basePrice:60,icon:"ðŸš™",examples:["Honda Accord","Toyota Camry","Nissan Altima"],description:"Standard 4-door sedans",active:!0,order:2},{id:"suv",name:"SUV",mainCategory:"cars_suvs",subCategory:"suv",size:"medium",basePrice:70,icon:"ðŸš",examples:["Honda CR-V","Toyota RAV4","Nissan Rogue"],description:"Compact and mid-size SUVs",active:!0,order:3},{id:"large_suv",name:"Large SUV",mainCategory:"cars_suvs",subCategory:"suv",size:"large",basePrice:80,icon:"ðŸš",examples:["Chevy Tahoe","Ford Expedition","Toyota Sequoia"],description:"Full-size SUVs with 3 rows",active:!0,order:4},{id:"compact_truck",name:"Compact Pickup",mainCategory:"trucks",subCategory:"pickup",size:"small",basePrice:60,icon:"ðŸ›»",examples:["Toyota Tacoma","Chevy Colorado","Ford Ranger"],description:"Mid-size pickup trucks",active:!0,order:5},{id:"fullsize_truck",name:"Full-Size Pickup",mainCategory:"trucks",subCategory:"pickup",size:"large",basePrice:75,icon:"ðŸ›»",examples:["Ford F-150","Chevy Silverado 1500","Ram 1500"],description:"Standard half-ton pickups",active:!0,order:6},{id:"heavy_duty_truck",name:"Heavy Duty Pickup",mainCategory:"trucks",subCategory:"pickup",size:"xlarge",basePrice:90,icon:"ðŸ›»",examples:["Ford F-250/350","Chevy Silverado 2500/3500"],description:"Heavy duty work trucks",active:!0,order:7},{id:"minivan",name:"Minivan",mainCategory:"vans",subCategory:"van",size:"medium",basePrice:55,icon:"ðŸš",examples:["Honda Odyssey","Toyota Sienna","Chrysler Pacifica"],description:"Family minivans",active:!0,order:8},{id:"cargo_van",name:"Cargo Van",mainCategory:"vans",subCategory:"van",size:"large",basePrice:65,icon:"ðŸš",examples:["Ford Transit","Mercedes Sprinter (Cargo)","Ram ProMaster"],description:"Commercial cargo vans",active:!0,order:9},{id:"class_b_rv",name:"Class B RV",mainCategory:"rvs",subCategory:"rv",size:"large",basePrice:150,icon:"ðŸš",examples:["Mercedes Sprinter RV","Winnebago Revel"],description:"Camper vans",active:!0,order:10},{id:"class_c_rv",name:"Class C RV",mainCategory:"rvs",subCategory:"rv",size:"xlarge",basePrice:250,icon:"ðŸš",examples:["Winnebago Minnie Winnie","Thor Motor Coach"],description:"Mid-size motorhomes with cab-over",active:!0,order:11},{id:"class_a_rv",name:"Class A RV",mainCategory:"rvs",subCategory:"rv",size:"massive",basePrice:400,icon:"ðŸšŒ",examples:["Newmar Dutch Star","Tiffin Allegro Bus"],description:"Large bus-style motorhomes",active:!0,order:12},{id:"semi_truck_cab",name:"Semi Truck (Cab Only)",mainCategory:"commercial",subCategory:"truck",size:"xlarge",basePrice:150,icon:"ðŸš›",examples:["Peterbilt 389","Kenworth W900","Freightliner Cascadia"],description:"Commercial semi-truck cab without trailer",active:!0,order:13},{id:"semi_truck_trailer",name:"Semi Truck + Trailer",mainCategory:"commercial",subCategory:"truck",size:"massive",basePrice:300,icon:"ðŸš›",examples:["Semi with 53' Trailer"],description:"Full commercial rig with trailer",active:!0,order:14}],na=[{id:"package_basic",name:"Basic Wash",description:"Exterior wash, wheel cleaning, and tire shine.",price:{compact_car:30,midsize_sedan:35,suv:45,large_suv:55,compact_truck:45,fullsize_truck:55,heavy_duty_truck:65,minivan:50,cargo_van:60,class_b_rv:100,class_c_rv:150,class_a_rv:200,semi_truck_cab:100,semi_truck_trailer:200,sedan:30,SUV:45,Truck:55,Van:50},duration:"45 min",features:["Hand Wash","Wheel Cleaning","Tire Shine","Exterior Windows"]},{id:"package_premium",name:"Premium Detail",description:"Full interior & exterior detail with wax.",price:{compact_car:100,midsize_sedan:120,suv:140,large_suv:160,compact_truck:140,fullsize_truck:160,heavy_duty_truck:180,minivan:150,cargo_van:170,class_b_rv:250,class_c_rv:350,class_a_rv:450,semi_truck_cab:250,semi_truck_trailer:450,sedan:120,SUV:140,Truck:160,Van:150},duration:"2 hours",features:["Hand Wash & Wax","Interior Vacuum","Leather Clean/Condition","Dashboard Wipe","Door Jambs"]},{id:"package_deluxe",name:"Showroom Deluxe",description:"The ultimate restoration package. Paint correction not included.",price:{compact_car:200,midsize_sedan:220,suv:250,large_suv:300,compact_truck:250,fullsize_truck:300,heavy_duty_truck:350,minivan:280,cargo_van:320,class_b_rv:500,class_c_rv:700,class_a_rv:900,semi_truck_cab:500,semi_truck_trailer:900,sedan:220,SUV:250,Truck:300,Van:280},duration:"4 hours",features:["Clay Bar","Machine Buff & Wax","Shampoo Carpets/Seats","Steam Clean Vents","Engine Bay Detail"]}],da=async()=>{try{const n=Zs(ae);return ia.forEach(u=>{const h=be(ae,"vehicle_types",u.id);n.set(h,u)}),await n.commit(),console.log("âœ… Vehicle types seeded successfully"),!0}catch(n){return console.error("âŒ Error seeding vehicle types:",n),!1}},oa=async()=>{try{const n=Zs(ae);return na.forEach(u=>{const h=be(ae,"packages",u.id);n.set(h,u)}),await n.commit(),console.log("âœ… Service packages seeded successfully"),!0}catch(n){return console.error("âŒ Error seeding service packages:",n),!1}},ca=({currentUser:n,navigate:u})=>{const[h,y]=c.useState([]),[A,k]=c.useState(null),j=h.find(t=>t.id===A)||null,[p,N]=c.useState([]),[C,_]=c.useState(""),[S,l]=c.useState("open"),d=c.useRef(null);c.useEffect(()=>{const t=Fe(ae,"supportTickets"),L=es(t,Qt(100)),B=ss(L,I=>{const P=I.docs.map(O=>{const Y=O.data(),G=Y.status==="closed"?"closed":"open";return{id:O.id,...Y,status:G}});y(P.sort((O,Y)=>{var G,ce,Ne,fe;return(((ce=(G=Y.lastMessageAt)==null?void 0:G.toMillis)==null?void 0:ce.call(G))||0)-(((fe=(Ne=O.lastMessageAt)==null?void 0:Ne.toMillis)==null?void 0:fe.call(Ne))||0)}))});return()=>B()},[]),c.useEffect(()=>{if(!A){N([]);return}const t=Fe(ae,"supportTickets",A,"messages"),L=es(t,et("timestamp","asc")),B=ss(L,async I=>{const P=I.docs.map(Y=>({id:Y.id,...Y.data()}));N(P.sort((Y,G)=>{var ce,Ne,fe,Le;return(((Ne=(ce=Y.timestamp)==null?void 0:ce.toMillis)==null?void 0:Ne.call(ce))||0)-(((Le=(fe=G.timestamp)==null?void 0:fe.toMillis)==null?void 0:Le.call(fe))||0)})),m();const O=I.docs.filter(Y=>{const G=Y.data();return(G.senderRole==="client"||G.senderRole==="washer")&&!G.read});for(const Y of O)await Me(be(ae,"supportTickets",j.id,"messages",Y.id),{read:!0});O.length>0&&await Me(be(ae,"supportTickets",A),{unreadByAdmin:0,status:"open"})});return()=>B()},[A]);const m=()=>{var t;(t=d.current)==null||t.scrollIntoView({behavior:"smooth"})},f=async()=>{if(!(!C.trim()||!j||!n))try{await st(Fe(ae,"supportTickets",j.id,"messages"),{senderId:n.id,senderName:n.name||"Admin",senderRole:"admin",message:C.trim(),timestamp:Gs(),read:!1});const t=p.filter(L=>L.senderRole==="admin"&&!L.read).length+1;await Me(be(ae,"supportTickets",j.id),{lastMessageAt:Gs(),unreadByClient:t,status:"open"}),_("")}catch(t){console.error("Error sending message:",t)}},F=async()=>{if(j)try{await Me(be(ae,"supportTickets",j.id),{status:"closed"}),k(null)}catch(t){console.error("Error closing ticket:",t)}},v=async()=>{if(j)try{await Me(be(ae,"supportTickets",j.id),{status:"open"})}catch(t){console.error("Error reopening ticket:",t)}},T=t=>{if(!(t!=null&&t.toDate))return"";const L=new Date,B=t.toDate(),I=L.getTime()-B.getTime(),P=Math.floor(I/6e4);if(P<1)return"Just now";if(P<60)return`${P}m ago`;const O=Math.floor(P/60);return O<24?`${O}h ago`:`${Math.floor(O/24)}d ago`};return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white relative",children:[e.jsxs("header",{className:`px-4 py-4 border-b border-white/10 flex items-center justify-between shrink-0 ${j?"hidden md:flex":"flex"}`,children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Support Tickets"}),e.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:[h.filter(t=>t.status==="open").length," open tickets"]})]}),e.jsx("button",{onClick:()=>u("ADMIN_DASHBOARD"),className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsxs("div",{className:"flex flex-1 overflow-hidden relative",children:[e.jsxs("div",{className:`w-full md:w-80 border-r border-white/10 flex flex-col bg-background-dark absolute md:relative inset-0 z-10 md:z-auto transition-transform duration-300 ${j?"-translate-x-full md:translate-x-0":"translate-x-0"}`,children:[e.jsx("div",{className:"p-3 border-b border-white/10 flex gap-2 shrink-0",children:["all","open","closed"].map(t=>e.jsx("button",{onClick:()=>l(t),className:`px-3 py-1.5 rounded-lg text-xs font-bold transition-all flex-1 ${S===t?"bg-primary text-white":"bg-white/5 text-slate-400 hover:bg-white/10"}`,children:t.charAt(0).toUpperCase()+t.slice(1)},t))}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:h.length===0?e.jsxs("div",{className:"p-8 text-center text-slate-500",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-20",children:"inbox"}),e.jsx("p",{className:"text-sm",children:"No tickets found"})]}):h.map(t=>e.jsxs("button",{onClick:()=>k(t.id),className:`w-full p-4 border-b border-white/5 hover:bg-white/5 transition-colors text-left ${A===t.id?"bg-white/10":""}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold text-sm truncate text-white",children:t.userName||"Guest User"}),t.userRole==="washer"&&e.jsx("span",{className:"bg-blue-500/20 text-blue-400 text-[10px] font-bold px-1.5 py-0.5 rounded uppercase",children:"WASHER"})]}),e.jsx("p",{className:"text-xs text-slate-400 truncate",children:t.userEmail||"No contact info"}),t.source&&e.jsxs("p",{className:"text-[10px] text-primary/80 mt-0.5 truncate flex items-center gap-1",children:[e.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"public"}),t.source]})]}),t.unreadByAdmin>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full shrink-0",children:t.unreadByAdmin})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${t.status==="open"?"bg-green-500/20 text-green-400":"bg-slate-500/20 text-slate-400"}`,children:t.status}),e.jsx("span",{className:"text-xs text-slate-500",children:T(t.lastMessageAt)})]})]},t.id))})]}),e.jsx("div",{className:`flex-1 flex flex-col bg-background-dark absolute md:relative inset-0 z-20 md:z-auto transition-transform duration-300 ${j?"translate-x-0":"translate-x-full md:translate-x-0"}`,children:j?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-3 md:p-4 border-b border-white/10 flex items-center justify-between bg-surface-dark shrink-0 shadow-md md:shadow-none",children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[e.jsx("button",{onClick:()=>k(null),className:"md:hidden p-2 -ml-2 text-white/80 hover:text-white",children:e.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"font-bold truncate",children:j.userName||"Guest User"}),j.userRole==="washer"&&e.jsx("span",{className:"bg-blue-500/20 text-blue-400 text-[10px] font-bold px-1.5 py-0.5 rounded uppercase",children:"WASHER"})]}),e.jsx("p",{className:"text-xs text-slate-400 truncate",children:j.userEmail||"No contact info"}),j.source&&e.jsxs("p",{className:"text-[10px] text-primary/80 flex items-center gap-1 mt-0.5",children:[e.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"public"}),j.source]})]})]}),e.jsx("div",{className:"flex gap-2 shrink-0 ml-2",children:j.status==="open"?e.jsxs("button",{onClick:F,className:"px-3 py-1.5 md:px-4 md:py-2 bg-green-500/20 text-green-400 rounded-lg text-xs md:text-sm font-bold hover:bg-green-500/30 transition-colors flex items-center gap-1 md:gap-2 whitespace-nowrap",children:[e.jsx("span",{className:"material-symbols-outlined text-sm md:text-base",children:"check_circle"}),e.jsx("span",{className:"hidden sm:inline",children:"Close Ticket"}),e.jsx("span",{className:"sm:hidden",children:"Close"})]}):e.jsxs("button",{onClick:v,className:"px-3 py-1.5 md:px-4 md:py-2 bg-amber-500/20 text-amber-400 rounded-lg text-xs md:text-sm font-bold hover:bg-amber-500/30 transition-colors flex items-center gap-1 md:gap-2 whitespace-nowrap",children:[e.jsx("span",{className:"material-symbols-outlined text-sm md:text-base",children:"refresh"}),e.jsx("span",{className:"hidden sm:inline",children:"Reopen"}),e.jsx("span",{className:"sm:hidden",children:"Open"})]})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-background-dark scroll-smooth",children:[p.map(t=>{var I;const L=t.senderRole==="admin",B=t.senderId==="system";return e.jsx("div",{className:`flex ${L?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[85%] md:max-w-md px-4 py-3 rounded-2xl text-sm md:text-base shadow-sm ${B?"bg-slate-700/50 text-slate-300 border border-slate-600":L?"bg-primary text-white rounded-br-sm":"bg-surface-dark text-white border border-white/10 rounded-bl-sm"}`,children:[!L&&!B&&e.jsx("p",{className:"text-xs font-bold text-primary mb-1",children:t.senderName}),e.jsx("p",{className:"leading-relaxed whitespace-pre-wrap break-words",children:t.message}),e.jsx("p",{className:"text-[10px] mt-1 opacity-70 text-right",children:(I=t.timestamp)!=null&&I.toDate?new Date(t.timestamp.toDate()).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"..."})]})},t.id)}),e.jsx("div",{ref:d})]}),j.status!=="closed"&&e.jsx("div",{className:"p-3 md:p-4 border-t border-white/10 bg-surface-dark safe-area-bottom",children:e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsx("textarea",{value:C,onChange:t=>_(t.target.value),onKeyPress:t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),f())},placeholder:"Type response...",rows:1,className:"flex-1 bg-background-dark text-white px-4 py-3 rounded-2xl border border-white/10 focus:border-primary focus:outline-none placeholder-slate-500 resize-none min-h-[44px] max-h-[120px] text-base"}),e.jsx("button",{onClick:f,disabled:!C.trim(),className:"bg-primary hover:bg-primary-dark disabled:bg-slate-700 disabled:cursor-not-allowed text-white w-11 h-11 rounded-full flex items-center justify-center shrink-0 transition-all shadow-lg active:scale-95",children:e.jsx("span",{className:"material-symbols-outlined text-xl",children:"send"})})]})})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-slate-500 hidden md:flex",children:e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 opacity-20",children:"chat"}),e.jsx("p",{children:"Select a ticket to view conversation"})]})})})]})]})},xa=({orders:n,team:u,navigate:h})=>{const[y,A]=c.useState("week"),[k,j]=c.useState("all"),[p,N]=c.useState("all"),C=c.useMemo(()=>{let l=[...n];const d=new Date;return y!=="all"&&(l=l.filter(m=>{var T,t;const f=((t=(T=m.createdAt)==null?void 0:T.toDate)==null?void 0:t.call(T))||new Date(m.date),v=(d.getTime()-f.getTime())/(1e3*60*60*24);switch(y){case"today":return v<1;case"week":return v<7;case"month":return v<30;case"year":return v<365;default:return!0}})),k!=="all"&&(l=l.filter(m=>m.washerId===k)),p!=="all"&&(l=l.filter(m=>m.status===p)),l.sort((m,f)=>{var T,t,L,B;const F=((t=(T=m.createdAt)==null?void 0:T.toDate)==null?void 0:t.call(T))||new Date(m.date);return(((B=(L=f.createdAt)==null?void 0:L.toDate)==null?void 0:B.call(L))||new Date(f.date)).getTime()-F.getTime()})},[n,y,k,p]),_=c.useMemo(()=>C.reduce((l,d)=>{const m=d.financialBreakdown;return{totalOrders:l.totalOrders+1,totalRevenue:l.totalRevenue+((m==null?void 0:m.grandTotal)||d.price||0),totalWasherEarnings:l.totalWasherEarnings+((m==null?void 0:m.washerGrossEarnings)||0),totalAppRevenue:l.totalAppRevenue+((m==null?void 0:m.appRevenue)||0),totalTips:l.totalTips+(d.tip||0)}},{totalOrders:0,totalRevenue:0,totalWasherEarnings:0,totalAppRevenue:0,totalTips:0}),[C]),S=()=>{const l=["ID","Date","Client","Washer","Status","Total","Washer Earnings","App Earnings","Tip"],d=C.map(T=>{var t,L,B,I,P;return[T.id,new Date(((L=(t=T.createdAt)==null?void 0:t.toDate)==null?void 0:L.call(t))||T.date).toLocaleDateString(),T.clientName,T.washerName||"Unassigned",T.status,`$${(((B=T.financialBreakdown)==null?void 0:B.grandTotal)||T.price||0).toFixed(2)}`,`$${(((I=T.financialBreakdown)==null?void 0:I.washerGrossEarnings)||0).toFixed(2)}`,`$${(((P=T.financialBreakdown)==null?void 0:P.appRevenue)||0).toFixed(2)}`,`$${(T.tip||0).toFixed(2)}`]}),m=[l,...d].map(T=>T.join(",")).join(`
`),f=new Blob([m],{type:"text/csv"}),F=URL.createObjectURL(f),v=document.createElement("a");v.href=F,v.download=`financial-report-${y}-${new Date().toISOString().split("T")[0]}.csv`,v.click()};return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white",children:[e.jsxs("div",{className:"p-6 border-b border-white/10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Financial Reports"}),e.jsx("p",{className:"text-slate-400",children:"All orders with complete breakdown"})]}),e.jsxs("button",{onClick:S,className:"px-6 py-3 bg-primary text-black rounded-xl font-bold hover:bg-primary/80 transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined",children:"download"}),"Export CSV"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Period"}),e.jsxs("select",{value:y,onChange:l=>A(l.target.value),className:"w-full px-4 py-3 rounded-xl bg-surface-dark border border-white/10 text-white focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"}),e.jsx("option",{value:"year",children:"This Year"}),e.jsx("option",{value:"all",children:"All"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Washer"}),e.jsxs("select",{value:k,onChange:l=>j(l.target.value),className:"w-full px-4 py-3 rounded-xl bg-surface-dark border border-white/10 text-white focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"all",children:"All"}),u.filter(l=>l.role==="washer").map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-2",children:"Status"}),e.jsxs("select",{value:p,onChange:l=>N(l.target.value),className:"w-full px-4 py-3 rounded-xl bg-surface-dark border border-white/10 text-white focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"New",children:"New"}),e.jsx("option",{value:"Assigned",children:"Assigned"}),e.jsx("option",{value:"En Route",children:"En Route"}),e.jsx("option",{value:"Arrived",children:"Arrived"}),e.jsx("option",{value:"In Progress",children:"In Progress"}),e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mt-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-gradient-to-br from-blue-500/20 to-blue-500/5 border border-blue-500/20",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Orders"}),e.jsx("p",{className:"text-2xl font-bold",children:_.totalOrders})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-gradient-to-br from-green-500/20 to-green-500/5 border border-green-500/20",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",_.totalRevenue.toFixed(0)]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-gradient-to-br from-purple-500/20 to-purple-500/5 border border-purple-500/20",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Washer Earnings"}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",_.totalWasherEarnings.toFixed(0)]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-gradient-to-br from-primary/20 to-primary/5 border border-primary/20",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"App Earnings"}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",_.totalAppRevenue.toFixed(0)]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-gradient-to-br from-amber-500/20 to-amber-500/5 border border-amber-500/20",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Tips"}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",_.totalTips.toFixed(0)]})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"sticky top-0 bg-surface-dark border-b border-white/10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-400 uppercase",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-400 uppercase",children:"Date/Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-400 uppercase",children:"Client"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-400 uppercase",children:"Washer"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-400 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-400 uppercase",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-400 uppercase",children:"Washer Earnings"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-400 uppercase",children:"App Earnings"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-400 uppercase",children:"Tip"})]})}),e.jsx("tbody",{children:C.map(l=>{var f,F,v,T;const d=l.financialBreakdown,m={Pending:"bg-blue-500/20 text-blue-400",Assigned:"bg-purple-500/20 text-purple-400","En Route":"bg-yellow-500/20 text-yellow-400",Arrived:"bg-orange-500/20 text-orange-400","In Progress":"bg-blue-500/20 text-blue-400",Completed:"bg-green-500/20 text-green-400",Cancelled:"bg-red-500/20 text-red-400"};return e.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5 transition-colors",children:[e.jsxs("td",{className:"px-4 py-4 text-sm font-mono text-slate-400",children:["#",l.id.slice(0,8)]}),e.jsxs("td",{className:"px-4 py-4 text-sm",children:[e.jsx("div",{children:new Date(((F=(f=l.createdAt)==null?void 0:f.toDate)==null?void 0:F.call(f))||l.date).toLocaleDateString()}),e.jsx("div",{className:"text-xs text-slate-500",children:new Date(((T=(v=l.createdAt)==null?void 0:v.toDate)==null?void 0:T.call(v))||l.date).toLocaleTimeString()})]}),e.jsx("td",{className:"px-4 py-4 text-sm",children:l.clientName}),e.jsx("td",{className:"px-4 py-4 text-sm",children:l.washerName||e.jsx("span",{className:"text-slate-500",children:"Unassigned"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${m[l.status]}`,children:l.status})}),e.jsxs("td",{className:"px-4 py-4 text-sm text-right font-bold",children:["$",((d==null?void 0:d.grandTotal)||l.price||0).toFixed(2)]}),e.jsxs("td",{className:"px-4 py-4 text-sm text-right text-purple-400 font-bold",children:["$",((d==null?void 0:d.washerGrossEarnings)||0).toFixed(2)]}),e.jsxs("td",{className:"px-4 py-4 text-sm text-right text-primary font-bold",children:["$",((d==null?void 0:d.appRevenue)||0).toFixed(2)]}),e.jsxs("td",{className:"px-4 py-4 text-sm text-right text-amber-400",children:["$",(l.tip||0).toFixed(2)]})]},l.id)})})]}),C.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-slate-500",children:[e.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 opacity-50",children:"receipt_long"}),e.jsx("p",{className:"text-lg",children:"No orders to display"}),e.jsx("p",{className:"text-sm",children:"Adjust filters to see more results"})]})]})]})},ma=({orders:n,team:u,navigate:h})=>{const y=u.filter(k=>k.role==="washer"),A=c.useMemo(()=>y.map(k=>{const j=n.filter(d=>d.washerId===k.id&&d.status==="Completed"),p=new Date,N=new Date(p);N.setDate(p.getDate()-p.getDay());const C=new Date(p.getFullYear(),p.getMonth(),1),_=j.filter(d=>ie(d.createdAt||d.date)>=N),S=j.filter(d=>ie(d.createdAt||d.date)>=C),l=d=>d.reduce((m,f)=>{var F;return m+(((F=f.financialBreakdown)==null?void 0:F.washerGrossEarnings)||0)},0);return{washer:k,totalOrders:j.length,totalEarnings:l(j),weekEarnings:l(_),monthEarnings:l(S),weekOrders:_.length,monthOrders:S.length}}),[y,n]);return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Washer Earnings"}),e.jsx("p",{className:"text-slate-400",children:"Dashboard de todos los washers con sus estadÃ­sticas"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:A.map(({washer:k,totalOrders:j,totalEarnings:p,weekEarnings:N,monthEarnings:C,weekOrders:_,monthOrders:S})=>e.jsxs("div",{onClick:()=>h(g.ADMIN_WASHER_HISTORY,k.id),className:"group relative overflow-hidden rounded-2xl bg-gradient-to-br from-surface-dark to-surface-dark/50 border border-white/10 p-6 hover:border-primary/50 transition-all cursor-pointer hover:scale-105",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/0 to-primary/20 opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden bg-gradient-to-br from-primary/30 to-blue-500/30 border-2 border-primary/50",children:k.avatar?e.jsx("img",{src:k.avatar,alt:k.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-3xl text-white",children:"person"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold",children:k.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-amber-500/20 px-2 py-0.5 rounded-full",children:[e.jsx("span",{className:"material-symbols-outlined text-amber-400 text-sm",children:"star"}),e.jsx("span",{className:"text-xs font-bold text-amber-400",children:typeof k.rating=="number"?k.rating.toFixed(1):"5.0"})]}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold ${k.status==="Active"?"bg-green-500/20 text-green-400":"bg-slate-500/20 text-slate-400"}`,children:k.status==="Active"?"Online":"Offline"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"p-3 rounded-xl bg-white/5",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Total Ã“rdenes"}),e.jsx("p",{className:"text-2xl font-bold",children:j})]}),e.jsxs("div",{className:"p-3 rounded-xl bg-gradient-to-br from-green-500/20 to-green-500/5",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Total Ganado"}),e.jsxs("p",{className:"text-2xl font-bold text-green-400",children:["$",p.toFixed(0)]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 rounded-xl bg-white/5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"This Week"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[_," Ã³rdenes"]})]}),e.jsxs("p",{className:"text-lg font-bold text-primary",children:["$",N.toFixed(0)]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 rounded-xl bg-white/5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Este Mes"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[S," Ã³rdenes"]})]}),e.jsxs("p",{className:"text-lg font-bold text-blue-400",children:["$",C.toFixed(0)]})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-white/10",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-primary group-hover:text-primary/80",children:[e.jsx("span",{className:"font-medium",children:"Ver Historial Completo"}),e.jsx("span",{className:"material-symbols-outlined",children:"arrow_forward"})]})})]})]},k.id))}),y.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-slate-500",children:[e.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 opacity-50",children:"group"}),e.jsx("p",{className:"text-lg",children:"No hay washers registrados"})]})]})},js=({washerId:n,orders:u,team:h,globalFees:y,navigate:A,onBack:k,onViewOrder:j})=>{const[p,N]=c.useState("all"),C=h.find(l=>l.id===n),_=c.useMemo(()=>{let l=u.filter(m=>m.washerId===n&&(m.status==="Completed"||m.status==="Cancelled"));const d=new Date;return p!=="all"&&(l=l.filter(m=>{const f=ie(m.createdAt||m.date),v=(d.getTime()-f.getTime())/(1e3*60*60*24);switch(p){case"week":return v<7;case"month":return v<30;case"year":return v<365;default:return!0}})),l.sort((m,f)=>{const F=ie(m.createdAt||m.date);return ie(f.createdAt||f.date).getTime()-F.getTime()})},[u,n,p]),S=c.useMemo(()=>{const l=y.reduce((d,m)=>d+m.percentage,0);return _.reduce((d,m)=>{const f=m.financialBreakdown,F=(f==null?void 0:f.grandTotal)||m.price||0,v=(f==null?void 0:f.washerTipEarnings)||m.tip||0,T=F*l/100;f!=null&&f.washerGrossEarnings||F-T;const t=(f==null?void 0:f.washerBaseEarnings)||F-T,L=(f==null?void 0:f.washerGrossEarnings)||t+v;return{totalOrders:d.totalOrders+1,totalEarnings:d.totalEarnings+L,totalCommissions:d.totalCommissions+t,totalTips:d.totalTips+v}},{totalOrders:0,totalEarnings:0,totalCommissions:0,totalTips:0})},[_,y]);return C?e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white",children:[e.jsxs("div",{className:"p-6 border-b border-white/10",children:[e.jsxs("button",{onClick:k,className:"flex items-center gap-2 text-slate-400 hover:text-white mb-4 transition-colors",children:[e.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"}),"Volver a la Lista"]}),e.jsxs("div",{className:"flex items-center gap-6 mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden bg-gradient-to-br from-primary/30 to-blue-500/30 border-2 border-primary/50",children:C.avatar?e.jsx("img",{src:C.avatar,alt:C.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-4xl text-white",children:"person"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:C.name}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-amber-500/20 px-3 py-1 rounded-full",children:[e.jsx("span",{className:"material-symbols-outlined text-amber-400 text-sm",children:"star"}),e.jsx("span",{className:"text-sm font-bold text-amber-400",children:typeof C.rating=="number"?C.rating.toFixed(1):"5.0"})]}),e.jsxs("span",{className:"text-sm text-slate-400",children:[C.completedJobs||0," trabajos completados"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{className:"text-sm text-slate-400",children:"PerÃ­odo:"}),e.jsxs("select",{value:p,onChange:l=>N(l.target.value),className:"px-4 py-2 rounded-xl bg-surface-dark border border-white/10 text-white focus:outline-none focus:border-primary",children:[e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"Este Mes"}),e.jsx("option",{value:"year",children:"Este AÃ±o"}),e.jsx("option",{value:"all",children:"Todo el Historial"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-6",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-gradient-to-br from-blue-500/20 to-blue-500/5 border border-blue-500/20",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Ã“rdenes"}),e.jsx("p",{className:"text-2xl font-bold",children:S.totalOrders})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-gradient-to-br from-green-500/20 to-green-500/5 border border-green-500/20",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Total Ganado"}),e.jsxs("p",{className:"text-2xl font-bold text-green-400",children:["$",S.totalEarnings.toFixed(0)]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-gradient-to-br from-purple-500/20 to-purple-500/5 border border-purple-500/20",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Comisiones"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-400",children:["$",S.totalCommissions.toFixed(0)]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-gradient-to-br from-amber-500/20 to-amber-500/5 border border-amber-500/20",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Propinas"}),e.jsxs("p",{className:"text-2xl font-bold text-amber-400",children:["$",S.totalTips.toFixed(0)]})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"sticky top-0 bg-surface-dark border-b border-white/10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-400 uppercase",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-400 uppercase",children:"Fecha"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-400 uppercase",children:"Cliente"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-400 uppercase",children:"Servicio"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-400 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-400 uppercase",children:"Total Orden"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-400 uppercase",children:"ComisiÃ³n"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-400 uppercase",children:"Propina"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-400 uppercase",children:"Ganancia"})]})}),e.jsx("tbody",{children:_.map(l=>{const d=l.financialBreakdown,m=(d==null?void 0:d.grandTotal)||l.price||0,f=(d==null?void 0:d.washerTipEarnings)||l.tip||0,F=y.reduce((B,I)=>B+I.percentage,0),v=m*F/100,T=(d==null?void 0:d.washerBaseEarnings)||m-v,t=(d==null?void 0:d.washerGrossEarnings)||T+f,L=l.id.startsWith("#")?l.id:`#${l.id}`;return e.jsxs("tr",{onClick:()=>j(l),className:"border-b border-white/5 hover:bg-white/5 cursor-pointer transition-colors",children:[e.jsxs("td",{className:"px-4 py-4 text-sm font-mono text-slate-400",children:[L.substring(0,9),"..."]}),e.jsx("td",{className:"px-4 py-4 text-sm",children:ie(l.createdAt||l.date).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-4 text-sm",children:l.clientName}),e.jsx("td",{className:"px-4 py-4 text-sm text-slate-400",children:l.service||"Standard Wash"}),e.jsx("td",{className:"px-4 py-4 text-sm",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase ${l.status==="Completed"?"bg-green-500/20 text-green-400":l.status==="Cancelled"?"bg-red-500/20 text-red-400":"bg-slate-700 text-slate-300"}`,children:l.status})}),e.jsxs("td",{className:"px-4 py-4 text-sm text-right font-bold",children:["$",m.toFixed(2)]}),e.jsxs("td",{className:"px-4 py-4 text-sm text-right text-purple-400",children:["$",T.toFixed(2)]}),e.jsxs("td",{className:"px-4 py-4 text-sm text-right text-amber-400",children:["$",f.toFixed(2)]}),e.jsxs("td",{className:"px-4 py-4 text-sm text-right font-black text-green-400",children:["$",t.toFixed(2)]})]},l.id)})})]}),_.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-slate-500",children:[e.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 opacity-50",children:"receipt_long"}),e.jsx("p",{className:"text-lg",children:"No hay Ã³rdenes en este perÃ­odo"})]})]})]}):e.jsx("div",{className:"flex items-center justify-center h-full bg-background-dark text-white",children:e.jsx("p",{children:"Washer no encontrado"})})},ha=({orders:n})=>{const[u,h]=c.useState("month"),y=c.useMemo(()=>{const p=new Date,N=new Date(p.getFullYear(),p.getMonth(),p.getDate()),C=new Date(p);C.setDate(p.getDate()-p.getDay());const _=new Date(p.getFullYear(),p.getMonth(),1),S=new Date(p.getFullYear(),0,1),l=n.filter(t=>t.status==="Completed"),d=(t,L)=>t.filter(B=>ie(B.createdAt||B.date)>=L),m=t=>t.reduce((L,B)=>{var I;return L+(((I=B.financialBreakdown)==null?void 0:I.appRevenue)||0)},0),f=d(l,N),F=d(l,C),v=d(l,_),T=d(l,S);return{today:m(f),week:m(F),month:m(v),year:m(T),allTime:m(l),todayOrders:f.length,weekOrders:F.length,monthOrders:v.length,yearOrders:T.length,allTimeOrders:l.length}},[n]),A=c.useMemo(()=>{const p=[],N=new Date;for(let C=11;C>=0;C--){const _=new Date(N.getFullYear(),N.getMonth()-C,1),S=new Date(_.getFullYear(),_.getMonth(),1),l=new Date(_.getFullYear(),_.getMonth()+1,0),d=n.filter(f=>{if(f.status!=="Completed")return!1;const F=ie(f.createdAt||f.date);return F>=S&&F<=l}),m=d.reduce((f,F)=>{var v;return f+(((v=F.financialBreakdown)==null?void 0:v.appRevenue)||0)},0);p.push({month:_.toLocaleDateString("es",{month:"short",year:"2-digit"}),revenue:m,orders:d.length})}return p},[n]),k=Math.max(...A.map(p=>p.revenue),1),j=c.useMemo(()=>{const p={};return n.filter(N=>N.status==="Completed").forEach(N=>{var C;(C=N.financialBreakdown)!=null&&C.fees&&N.financialBreakdown.fees.forEach(_=>{p[_.name]=(p[_.name]||0)+_.amount})}),Object.entries(p).map(([N,C])=>({name:N,amount:C}))},[n]);return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white p-6 overflow-y-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"App Earnings"}),e.jsx("p",{className:"text-slate-400",children:"Dashboard de ingresos por fees"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-8",children:[e.jsxs("div",{className:"p-6 rounded-2xl bg-gradient-to-br from-blue-500/20 to-blue-500/5 border border-blue-500/20",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-2",children:"Hoy"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-400",children:["$",y.today.toFixed(0)]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[y.todayOrders," Ã³rdenes"]})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-gradient-to-br from-purple-500/20 to-purple-500/5 border border-purple-500/20",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-2",children:"This Week"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-400",children:["$",y.week.toFixed(0)]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[y.weekOrders," Ã³rdenes"]})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-gradient-to-br from-primary/20 to-primary/5 border border-primary/20",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-2",children:"Este Mes"}),e.jsxs("p",{className:"text-3xl font-bold text-primary",children:["$",y.month.toFixed(0)]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[y.monthOrders," Ã³rdenes"]})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-gradient-to-br from-green-500/20 to-green-500/5 border border-green-500/20",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-2",children:"Este AÃ±o"}),e.jsxs("p",{className:"text-3xl font-bold text-green-400",children:["$",y.year.toFixed(0)]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[y.yearOrders," Ã³rdenes"]})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-gradient-to-br from-amber-500/20 to-amber-500/5 border border-amber-500/20",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-2",children:"Total"}),e.jsxs("p",{className:"text-3xl font-bold text-amber-400",children:["$",y.allTime.toFixed(0)]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[y.allTimeOrders," Ã³rdenes"]})]})]}),e.jsxs("div",{className:"mb-8 p-6 rounded-2xl bg-surface-dark border border-white/10",children:[e.jsx("h2",{className:"text-xl font-bold mb-6",children:"Ingresos Mensuales (Ãšltimos 12 Meses)"}),e.jsx("div",{className:"flex items-end gap-2 h-64",children:A.map((p,N)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2",children:[e.jsx("div",{className:"w-full flex flex-col justify-end h-full",children:e.jsx("div",{className:"w-full bg-gradient-to-t from-primary to-blue-500 rounded-t-lg transition-all hover:opacity-80 relative group",style:{height:`${p.revenue/k*100}%`,minHeight:p.revenue>0?"4px":"0"},children:e.jsxs("div",{className:"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 bg-black/90 px-3 py-2 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none",children:[e.jsxs("p",{className:"text-sm font-bold",children:["$",p.revenue.toFixed(0)]}),e.jsxs("p",{className:"text-xs text-slate-400",children:[p.orders," Ã³rdenes"]})]})})}),e.jsx("p",{className:"text-xs text-slate-500 transform -rotate-45 origin-top-left mt-2",children:p.month})]},N))})]}),j.length>0&&e.jsxs("div",{className:"p-6 rounded-2xl bg-surface-dark border border-white/10",children:[e.jsx("h2",{className:"text-xl font-bold mb-6",children:"Desglose por Tipo de Fee"}),e.jsx("div",{className:"space-y-4",children:j.map((p,N)=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl bg-white/5",children:[e.jsx("span",{className:"font-medium",children:p.name}),e.jsxs("span",{className:"text-2xl font-bold text-primary",children:["$",p.amount.toFixed(2)]})]},N))})]})]})},pa=({orders:n,team:u})=>{const[h,y]=c.useState(new Date().getFullYear()),[A,k]=c.useState(null),[j,p]=c.useState(null),N=c.useMemo(()=>{const l=new Set;return n.forEach(d=>{var f,F;const m=((F=(f=d.createdAt)==null?void 0:f.toDate)==null?void 0:F.call(f))||new Date(d.date);l.add(m.getFullYear())}),Array.from(l).sort((d,m)=>m-d)},[n]),C=()=>{const l=n.filter(I=>{var O,Y;return(((Y=(O=I.createdAt)==null?void 0:O.toDate)==null?void 0:Y.call(O))||new Date(I.date)).getFullYear()===h&&I.status==="Completed"}),d={totalOrders:l.length,grossRevenue:l.reduce((I,P)=>{var O;return I+(((O=P.financialBreakdown)==null?void 0:O.grandTotal)||P.price||0)},0),totalAppFees:l.reduce((I,P)=>{var O;return I+(((O=P.financialBreakdown)==null?void 0:O.appRevenue)||0)},0),totalWasherPayments:l.reduce((I,P)=>{var O;return I+(((O=P.financialBreakdown)==null?void 0:O.washerGrossEarnings)||0)},0),totalTips:l.reduce((I,P)=>I+(P.tip||0),0),totalDiscounts:l.reduce((I,P)=>{var O;return I+(((O=P.financialBreakdown)==null?void 0:O.discountAmount)||0)},0),totalRefunds:l.filter(I=>I.refundAmount).reduce((I,P)=>I+(P.refundAmount||0),0)},m=[];for(let I=0;I<12;I++){const P=l.filter(O=>{var G,ce;return(((ce=(G=O.createdAt)==null?void 0:G.toDate)==null?void 0:ce.call(G))||new Date(O.date)).getMonth()===I});m.push({monthIndex:I,month:new Date(h,I,1).toLocaleDateString("es",{month:"long",year:"numeric"}),orders:P.length,revenue:P.reduce((O,Y)=>{var G;return O+(((G=Y.financialBreakdown)==null?void 0:G.grandTotal)||Y.price||0)},0),appFees:P.reduce((O,Y)=>{var G;return O+(((G=Y.financialBreakdown)==null?void 0:G.appRevenue)||0)},0),washerPayments:P.reduce((O,Y)=>{var G;return O+(((G=Y.financialBreakdown)==null?void 0:G.washerGrossEarnings)||0)},0)})}const f={};l.forEach(I=>{var O;const P=I.service||"Sin especificar";f[P]||(f[P]={count:0,revenue:0}),f[P].count++,f[P].revenue+=((O=I.financialBreakdown)==null?void 0:O.grandTotal)||I.price||0});const F=Object.entries(f).map(([I,P])=>({serviceName:I,orderCount:P.count,revenue:P.revenue})),v={};l.forEach(I=>{var P;I.washerId&&I.washerName&&(v[I.washerId]||(v[I.washerId]={name:I.washerName,paid:0,count:0}),v[I.washerId].paid+=((P=I.financialBreakdown)==null?void 0:P.washerGrossEarnings)||0,v[I.washerId].count++)});const T=Object.entries(v).map(([I,P])=>({washerId:I,washerName:P.name,totalPaid:P.paid,orderCount:P.count})),t={};l.forEach(I=>{var P;(P=I.financialBreakdown)!=null&&P.fees&&I.financialBreakdown.fees.forEach(O=>{t[O.name]=(t[O.name]||0)+O.amount})});const L=Object.entries(t).map(([I,P])=>({feeName:I,totalAmount:P})),B={id:`tax-report-${h}`,year:h,generatedAt:Date.now(),generatedBy:"admin",summary:d,monthlyBreakdown:m,serviceBreakdown:F,washer1099Data:T,feeBreakdown:L};k(B)},_=()=>{if(!A)return;const l=window.open("","_blank");l&&(l.document.write(`
      <html>
        <head>
          <title>Reporte Fiscal ${h}</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 40px; }
            h1 { color: #333; }
            h2 { color: #666; margin-top: 30px; }
            table { width: 100%; border-collapse: collapse; margin: 20px 0; }
            th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; }
            th { background: #f5f5f5; font-weight: bold; }
            .summary { background: #f9f9f9; padding: 20px; margin: 20px 0; }
            .total { font-weight: bold; font-size: 1.2em; }
          </style>
        </head>
        <body>
          <h1>REPORTE FISCAL - AÃ‘O ${h}</h1>
          
          <div class="summary">
            <h2>RESUMEN EJECUTIVO</h2>
            <p><strong>Ã“rdenes Totales:</strong> ${A.summary.totalOrders}</p>
            <p><strong>Ingresos Brutos:</strong> $${A.summary.grossRevenue.toFixed(2)}</p>
            <p><strong>Total Fees de App:</strong> $${A.summary.totalAppFees.toFixed(2)}</p>
            <p><strong>Total Pagado a Washers:</strong> $${A.summary.totalWasherPayments.toFixed(2)}</p>
            <p><strong>Total Propinas:</strong> $${A.summary.totalTips.toFixed(2)}</p>
            <p><strong>Total Descuentos:</strong> $${A.summary.totalDiscounts.toFixed(2)}</p>
            <p><strong>Total Reembolsos:</strong> $${A.summary.totalRefunds.toFixed(2)}</p>
          </div>

          <h2>DESGLOSE MENSUAL</h2>
          <table>
            <tr>
              <th>Mes</th>
              <th>Ã“rdenes</th>
              <th>Ingresos</th>
              <th>Fees App</th>
              <th>Pagos Washers</th>
            </tr>
            ${A.monthlyBreakdown.map(d=>`
              <tr>
                <td>${d.month}</td>
                <td>${d.orders}</td>
                <td>$${d.revenue.toFixed(2)}</td>
                <td>$${d.appFees.toFixed(2)}</td>
                <td>$${d.washerPayments.toFixed(2)}</td>
              </tr>
            `).join("")}
          </table>

          <h2>INFORMACIÃ“N PARA 1099 (Washers)</h2>
          <table>
            <tr>
              <th>Washer</th>
              <th>Ã“rdenes</th>
              <th>Total Pagado</th>
            </tr>
            ${A.washer1099Data.map(d=>`
              <tr>
                <td>${d.washerName}</td>
                <td>${d.orderCount}</td>
                <td>$${d.totalPaid.toFixed(2)}</td>
              </tr>
            `).join("")}
          </table>

          <p style="margin-top: 40px; text-align: center; color: #999;">
            Generado el ${new Date().toLocaleDateString()}
          </p>
        </body>
      </html>
    `),l.document.close(),l.print())},S=()=>{if(!A)return;const l=["Mes","Ã“rdenes","Ingresos","Fees App","Pagos Washers"],d=A.monthlyBreakdown.map(T=>[T.month,T.orders,T.revenue.toFixed(2),T.appFees.toFixed(2),T.washerPayments.toFixed(2)]),m=[l,...d].map(T=>T.join(",")).join(`
`),f=new Blob([m],{type:"text/csv"}),F=URL.createObjectURL(f),v=document.createElement("a");v.href=F,v.download=`tax-report-${h}.csv`,v.click()};return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white p-6 overflow-y-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Reportes Fiscales"}),e.jsx("p",{className:"text-slate-400",children:"Genera reportes anuales para declaraciÃ³n de impuestos"})]}),e.jsx("div",{className:"mb-8 p-6 rounded-2xl bg-surface-dark border border-white/10",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{className:"text-lg font-medium",children:"AÃ±o Fiscal:"}),e.jsx("select",{value:h,onChange:l=>y(Number(l.target.value)),className:"px-6 py-3 rounded-xl bg-background-dark border border-white/10 text-white focus:outline-none focus:border-primary text-lg",children:N.map(l=>e.jsx("option",{value:l,children:l},l))}),e.jsxs("button",{onClick:C,className:"px-8 py-3 bg-primary text-black rounded-xl font-bold hover:bg-primary/80 transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined",children:"description"}),"Generar Reporte"]})]})}),A&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:_,className:"px-6 py-3 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined",children:"picture_as_pdf"}),"Exportar PDF"]}),e.jsxs("button",{onClick:S,className:"px-6 py-3 bg-green-500 text-white rounded-xl font-bold hover:bg-green-600 transition-colors flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined",children:"table_chart"}),"Exportar CSV"]})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-gradient-to-br from-primary/20 to-primary/5 border border-primary/20",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-6",children:["RESUMEN EJECUTIVO - ",h]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Ã“rdenes Totales"}),e.jsx("p",{className:"text-3xl font-bold",children:A.summary.totalOrders})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Ingresos Brutos"}),e.jsxs("p",{className:"text-3xl font-bold text-green-400",children:["$",A.summary.grossRevenue.toFixed(0)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Fees de App"}),e.jsxs("p",{className:"text-3xl font-bold text-primary",children:["$",A.summary.totalAppFees.toFixed(0)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Pagado a Washers"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-400",children:["$",A.summary.totalWasherPayments.toFixed(0)]})]})]})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-surface-dark border border-white/10",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Desglose Mensual"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/10",children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-bold text-slate-400",children:"Mes"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-bold text-slate-400",children:"Ã“rdenes"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-bold text-slate-400",children:"Ingresos"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-bold text-slate-400",children:"Fees App"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-bold text-slate-400",children:"Pagos Washers"})]})}),e.jsx("tbody",{children:A.monthlyBreakdown.filter(l=>l.orders>0).map((l,d)=>e.jsxs("tr",{className:"border-b border-white/5",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("button",{onClick:()=>p({index:l.monthIndex,name:l.month}),className:"text-primary hover:underline font-bold text-left",children:l.month})}),e.jsx("td",{className:"px-4 py-3 text-right",children:l.orders}),e.jsxs("td",{className:"px-4 py-3 text-right font-bold",children:["$",l.revenue.toFixed(2)]}),e.jsxs("td",{className:"px-4 py-3 text-right text-primary",children:["$",l.appFees.toFixed(2)]}),e.jsxs("td",{className:"px-4 py-3 text-right text-purple-400",children:["$",l.washerPayments.toFixed(2)]})]},d))})]})})]}),e.jsxs("div",{className:"p-6 rounded-2xl bg-surface-dark border border-white/10",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"InformaciÃ³n para 1099 (Washers)"}),e.jsx("div",{className:"space-y-3",children:A.washer1099Data.map((l,d)=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl bg-white/5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:l.washerName}),e.jsxs("p",{className:"text-sm text-slate-400",children:[l.orderCount," Ã³rdenes completadas"]})]}),e.jsxs("p",{className:"text-2xl font-bold text-green-400",children:["$",l.totalPaid.toFixed(2)]})]},d))})]})]}),!A&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-slate-500",children:[e.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 opacity-50",children:"description"}),e.jsx("p",{className:"text-lg",children:"Selecciona un aÃ±o y genera el reporte"})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-surface-dark rounded-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold capitalize",children:j.name}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Desglose de Ã³rdenes del mes"})]}),e.jsx("button",{onClick:()=>p(null),className:"p-2 hover:bg-white/5 rounded-lg",children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/10 text-left",children:[e.jsx("th",{className:"pb-3 text-sm font-bold text-slate-400",children:"Fecha"}),e.jsx("th",{className:"pb-3 text-sm font-bold text-slate-400",children:"Cliente"}),e.jsx("th",{className:"pb-3 text-sm font-bold text-slate-400",children:"Washer"}),e.jsx("th",{className:"pb-3 text-right text-sm font-bold text-slate-400",children:"Total"}),e.jsx("th",{className:"pb-3 text-right text-sm font-bold text-slate-400",children:"Fee App"}),e.jsx("th",{className:"pb-3 text-right text-sm font-bold text-slate-400",children:"Pay"})]})}),e.jsxs("tbody",{className:"text-sm",children:[n.filter(l=>{var m,f;const d=((f=(m=l.createdAt)==null?void 0:m.toDate)==null?void 0:f.call(m))||new Date(l.date);return d.getFullYear()===h&&d.getMonth()===j.index&&l.status==="Completed"}).sort((l,d)=>{var F,v,T,t;const m=((v=(F=l.createdAt)==null?void 0:F.toDate)==null?void 0:v.call(F))||new Date(l.date);return(((t=(T=d.createdAt)==null?void 0:T.toDate)==null?void 0:t.call(T))||new Date(d.date)).getTime()-m.getTime()}).map(l=>{var d,m,f,F,v,T,t;return e.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5",children:[e.jsxs("td",{className:"py-3",children:[new Date(((m=(d=l.createdAt)==null?void 0:d.toDate)==null?void 0:m.call(d))||l.date).toLocaleDateString(),e.jsx("div",{className:"text-xs text-slate-500",children:new Date(((F=(f=l.createdAt)==null?void 0:f.toDate)==null?void 0:F.call(f))||l.date).toLocaleTimeString()})]}),e.jsx("td",{className:"py-3",children:l.clientName}),e.jsx("td",{className:"py-3",children:l.washerName}),e.jsxs("td",{className:"py-3 text-right font-bold",children:["$",(((v=l.financialBreakdown)==null?void 0:v.grandTotal)||l.price||0).toFixed(2)]}),e.jsxs("td",{className:"py-3 text-right text-primary",children:["$",(((T=l.financialBreakdown)==null?void 0:T.appRevenue)||0).toFixed(2)]}),e.jsxs("td",{className:"py-3 text-right text-purple-400",children:["$",(((t=l.financialBreakdown)==null?void 0:t.washerGrossEarnings)||0).toFixed(2)]})]},l.id)}),n.filter(l=>{var m,f;const d=((f=(m=l.createdAt)==null?void 0:m.toDate)==null?void 0:f.call(m))||new Date(l.date);return d.getFullYear()===h&&d.getMonth()===j.index&&l.status==="Completed"}).length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-8 text-center text-slate-500",children:"No se encontraron Ã³rdenes completadas en este mes."})})]})]})}),e.jsx("div",{className:"p-4 border-t border-white/5 text-right",children:e.jsx("button",{onClick:()=>p(null),className:"px-6 py-2 bg-white/10 hover:bg-white/20 rounded-lg text-sm font-bold transition-colors",children:"Cerrar"})})]})})]})},Ks=({src:n,alt:u,className:h="",width:y,height:A,placeholder:k="shimmer",priority:j=!1,onLoad:p,onError:N})=>{const[C,_]=c.useState(!1),[S,l]=c.useState(j),[d,m]=c.useState(!1),f=c.useRef(null);c.useEffect(()=>{if(j||!f.current)return;const B=new IntersectionObserver(I=>{I.forEach(P=>{P.isIntersecting&&(l(!0),B.disconnect())})},{rootMargin:"50px"});return B.observe(f.current),()=>B.disconnect()},[j]);const F=()=>{_(!0),p==null||p()},v=()=>{m(!0),N==null||N()},t=(B=>B.endsWith(".png")||B.endsWith(".jpg")||B.endsWith(".jpeg")?B.replace(/\.(png|jpg|jpeg)$/,".webp"):B)(n),L=()=>{switch(k){case"blur":return e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br from-slate-800 to-slate-900 animate-pulse ${h}`,style:{width:y,height:A}});case"skeleton":return e.jsx("div",{className:`skeleton ${h}`,style:{width:y,height:A}});case"shimmer":default:return e.jsx("div",{className:`absolute inset-0 shimmer bg-slate-800 ${h}`,style:{width:y,height:A}})}};return d?e.jsx("div",{className:`flex items-center justify-center bg-slate-800 text-slate-500 ${h}`,style:{width:y,height:A},children:e.jsx("span",{className:"material-symbols-outlined text-4xl",children:"broken_image"})}):e.jsxs("div",{className:"relative",style:{width:y,height:A},ref:f,children:[!C&&L(),S&&e.jsx("img",{src:t,alt:u,className:`${h} ${C?"opacity-100":"opacity-0"} transition-opacity duration-300`,style:{width:y,height:A},onLoad:F,onError:v,loading:j?"eager":"lazy"})]})},Xs=({images:n,columns:u=3,gap:h=4})=>{const[y,A]=c.useState(null);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`grid gap-${h}`,style:{gridTemplateColumns:`repeat(${u}, minmax(0, 1fr))`},children:n.map((k,j)=>e.jsxs("div",{className:"cursor-pointer hover-scale",onClick:()=>A(j),children:[e.jsx(Ks,{src:k.src,alt:k.alt,className:"w-full h-48 object-cover rounded-lg"}),k.caption&&e.jsx("p",{className:"text-sm text-slate-400 mt-2",children:k.caption})]},j))}),y!==null&&e.jsxs("div",{className:"fixed inset-0 z-50 bg-black/90 flex items-center justify-center p-4",onClick:()=>A(null),children:[e.jsx("button",{className:"absolute top-4 right-4 text-white text-4xl hover:opacity-70",onClick:()=>A(null),children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})}),e.jsx(Ks,{src:n[y].src,alt:n[y].alt,className:"max-w-full max-h-full object-contain",priority:!0}),n[y].caption&&e.jsx("p",{className:"absolute bottom-4 left-0 right-0 text-center text-white text-lg",children:n[y].caption})]})]})},Ns=({order:n})=>{if(!n.photos)return e.jsxs("div",{className:"bg-black/30 rounded-lg p-6 text-center border border-white/10",children:[e.jsx("span",{className:"material-symbols-outlined text-3xl text-slate-600 mb-2",children:"no_photography"}),e.jsx("p",{className:"text-sm text-slate-500",children:"No hay fotos disponibles para este pedido"})]});const{before:u,after:h}=n.photos,y=p=>{if(!p)return[];if(Array.isArray(p))return p.map((N,C)=>({src:N,alt:`Foto ${C+1}`,caption:A(C)})).filter(N=>N.src);if(typeof p=="object"){const N={front:"Frente",back:"AtrÃ¡s",leftSide:"Lateral Izq.",rightSide:"Lateral Der.",interiorFront:"Interior Frente",interiorBack:"Interior AtrÃ¡s"};return Object.entries(p).map(([C,_])=>({src:_,alt:N[C]||C,caption:N[C]||C})).filter(C=>C.src)}return[]},A=p=>["Frente","AtrÃ¡s","Lateral Izq.","Lateral Der.","Interior Frente","Interior AtrÃ¡s"][p]||`Foto ${p+1}`,k=y(u),j=y(h);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-bold text-green-400 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"photo_camera"}),"ANTES del Servicio (CondiciÃ³n Inicial)"]}),k.length>0?e.jsx(Xs,{images:k,columns:3,gap:2}):e.jsx("div",{className:"bg-black/20 rounded-lg p-4 text-center border border-white/5",children:e.jsx("span",{className:"text-xs text-slate-600",children:'No hay fotos de "Antes"'})})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-bold text-blue-400 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"check_circle"}),"DESPUÃ‰S del Servicio (Trabajo Completado)"]}),j.length>0?e.jsx(Xs,{images:j,columns:3,gap:2}):e.jsx("div",{className:"bg-black/20 rounded-lg p-4 text-center border border-white/5",children:e.jsx("span",{className:"text-xs text-slate-600",children:'No hay fotos de "DespuÃ©s"'})})]})]})},ua=({navigate:n})=>{const[u,h]=c.useState([]),[y,A]=c.useState(!0);c.useEffect(()=>{const N=es(Fe(ae,"fleetQuotes"),et("createdAt","desc")),C=ss(N,_=>{const S=_.docs.map(l=>({id:l.id,...l.data()}));h(S),A(l=>!1)});return()=>C()},[]);const k=async(N,C)=>{try{await Me(be(ae,"fleetQuotes",N),{status:C})}catch(_){console.error("Error updating status:",_)}},j=async N=>{if(window.confirm("Are you sure you want to delete this quote request?"))try{await qt(be(ae,"fleetQuotes",N))}catch(C){console.error("Error deleting quote:",C)}},p=N=>{switch(N){case"new":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"contacting":return"bg-amber-500/20 text-amber-400 border-amber-500/30";case"contacted":return"bg-green-500/20 text-green-400 border-green-500/30";case"closed":return"bg-slate-500/20 text-slate-400 border-slate-500/30";default:return"bg-slate-500/20 text-slate-400"}};return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white",children:[e.jsxs("header",{className:"p-4 border-b border-white/5 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>n(g.ADMIN_DASHBOARD),className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10",children:e.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Fleet Quotes"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Commercial & semi-truck inquiries"})]})]}),e.jsxs("div",{className:"bg-primary/20 text-primary px-3 py-1 rounded-full text-xs font-bold border border-primary/30",children:[u.filter(N=>N.status==="new").length," New"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:y?e.jsx("div",{className:"flex justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):u.length===0?e.jsxs("div",{className:"text-center p-12 bg-surface-dark rounded-2xl border border-dashed border-white/10",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl text-slate-600 mb-2",children:"assignment_late"}),e.jsx("p",{className:"text-slate-400",children:"No quote requests found"})]}):u.map(N=>{var C;return e.jsxs("div",{className:"bg-surface-dark rounded-2xl border border-white/5 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-white/5 flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:N.fullName}),e.jsx("p",{className:"text-xs text-slate-400",children:(C=N.createdAt)!=null&&C.toDate?N.createdAt.toDate().toLocaleString():"Just now"})]}),e.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase border ${p(N.status)}`,children:N.status})]}),e.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"material-symbols-outlined text-slate-500 text-sm",children:"phone"}),e.jsx("a",{href:`tel:${N.phone}`,className:"text-primary hover:underline",children:N.phone})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"material-symbols-outlined text-slate-500 text-sm",children:"location_on"}),e.jsx("span",{className:"text-slate-300",children:N.address})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"material-symbols-outlined text-slate-500 text-sm",children:"local_shipping"}),e.jsx("span",{className:"text-slate-300 font-bold capitalize",children:N.vehicleType}),e.jsxs("span",{className:"bg-white/5 px-2 py-0.5 rounded text-xs",children:["Qty: ",N.vehicleCount]})]})]}),N.additionalNotes&&e.jsxs("div",{className:"bg-black/20 p-3 rounded-xl",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1 font-bold uppercase",children:"Notes"}),e.jsxs("p",{className:"text-sm text-slate-300 italic",children:['"',N.additionalNotes,'"']})]})]}),e.jsxs("div",{className:"p-4 bg-white/5 flex flex-wrap gap-2 justify-end",children:[e.jsxs("select",{className:"bg-background-dark border border-white/10 rounded-lg px-3 py-1.5 text-xs text-white",value:N.status,onChange:_=>k(N.id,_.target.value),children:[e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"contacting",children:"Contacting"}),e.jsx("option",{value:"contacted",children:"Contacted"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsx("button",{onClick:()=>j(N.id),className:"p-1.5 text-red-400 hover:bg-red-400/10 rounded-lg transition-colors",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]},N.id)})})]})},oe=({active:n,navigate:u})=>e.jsx("div",{className:"sticky bottom-0 bg-background-dark border-t border-white/10 p-2 flex justify-around z-20 overflow-x-auto",children:e.jsx("div",{className:"flex justify-around w-full max-w-lg mx-auto",children:[{s:g.ADMIN_DASHBOARD,i:"grid_view",l:te.t("orders")},{s:g.ADMIN_TEAM,i:"group",l:te.t("team")},{s:g.ADMIN_CLIENTS,i:"person",l:te.t("clients")},{s:g.ADMIN_PRICING,i:"sell",l:te.t("services")},{s:g.ADMIN_ANALYTICS,i:"monitoring",l:te.t("metrics")},{s:g.ADMIN_QUOTES,i:"assignment",l:"Quotes"},{s:g.ADMIN_SETTINGS,i:"settings",l:"Config"}].map(h=>e.jsxs("button",{onClick:()=>u(h.s),className:`flex flex-col items-center p-2 min-w-[50px] ${n===h.s?"text-primary":"text-slate-500"}`,children:[e.jsx("span",{className:"material-symbols-outlined text-xl",children:h.i}),e.jsx("span",{className:"text-[10px] mt-1 font-medium",children:h.l})]},h.s))})}),La=({screen:n,navigate:u,orders:h,team:y,clients:A,packages:k,addons:j,vehicleTypes:p,supportPhone:N,setSupportPhone:C,assignOrder:_,updateOrder:S,cancelOrder:l,addTeamMember:d,toggleBlockUser:m,deleteUser:f,updateUserProfile:F,onSavePackage:v,onDeletePackage:T,onSaveAddon:t,onDeleteAddon:L,onSaveVehicleType:B,onDeleteVehicleType:I,approveWasher:P,rejectWasher:O,bonuses:Y,discounts:G,payments:ce,createBonus:Ne,updateBonus:fe,deleteBonus:Le,createDiscount:tt,updateDiscount:at,deleteDiscount:lt,createPayment:rt,showToast:U,currentUser:pe,logout:vs,reportEmail:it,setReportEmail:ys,issues:ts=[],saveServiceArea:nt,serviceArea:dt,addNotification:ot,washerApplications:ct})=>{var Os,Rs,Ls;const[Be,xt]=c.useState("All"),[ba,fa]=c.useState(""),[ga,ja]=c.useState(""),[Na,va]=c.useState("All"),[ws,We]=c.useState(null),[X,ye]=c.useState(null),[as,ya]=c.useState(""),[ls,wa]=c.useState("All"),[rs,ka]=c.useState("All Dates"),[Ca,Sa]=c.useState(new Date().toISOString().split("T")[0]),[Aa,Da]=c.useState(""),[mt,ks]=c.useState(!1),[we,ht]=c.useState("week"),[Ia,Ta]=c.useState("year"),[Pe,pt]=c.useState(new Date().getFullYear()),[le,Ae]=c.useState("packages"),[se,me]=c.useState(null),[ut,Ue]=c.useState(!1),[De,is]=c.useState({}),[bt,ze]=c.useState(!1),[ft,Ee]=c.useState(!1),[H,ge]=c.useState({name:"",email:"",password:"",role:"washer",driverLicense:"",insuranceNumber:"",vehiclePlate:"",vehicleModel:""}),[z,Ie]=c.useState(null),[Ve,He]=c.useState(null),[b,ne]=c.useState(null),[ve,Te]=c.useState({name:"",icon:"directions_car"}),[ns,Cs]=c.useState(""),[Ye,gt]=c.useState(""),[Ge,Je]=c.useState(!1),[jt,Nt]=c.useState([]),[vt,ds]=c.useState(null),[Ss,yt]=c.useState("transfer"),[As,Ds]=c.useState(""),[os,cs]=c.useState(null),[Se,xs]=c.useState([]),[Oe,Is]=c.useState("live"),[ms,Ts]=c.useState("active"),[wt,kt]=c.useState(""),[re,Qe]=c.useState([{name:"App Commission",percentage:20}]);gs.useEffect(()=>{(async()=>{try{const r=be(ae,"settings","financials"),a=await Kt(r);a.exists()&&a.data().globalFees&&Qe(a.data().globalFees)}catch(r){console.error("Error loading fees",r)}})()},[]);const Ct=async()=>{try{await Xt(be(ae,"settings","financials"),{globalFees:re},{merge:!0}),U("Global fees saved successfully","success")}catch(s){console.error("Error saving fees",s),U("Error saving fees","error")}},St=()=>Qe([...re,{name:"New Fee",percentage:0}]),_s=(s,r,a)=>{const D=[...re];D[s][r]=a,Qe(D)},At=s=>Qe(re.filter((r,a)=>a!==s));gs.useEffect(()=>{const s=ss(es(Fe(ae,"supportTickets")),r=>{const a=r.docs.map(D=>({id:D.id,...D.data()}));Nt(a.sort((D,$)=>{var x,M,i,o;return(((M=(x=$.lastMessageAt)==null?void 0:x.toMillis)==null?void 0:M.call(x))||0)-(((o=(i=D.lastMessageAt)==null?void 0:i.toMillis)==null?void 0:o.call(i))||0)}))},r=>{console.error("Error loading support tickets:",r)});return()=>s()},[]);const hs=y.filter(s=>s.role==="washer"),[ps,$s]=c.useState("pending"),[qe,Dt]=c.useState(()=>{const s=new Date,r=s.getDay()||7;return r!==1&&s.setHours(-24*(r-1)),s.setHours(0,0,0,0),s.getTime()}),[us,It]=c.useState(null),bs=c.useMemo(()=>{const s=new Date,r=new Date(s.getFullYear(),s.getMonth(),s.getDate()).getTime(),a=h.filter(i=>{if(i.status!=="Completed")return!1;if(i.completedAt){const K=ie(i.completedAt).getTime(),R=r+1440*60*1e3;return K>=r&&K<R}const o=s.getFullYear(),w=String(s.getMonth()+1).padStart(2,"0"),W=String(s.getDate()).padStart(2,"0"),J=`${o}-${w}-${W}`;if(i.date==="Today")return!0;if(i.date)try{if(i.date===J)return!0;const K=new Date(i.date);if(!isNaN(K.getTime())){const R=K.getFullYear(),V=String(K.getMonth()+1).padStart(2,"0"),E=String(K.getDate()).padStart(2,"0");if(`${R}-${V}-${E}`===J)return!0}}catch{}return!1}),D=a.reduce((i,o)=>i+(o.price||0),0),$=re.reduce((i,o)=>i+(o.percentage||0),0),x=a.reduce((i,o)=>{const w=o.price||0,W=o.tip||0,J=w*$/100;return i+(w-J)+W},0),M=y.filter(i=>i.role==="washer"&&i.status!=="Offline"&&i.status!=="Blocked").length;return{count:a.length,revenue:D,washerPay:x,activeWashers:M}},[h,y,re]),Ke=c.useMemo(()=>{let s=h;if(Be!=="All"&&(s=s.filter(r=>r.status===Be)),Ye){const r=Ye.toLowerCase();s=s.filter(a=>a.clientName.toLowerCase().includes(r)||a.id.toLowerCase().includes(r)||a.clientId&&a.clientId.toLowerCase().includes(r)||a.vehicle&&a.vehicle.toLowerCase().includes(r))}return s},[h,Be,Ye]);c.useMemo(()=>h.filter(s=>{if(!(s.status==="Completed"||s.status==="Cancelled")||ls!=="All"&&s.status!==ls||rs!=="All Dates"&&s.date!==rs)return!1;if(as){const a=as.toLowerCase();return s.clientName.toLowerCase().includes(a)||s.id.toLowerCase().includes(a)}return!0}),[h,ls,rs,as]),c.useMemo(()=>{const s=new Set(h.map(r=>r.date));return["All Dates",...Array.from(s)]},[h]);const Xe=c.useMemo(()=>{const s=new Date,r=new Date(s.getFullYear(),s.getMonth(),s.getDate()).getTime(),a=new Date(s);a.setDate(s.getDate()-(s.getDay()||7)+1),a.setHours(0,0,0,0);const D=new Date(s.getFullYear(),s.getMonth(),1).getTime(),$=new Date(s.getFullYear(),0,1).getTime(),x=h.filter(E=>{let Q=0;return E.status==="Completed"&&E.completedAt?Q=ie(E.completedAt).getTime():E.status==="Cancelled"?Q=ie(E.createdAt||E.date).getTime():Q=ie(E.date).getTime(),isNaN(Q)||Q===0?!1:we==="day"?Q>=r:we==="week"?Q>=a.getTime():we==="month"?Q>=D:we==="year"?Q>=$:!0}),M=x.filter(E=>E.status==="Completed"),i=x.filter(E=>E.status==="Cancelled"),o=M.reduce((E,Q)=>E+(Q.price||0),0),w=i.filter(E=>E.cancelledBy==="client"&&E.washerId).length*15,W=o+w,J=re.reduce((E,Q)=>E+(Q.percentage||0),0);let K=0,R=0;M.forEach(E=>{const Q=E.price||0,Ce=E.tip||0,je=Q*J/100,Z=Q-je;K+=Z+Ce,R+=je}),R+=w;const V=[{name:"Revenue",revenue:W},{name:"Washer",revenue:K},{name:"Profit",revenue:R}];return{totalOrders:x.length,completedCount:M.length,cancelledCount:i.length,grossRevenue:W,appProfit:R,washerPayout:K,chartData:V,detailedOrders:x}},[h,we,re]),Tt=()=>{if(se){if(le==="packages")v(se);else if(le==="vehicleTypes"){B({...se,...ve});const s=se.id;k.forEach(r=>{const a=De[r.id];if(a!==void 0&&(r.price[s]||0)!==a){const $={...r,price:{...r.price,[s]:a}};v($)}}),j.forEach(r=>{const a=De[r.id];if(a!==void 0&&(r.price[s]||0)!==a){const $={...r,price:{...r.price,[s]:a}};t($)}})}else t(se);me(null)}},Ms=s=>{window.confirm("Delete item?")&&(le==="packages"?T(s):L(s))},_t=()=>ze(!0),fs=s=>s?s.includes("/")||s.includes(".")?e.jsx("img",{src:s,alt:"icon",className:"w-full h-full object-contain"}):e.jsx("span",{className:"material-symbols-outlined text-slate-300",children:s}):e.jsx("span",{className:"material-symbols-outlined text-slate-300",children:"directions_car"}),Fs=s=>{Ae(s),ze(!1),Ue(!0);const r=`${s==="packages"?"p":"a"}-${Date.now()}`,a={};p&&p.forEach(D=>{a[D.id||D.name]=0}),me({id:r,name:"",price:a,description:"",duration:"",image:"",washerCommission:80,fees:[]})},$t=async s=>{if(!s.target.files||s.target.files.length===0)return;const r=s.target.files[0];ks(!0);try{const a=Wt(Ut,`services/${Date.now()}_${r.name}`),D=await zt(a,r),$=await Vt(D.ref);me(x=>x?{...x,image:$}:null),U("Image uploaded successfully!","success")}catch(a){console.error("Error uploading image:",a),U("Failed to upload image","error")}finally{ks(!1)}},Ps=s=>{if(Ue(!1),me({...s,washerCommission:s.washerCommission??80,fees:s.fees||[]}),le==="vehicleTypes"){Te({name:s.name,icon:s.icon});const r={},a=s.id;k.forEach(D=>{r[D.id]=D.price[a]||0}),j.forEach(D=>{r[D.id]=D.price[a]||0}),is(r)}},Mt=()=>{d({...H,id:""}),Ee(!1),ge({name:"",email:"",password:"",role:"washer",driverLicense:"",insuranceNumber:"",vehiclePlate:"",vehicleModel:""})},Ft=()=>{if(X){S(X.id,{status:X.status,washerId:X.washerId,date:X.date,time:X.time,price:X.price});const s=A.find(r=>r.name===X.clientName);s&&Gt.notifyOrderUpdate({phone:s.phone,email:s.email},X.id,X.status),ye(null)}},Pt=s=>{if(window.confirm(`âš ï¸ CANCEL ORDER

Are you sure you want to cancel this order?

This action cannot be undone.`))try{l(s),U("Order cancelled successfully","success");const r=h.find(a=>a.id===s);if(r){const a=A.find(D=>D.name===r.clientName);a&&ot(a.id,"Order Cancelled",`Your order ${s} has been cancelled by admin`,"info")}}catch{U("Error cancelling order","error")}},Es=s=>h.filter(r=>r.clientName===s&&(r.status==="Completed"||r.status==="Cancelled")),[q,Et]=c.useState(window.innerWidth>=1024);gs.useEffect(()=>{const s=()=>Et(window.innerWidth>=1024);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const ke=()=>e.jsxs("div",{className:"w-64 bg-surface-dark border-r border-white/10 flex flex-col h-full shrink-0",children:[e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-primary to-purple-500 bg-clip-text text-transparent",children:"Admin Panel"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Car Wash Manager"})]}),e.jsx("nav",{className:"flex-1 px-4 space-y-2 overflow-y-auto",children:[{s:g.ADMIN_DASHBOARD,i:"grid_view",l:"Dashboard"},{s:g.ADMIN_TEAM,i:"group",l:"Team Management"},{s:g.ADMIN_CLIENTS,i:"person",l:"Client Base"},{s:g.ADMIN_PRICING,i:"sell",l:"Services & Pricing"},{s:g.ADMIN_DISCOUNTS,i:"local_offer",l:"Discount Codes"},{s:g.ADMIN_ANALYTICS,i:"monitoring",l:"Analytics & Reports"},{s:g.ADMIN_PAYROLL,i:"payments",l:"Team Pay (Washers)"},{s:g.ADMIN_FINANCIAL_REPORTS,i:"receipt_long",l:"All Orders"},{s:g.ADMIN_WASHER_EARNINGS,i:"account_balance_wallet",l:"Washer Earnings"},{s:g.ADMIN_APP_EARNINGS,i:"trending_up",l:"App Revenue"},{s:g.ADMIN_TAX_REPORTS,i:"description",l:"Tax Reports"},{s:g.ADMIN_ISSUES,i:"support_agent",l:"Support Tickets"},{s:g.ADMIN_SETTINGS,i:"settings",l:"Configuration"}].map(s=>e.jsxs("button",{onClick:()=>u(s.s),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${n===s.s?"bg-primary text-white font-bold shadow-lg shadow-primary/20":"text-slate-400 hover:bg-white/5 hover:text-white"}`,children:[e.jsx("span",{className:"material-symbols-outlined",children:s.i}),e.jsx("span",{children:s.l})]},s.s))}),e.jsx("div",{className:"p-4 border-t border-white/10",children:e.jsx(Qs,{user:{name:pe.name,email:pe.email,avatar:pe.avatar,role:"admin"},onLogout:vs})})]});if(n===g.ADMIN_DASHBOARD)return e.jsxs("div",{className:`flex h-full bg-background-dark text-white ${q?"flex-row":"flex-col"}`,children:[q&&e.jsx(ke,{}),e.jsxs("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[e.jsxs("header",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Dashboard"}),e.jsx("p",{className:"text-slate-400 text-sm",children:new Date().toDateString()})]}),e.jsxs("div",{className:"flex flex-row items-center gap-2 shrink-0",children:[!q&&e.jsxs("button",{onClick:()=>u(g.ADMIN_ISSUES),className:"relative w-10 h-10 flex items-center justify-center hover:bg-white/5 rounded-lg transition-colors",title:"Support & Issues",children:[e.jsx("span",{className:"material-symbols-outlined text-slate-400 hover:text-primary",children:"support_agent"}),ts&&ts.filter(s=>s.status==="Open").length>0&&e.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),e.jsx("div",{className:"relative",children:(()=>{const s=i=>ie(i).getTime(),r=Date.now(),a=1440*60*1e3,D=parseInt(localStorage.getItem("adminLastViewedNotifications")||"0"),x=[...h.filter(i=>i.status==="Pending").map(i=>({id:i.id,type:"order",title:"New Order Received",subtitle:`Order from ${i.clientName}`,timeDisplay:i.time,timestamp:s(i.createdAt||i.date),data:i,icon:"add_shopping_cart",colorClass:"text-blue-400",bgClass:"bg-blue-500/20"})),...h.filter(i=>i.rating&&i.rating<3&&i.status==="Completed").map(i=>({id:i.id,type:"rating",title:"Low Rating Alert",subtitle:`Order #${i.displayId?i.displayId.replace(/^#/,""):i.id.substring(0,6)} rated ${i.rating} stars`,timeDisplay:"Completed",timestamp:s(i.completedAt||0),data:i,icon:"star_half",colorClass:"text-red-400",bgClass:"bg-red-500/20"})),...(ts||[]).filter(i=>i.status==="Open").map(i=>({id:i.id,type:"issue",title:"Open Support Issue",subtitle:i.subject,timeDisplay:"Open",timestamp:i.timestamp,data:i,icon:"report_problem",colorClass:"text-amber-400",bgClass:"bg-amber-500/20"})),...jt.filter(i=>i.status==="open"&&i.unreadByAdmin>0).map(i=>{var o,w;return{id:i.id,type:"support_ticket",title:"New Support Message",subtitle:`${i.userName||"User"}: ${i.unreadByAdmin} unread`,timeDisplay:"Unread",timestamp:(o=i.lastMessageAt)!=null&&o.toMillis?i.lastMessageAt.toMillis():(w=i.lastMessageAt)!=null&&w.seconds?i.lastMessageAt.seconds*1e3:Date.now(),data:i,icon:"chat",colorClass:"text-primary",bgClass:"bg-primary/20"}})].filter(i=>r-i.timestamp<a).sort((i,o)=>o.timestamp-i.timestamp),M=x.filter(i=>i.timestamp>D).length;return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{Ge||localStorage.setItem("adminLastViewedNotifications",Date.now().toString()),Je(!Ge)},className:`relative w-10 h-10 flex items-center justify-center hover:bg-white/5 rounded-lg transition-colors ${Ge?"bg-white/5 text-primary":"text-slate-400"}`,title:"Notifications",children:[e.jsx("span",{className:"material-symbols-outlined hover:text-primary",children:"notifications"}),M>0&&e.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center px-1",children:M>9?"9+":M})]}),Ge&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"md:hidden fixed inset-0 bg-black/50 z-[100]",onClick:()=>Je(!1)}),e.jsxs("div",{className:"fixed inset-0 md:absolute md:inset-auto md:right-0 md:top-12 md:w-80 bg-surface-dark md:border border-white/10 md:rounded-xl shadow-2xl z-[101] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-white/10 flex justify-between items-center bg-surface-dark",children:[e.jsx("h3",{className:"font-bold text-sm",children:te.t("notifications_title")}),e.jsx("button",{onClick:()=>Je(!1),className:"text-slate-400 hover:text-white",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[x.map(i=>e.jsxs("button",{onClick:()=>{(i.type==="order"||i.type==="rating")&&(u(g.ADMIN_DASHBOARD),ne(i.data)),i.type==="issue"&&u(g.ADMIN_ISSUES),i.type==="support_ticket"&&u(g.ADMIN_ISSUES),Je(!1)},className:"w-full text-left p-3 border-b border-white/5 hover:bg-white/5 flex gap-3 transition-colors relative",children:[e.jsx("div",{className:`w-8 h-8 rounded-full ${i.bgClass} flex items-center justify-center shrink-0`,children:e.jsx("span",{className:`material-symbols-outlined ${i.colorClass} text-sm`,children:i.icon})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"font-bold text-sm",children:i.title}),i.timestamp>D&&e.jsx("span",{className:"w-2 h-2 bg-primary rounded-full"})]}),e.jsx("div",{className:"text-xs text-slate-400",children:i.subtitle}),e.jsxs("div",{className:"text-[10px] text-slate-500 mt-1",children:[i.timeDisplay," â€¢ ",Math.floor((r-i.timestamp)/(1e3*60*60)),te.t("hours_ago")]})]})]},`${i.type}-${i.id}`)),x.length===0&&e.jsxs("div",{className:"p-8 text-center text-slate-500",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-50",children:"notifications_off"}),e.jsx("p",{className:"text-sm",children:"No new notifications"})]})]})]})]})]})})()}),e.jsx("button",{onClick:()=>u(g.ADMIN_DASHBOARD),className:"w-10 h-10 flex items-center justify-center hover:bg-white/5 rounded-lg transition-colors",children:e.jsx("span",{className:"material-symbols-outlined text-slate-400 hover:text-primary",children:"settings"})}),e.jsx(Qs,{user:{name:pe.name,email:pe.email,avatar:pe.avatar,role:"admin"},onLogout:vs})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:[e.jsxs("button",{onClick:()=>u(g.ADMIN_ANALYTICS),className:"bg-surface-dark p-4 rounded-xl border border-white/5 text-left hover:border-primary/50 hover:bg-white/5 transition-all group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-slate-400 text-xs uppercase font-bold group-hover:text-primary transition-colors",children:te.t("daily_sales")}),e.jsx("span",{className:"material-symbols-outlined text-green-400 group-hover:scale-110 transition-transform",children:"attach_money"})]}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:["$",bs.revenue.toFixed(2)]})]}),e.jsxs("button",{onClick:()=>u(g.ADMIN_PAYROLL),className:"bg-surface-dark p-4 rounded-xl border border-white/5 text-left hover:border-teal-400/50 hover:bg-white/5 transition-all group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-slate-400 text-xs uppercase font-bold group-hover:text-teal-400 transition-colors",children:te.t("washer_pay")}),e.jsx("span",{className:"material-symbols-outlined text-teal-400 group-hover:scale-110 transition-transform",children:"payments"})]}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:["$",bs.washerPay.toFixed(2)]})]}),e.jsxs("button",{onClick:()=>u(g.ADMIN_CLIENTS),className:"bg-surface-dark p-4 rounded-xl border border-white/5 text-left hover:border-blue-400/50 hover:bg-white/5 transition-all group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-slate-400 text-xs uppercase font-bold group-hover:text-blue-400 transition-colors",children:te.t("total_clients")}),e.jsx("span",{className:"material-symbols-outlined text-blue-400 group-hover:scale-110 transition-transform",children:"group_add"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:A.length})]}),e.jsxs("button",{onClick:()=>u(g.ADMIN_TEAM),className:"bg-surface-dark p-4 rounded-xl border border-white/5 text-left hover:border-purple-400/50 hover:bg-white/5 transition-all group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-slate-400 text-xs uppercase font-bold group-hover:text-purple-400 transition-colors",children:te.t("active_washers")}),e.jsx("span",{className:"material-symbols-outlined text-purple-400 group-hover:scale-110 transition-transform",children:"engineering"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:bs.activeWashers})]}),e.jsxs("button",{onClick:()=>u(g.ADMIN_ANALYTICS),className:"bg-surface-dark p-4 rounded-xl border border-white/5 text-left hover:border-yellow-400/50 hover:bg-white/5 transition-all group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-slate-400 text-xs uppercase font-bold group-hover:text-yellow-400 transition-colors",children:te.t("avg_rating")}),e.jsx("span",{className:"material-symbols-outlined text-yellow-400 group-hover:scale-110 transition-transform",children:"star"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:(()=>{const s=h.filter(a=>a.rating&&a.rating>0);return s.length===0?"0.0":(s.reduce((a,D)=>a+(D.rating||0),0)/s.length).toFixed(1)})()})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col gap-4 mb-4",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h2",{className:"font-bold text-lg",children:"Live Orders"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-between items-center",children:[e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx("span",{className:"material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-sm",children:"search"}),e.jsx("input",{type:"text",placeholder:"Order #, Client ID or Name...",value:Ye,onChange:s=>gt(s.target.value),className:"w-full bg-surface-dark border border-white/10 rounded-lg pl-9 pr-3 py-2 text-sm focus:border-primary/50 focus:outline-none"})]}),e.jsx("div",{className:"flex gap-2 text-xs overflow-x-auto w-full sm:w-auto pb-1 sm:pb-0",children:["All","Pending","In Progress","Assigned","Completed"].map(s=>e.jsx("button",{onClick:()=>xt(s),className:`px-3 py-1 rounded-full font-bold border whitespace-nowrap transition-colors ${Be===s?"bg-white text-black border-white":"border-white/20 text-slate-400 hover:border-white/50"}`,children:te.t(s.toLowerCase())||s},s))})]})]}),e.jsxs("div",{className:"space-y-3",children:[Ke.map(s=>e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5 hover:border-primary/50 transition-colors cursor-pointer group",onClick:r=>{r.target.closest("button")||ne(s)},children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-lg",children:s.time}),e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase ${s.status==="Pending"?"bg-blue-500/20 text-blue-400":s.status==="In Progress"?"bg-yellow-500/20 text-yellow-400":"bg-green-500/20 text-green-400"}`,children:s.status})]}),e.jsxs("h3",{className:"font-medium text-slate-300",children:[s.clientName," â€¢ ",s.vehicle]}),e.jsxs("div",{className:"text-[10px] text-slate-500 font-mono mt-0.5",children:["Client ID: ",s.clientId?s.clientId.substring(0,8)+"...":"N/A"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold",children:["$",s.price]}),e.jsxs("div",{className:"text-[10px] text-slate-500 font-mono mt-1",children:["Order #",s.id.substring(0,8)]}),s.status==="Completed"&&s.completedAt&&e.jsxs("div",{className:"text-[10px] text-green-400 font-bold mt-1",children:[new Date(s.completedAt).toLocaleDateString()," ",new Date(s.completedAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-slate-500 text-sm",children:"person"}),e.jsx("span",{className:"text-sm text-slate-400",children:s.washerName||"Unassigned"})]}),e.jsxs("div",{className:"flex gap-2",children:[s.status==="Pending"&&e.jsx("button",{onClick:()=>We(s.id),className:"bg-primary px-3 py-1.5 rounded-lg text-xs font-bold hover:bg-primary-dark",children:"Assign"}),s.status!=="Pending"&&s.status!=="Completed"&&e.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to force complete this order? The client will be notified.")&&S(s.id,{status:"Completed"})},className:"text-xs text-green-400 hover:text-green-300 font-bold border border-green-500/30 px-2 py-1.5 rounded",children:"Force Complete"}),s.status!=="Cancelled"&&s.status!=="Completed"&&e.jsxs("button",{onClick:()=>Pt(s.id),className:"text-xs text-red-400 hover:text-red-300 font-bold border border-red-500/30 px-2 py-1.5 rounded flex items-center gap-1",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"cancel"}),"Cancel"]}),e.jsxs("button",{onClick:()=>ne(s),className:"text-xs text-slate-400 hover:text-white border border-white/10 px-2 py-1.5 rounded flex items-center gap-1",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"visibility"})," View"]})]})]})]},s.id)),Ke.length===0&&e.jsx("div",{className:"text-center py-10 text-slate-500",children:"No active orders found"})]})]})]}),ws&&e.jsx("div",{className:"absolute inset-0 bg-black/80 z-50 flex items-end sm:items-center justify-center sm:p-4",children:e.jsxs("div",{className:"bg-surface-dark w-full sm:max-w-md rounded-t-2xl sm:rounded-2xl border border-white/10 shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold",children:"Assign Washer"}),e.jsx("button",{onClick:()=>We(null),children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsx("div",{className:"p-2 max-h-[60vh] overflow-y-auto",children:hs.map(s=>e.jsxs("button",{onClick:()=>{_(ws,s.id),We(null)},className:"w-full p-3 hover:bg-white/5 rounded-xl flex items-center gap-3 transition-colors text-left",children:[e.jsx("img",{src:s.avatar,className:"w-10 h-10 rounded-full object-cover",alt:s.name}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-bold",children:s.name}),e.jsxs("div",{className:"text-xs text-slate-400 flex items-center gap-2",children:[e.jsxs("span",{className:"flex items-center gap-0.5",children:[e.jsx("span",{className:"material-symbols-outlined text-[10px] text-yellow-400",children:"star"})," ",s.rating]}),e.jsxs("span",{children:["â€¢ ",s.completedJobs," jobs"]})]})]}),s.status==="On Job"?e.jsx("span",{className:"text-xs text-orange-400 font-bold",children:"Busy"}):e.jsx("span",{className:"text-xs text-green-400 font-bold",children:"Available"})]},s.id))})]})}),X&&e.jsx("div",{className:"absolute inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-surface-dark w-full max-w-md rounded-2xl border border-white/10 p-6 space-y-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("h3",{className:"font-bold text-lg",children:["Edit Order ",X.id]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-400",children:"Date"}),e.jsx("input",{type:"date",value:X.date,onChange:s=>ye({...X,date:s.target.value}),className:"w-full bg-white/5 border border-white/10 rounded p-2 mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-400",children:"Time"}),e.jsx("input",{type:"text",value:X.time,onChange:s=>ye({...X,time:s.target.value}),className:"w-full bg-white/5 border border-white/10 rounded p-2 mt-1"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-400",children:"Total Price ($)"}),e.jsx("input",{type:"number",value:X.price,onChange:s=>ye({...X,price:Number(s.target.value)}),className:"w-full bg-white/5 border border-white/10 rounded p-2 mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-400",children:"Status"}),e.jsxs("select",{value:X.status,onChange:s=>ye({...X,status:s.target.value}),className:"w-full bg-surface-dark text-white border border-white/10 rounded p-2 mt-1 focus:bg-surface-dark focus:outline-none",children:[e.jsx("option",{value:"New",children:"New"}),e.jsx("option",{value:"Assigned",children:"Assigned"}),e.jsx("option",{value:"In Progress",children:"In Progress"}),e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-400",children:"Washer"}),e.jsxs("select",{value:X.washerId||"",onChange:s=>ye({...X,washerId:s.target.value}),className:"w-full bg-surface-dark text-white border border-white/10 rounded p-2 mt-1 focus:bg-surface-dark focus:outline-none",children:[e.jsx("option",{value:"",children:"Unassigned"}),hs.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{onClick:()=>ye(null),className:"flex-1 py-3 rounded-xl font-bold text-slate-400 hover:bg-white/5",children:"Cancel"}),e.jsx("button",{onClick:Ft,className:"flex-1 py-3 rounded-xl font-bold bg-primary hover:bg-primary-dark",children:"Save Changes"})]})]})}),b&&e.jsx("div",{className:"absolute inset-0 bg-black/90 z-50 flex items-center justify-center p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-black w-full max-w-md rounded-3xl overflow-hidden border border-white/10 shadow-2xl flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-6 pb-4",children:[e.jsx("div",{className:"flex justify-between items-start mb-1",children:e.jsx("div",{className:"text-center w-full",children:e.jsxs("h3",{className:"font-bold text-xl",children:["Order: #",b.id.substring(0,8)]})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-medium",children:b.clientName}),e.jsxs("div",{className:"text-slate-400 text-sm",children:[b.date," @ ",b.time]})]}),e.jsx("div",{className:"absolute top-4 right-4 ",children:e.jsx("button",{onClick:()=>ne(null),className:"w-8 h-8 rounded-full bg-white/10 flex items-center justify-center hover:bg-white/20 transition-colors",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})})]}),e.jsx("div",{className:"bg-[#0066FF] p-4 text-center text-white font-medium text-lg leading-tight shadow-md relative",children:b.address}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-0",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600/20 to-purple-600/20 border-b border-white/10 p-6",children:[e.jsxs("h3",{className:"text-sm uppercase font-bold text-slate-400 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-blue-400",children:"person"}),"Client Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Name"}),e.jsx("p",{className:"font-bold text-white",children:b.clientName||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Phone"}),e.jsx("p",{className:"font-bold text-white",children:(()=>{const s=A.find(r=>r.id===b.clientId);return(s==null?void 0:s.phone)||"N/A"})()})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"Email"}),e.jsx("p",{className:"font-bold text-white",children:(()=>{const s=A.find(r=>r.id===b.clientId);return(s==null?void 0:s.email)||"N/A"})()})]})]})]}),e.jsxs("div",{className:"divide-y divide-white/10",children:[b.vehicleConfigs?b.vehicleConfigs.map((s,r)=>{const a=k.find(i=>i.id===s.packageId);let D=0;a&&a.price&&s.vehicleType&&(D=a.price[s.vehicleType]||0);let $=0;(s.addonIds||[]).map(i=>j.find(o=>o.id===i)).filter(Boolean).forEach(i=>$+=i.price||0);const M=D+$;return e.jsxs("div",{className:"p-4 py-5 hover:bg-white/5 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("div",{className:"font-bold text-lg",children:s.vehicleModel||b.vehicle}),e.jsxs("div",{className:"font-bold text-lg",children:["+$",M.toFixed(2)]})]}),e.jsx("div",{className:"text-slate-400 text-sm mb-2",children:(a==null?void 0:a.name)||"Standard Wash"}),s.addonIds&&s.addonIds.length>0&&e.jsx("div",{className:"space-y-1 pl-0",children:s.addonIds.map(i=>{const o=j.find(w=>w.id===i);return o?e.jsx("div",{className:"flex justify-between text-sm text-slate-400",children:e.jsxs("span",{children:["+ ",o.name]})},i):null})})]},r)}):e.jsxs("div",{className:"p-4 py-5",children:[e.jsx("div",{className:"flex justify-between items-start mb-1",children:e.jsx("div",{className:"font-bold text-lg",children:b.clientName})}),e.jsxs("div",{className:"text-green-400 text-sm font-bold mb-4",children:[b.date," @ ",b.time]}),e.jsx("div",{className:"bg-blue-600 text-white text-center py-3 px-4 rounded-lg mb-4 font-bold",children:((Os=b.location)==null?void 0:Os.address)||b.address||"No address"})]}),e.jsxs("div",{className:"p-4 space-y-2 text-sm",children:[b.vehicleConfigs&&b.vehicleConfigs.length>0?b.vehicleConfigs.map((s,r)=>{const a=k.find(o=>o.id===s.packageId),D=s.vehicleType||"sedan",$=(a==null?void 0:a.price[D])||0,M=j.filter(o=>{var w;return(w=s.addonIds)==null?void 0:w.includes(o.id)}).reduce((o,w)=>o+(w.price[D]||0),0),i=$+M;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-white font-bold",children:[e.jsx("span",{children:s.vehicleModel}),e.jsxs("span",{children:["+$",i.toFixed(2)]})]}),e.jsx("div",{className:"text-slate-400 text-xs ml-2",children:(a==null?void 0:a.name)||b.service})]},r)}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-white font-bold",children:[e.jsx("span",{children:b.vehicle}),e.jsxs("span",{children:["+$",b.price]})]}),e.jsx("div",{className:"text-slate-400 text-xs ml-2",children:b.service})]}),(b.time==="ASAP"||b.date==="ASAP")&&e.jsxs("div",{className:"flex justify-between text-amber-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:["ASAP Priority",e.jsx("span",{className:"material-symbols-outlined text-xs",children:"bolt"})]}),e.jsx("span",{children:"+$5.00"})]}),re&&re.length>0&&(()=>{const s=b.price||0;return re.map((r,a)=>{const D=s*r.percentage/100;return e.jsxs("div",{className:"flex justify-between text-white",children:[e.jsx("span",{children:r.name}),e.jsxs("span",{children:["-$",D.toFixed(2)]})]},a)})})(),b.tip&&b.tip>0&&e.jsxs("div",{className:"flex justify-between text-white",children:[e.jsx("span",{children:"Tip"}),e.jsxs("span",{children:["+$",b.tip.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-white/10 mt-2",children:[e.jsx("span",{className:"text-slate-500",children:"Status"}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-bold uppercase ${b.status==="Completed"?"bg-green-500/20 text-green-400":b.status==="Cancelled"?"bg-red-500/20 text-red-400":"bg-blue-500/20 text-blue-400"}`,children:b.status})]}),b.status==="Completed"&&b.completedAt&&e.jsxs("div",{className:"flex justify-between items-center pt-1",children:[e.jsx("span",{className:"text-slate-500 text-xs",children:"Completed At"}),e.jsx("span",{className:"text-xs text-green-400 font-bold",children:new Date(b.completedAt).toLocaleString()})]})]}),e.jsx("div",{className:"p-4 border-t border-white/10",children:e.jsx(Ns,{order:b})})]})]}),e.jsxs("div",{className:"p-6 border-t border-white/20 bg-black",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center text-slate-400 text-sm",children:[e.jsx("span",{children:"Subtotal (Order Price)"}),e.jsxs("span",{children:["$",(b.price||0).toFixed(2)]})]}),(()=>{const s=b.price||0,r=re.reduce((x,M)=>x+(M.percentage||0),0),a=s*r/100,D=b.tip||0,$=s-a+D;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center text-red-400 text-sm",children:[e.jsxs("span",{children:["Reflejo de Fees (",r,"%)"]}),e.jsxs("span",{children:["-$",a.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center text-green-400 text-sm",children:[e.jsx("span",{children:"Tip"}),e.jsxs("span",{children:["+$",D.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center text-white text-xl font-bold border-t border-white/20 pt-2 mt-1",children:[e.jsx("span",{children:"Washer Net Earnings"}),e.jsxs("span",{children:["$",$.toFixed(2)]})]})]})})()]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{ye(b);const s=b.vehicleConfigs&&b.vehicleConfigs.length>0?JSON.parse(JSON.stringify(b.vehicleConfigs)):[{vehicleId:"legacy",vehicleModel:b.vehicle||"Unknown Vehicle",vehicleType:b.vehicleType||"Sedan",vehicleColor:"Unknown",vehiclePlate:"Unknown",packageId:"",addonIds:[],vehicleImage:""}];xs(s),cs(b),ne(null)},className:"flex-1 py-3 rounded-xl bg-white/10 hover:bg-white/20 font-bold transition-colors",children:"Modify"}),b.status!=="Completed"&&b.status!=="Cancelled"&&e.jsx("button",{onClick:()=>{window.confirm("Force Complete?")&&(S(b.id,{status:"Completed"}),b.clientId?Yt(b.clientId).then(s=>{s>0?U(`Order completed & ${s} loyalty points awarded!`,"success"):U("Order completed","success")}):U("Order completed","success"),ne(null))},className:"flex-1 py-3 rounded-xl bg-green-500 text-black font-bold hover:bg-green-400 transition-colors",children:"Complete"}),b.status==="Pending"&&e.jsx("button",{onClick:()=>{We(b.id),ne(null)},className:"flex-1 py-3 rounded-xl bg-primary text-white font-bold hover:bg-primary-dark transition-colors",children:"Assign"})]})]})]})}),!q&&e.jsx(oe,{active:g.ADMIN_DASHBOARD,navigate:u})]})]});if(n===g.ADMIN_CLIENTS){const s=A.filter(r=>{const a=ns.toLowerCase();return r.name.toLowerCase().includes(a)||r.email.toLowerCase().includes(a)||r.phone.toLowerCase().includes(a)||r.id.toLowerCase().includes(a)});return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Clients"}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("span",{className:"material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",children:"search"}),e.jsx("input",{type:"text",placeholder:"Search by name, email, phone, or client #...",value:ns,onChange:r=>Cs(r.target.value),className:"w-full bg-surface-dark border border-white/10 rounded-xl pl-12 pr-4 py-3 text-white placeholder-slate-500 focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-all"}),ns&&e.jsx("button",{onClick:()=>Cs(""),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-white",children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsxs("div",{className:"space-y-3",children:[s.map(r=>e.jsxs("div",{onClick:()=>Ie(r),className:"bg-surface-dark p-4 rounded-xl border border-white/5 flex justify-between items-center cursor-pointer hover:bg-white/5",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold",children:r.name}),e.jsx("div",{className:"text-xs text-slate-400",children:r.email}),e.jsx("div",{className:"text-xs text-slate-500",children:r.phone}),e.jsxs("div",{className:"text-xs text-primary font-mono mt-1",children:["Client #",r.id.substring(0,8).toUpperCase()]})]}),e.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"chevron_right"})]},r.id)),s.length===0&&e.jsxs("div",{className:"text-center py-10 text-slate-500",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl mb-2",children:"search_off"}),e.jsx("p",{children:"No clients found"})]})]})]}),z&&e.jsxs("div",{className:"absolute inset-0 bg-background-dark z-30 flex flex-col animate-in slide-in-from-right",children:[e.jsxs("div",{className:"p-4 border-b border-white/10 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>Ie(null),children:e.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),e.jsx("h2",{className:"font-bold",children:z.name})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5 mb-6",children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase mb-3",children:"Contact Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-white/5 flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-slate-400 text-sm",children:"mail"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Email"}),e.jsx("p",{className:"font-medium",children:z.email})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-white/5 flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-slate-400 text-sm",children:"call"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Phone"}),e.jsx("p",{className:"font-medium",children:z.phone})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-white/5 flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-slate-400 text-sm",children:"location_on"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Address"}),e.jsx("p",{className:"font-medium",children:z.address})]})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-3 border-t border-white/5",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-amber-500/10 flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-amber-500 text-sm",children:"star"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Client Rating"}),e.jsxs("p",{className:"font-bold flex items-center gap-2",children:[typeof z.rating=="number"?z.rating.toFixed(1):"5.0",e.jsxs("span",{className:"text-xs font-normal text-slate-500",children:["(",z.cancellationCount||0," cancellations)"]})]})]})]})]})]}),e.jsx("div",{className:"bg-surface-dark p-0 rounded-xl border border-white/5 mb-6 overflow-hidden relative",children:(()=>{const r=z.loyaltyPoints||0,a=[...Re].reverse().find(M=>r>=M.minPoints)||Re[0],D=Re.findIndex(M=>M.name===a.name)+1,$=D<Re.length?Re[D]:null,x=$?(r-a.minPoints)/($.minPoints-a.minPoints)*100:100;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 relative z-10",style:{background:`linear-gradient(135deg, ${a.color}15 0%, ${a.color}05 100%)`},children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase mb-1",children:"Loyalty Program"}),e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",style:{color:a.color},children:[a.name,a.discount>0&&e.jsxs("span",{className:"text-xs bg-white/10 px-2 py-1 rounded-full text-white",children:[a.discount,"% OFF"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-slate-400",children:"Points Balance"}),e.jsx("p",{className:"text-2xl font-bold",children:r})]})]}),$&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 mb-1",children:[e.jsxs("span",{children:["Progress to ",$.name]}),e.jsxs("span",{children:[$.minPoints-r," points needed"]})]}),e.jsx("div",{className:"w-full bg-black/20 rounded-full h-2",children:e.jsx("div",{className:"h-full rounded-full transition-all",style:{width:`${Math.min(x,100)}%`,background:`linear-gradient(90deg, ${a.color}, ${$.color})`}})})]})]}),e.jsxs("div",{className:"p-4 border-t border-white/5 bg-black/20",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500 mb-2",children:"Current Benefits"}),e.jsxs("div",{className:"space-y-1",children:[a.benefits.slice(0,3).map((M,i)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-300",children:[e.jsx("span",{className:"material-symbols-outlined text-[10px] text-green-400",children:"check"}),M]},i)),a.benefits.length>3&&e.jsxs("div",{className:"text-[10px] text-slate-500 italic",children:["+ ",a.benefits.length-3," more benefits"]})]})]}),e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 rounded-full opacity-5 pointer-events-none",style:{background:a.color,transform:"translate(30%, -30%)"}})]})})()}),e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5 mb-6",children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase mb-3",children:"Role Management"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold",children:"Current Role"}),e.jsx("p",{className:"text-xs text-slate-400 capitalize",children:z.role||"client"})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${z.role==="admin"?"bg-red-500/20 text-red-400":z.role==="washer"?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400"}`,children:((Rs=z.role)==null?void 0:Rs.toUpperCase())||"CLIENT"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[e.jsxs("button",{onClick:async()=>{console.log("ðŸ”µ Make Washer button clicked"),console.log("viewingClientHistory:",z),console.log("updateUserProfile function:",typeof F),console.log("âœ… Executing promotion to Washer");try{await F(z.id,{role:"washer",status:"Active"}),console.log("âœ… updateUserProfile completed");try{const{NotificationService:r}=await Hs(async()=>{const{NotificationService:a}=await import("./NotificationService-zFEosYM1-1769119750716.js");return{NotificationService:a}},[]);await r.sendEmail(z.email,"ðŸŽ‰ Welcome to the Team! You Are Now a Washer",`Hi ${z.name},

Great news! You have been promoted to a Washer in our car wash team!

You can now log in to the Washer Panel using your existing credentials:

Email: ${z.email}

Simply log in to our app and you'll automatically be directed to the Washer Dashboard where you can start accepting jobs.

Welcome aboard!

Best regards,
The Car Wash Team`),console.log("âœ… Email sent")}catch(r){console.error("âŒ Error sending email:",r)}Ie(null)}catch(r){console.error("âŒ Error in updateUserProfile:",r),U("Error updating user role","error")}},className:"flex items-center justify-center gap-2 p-3 bg-blue-500/10 hover:bg-blue-500/20 border border-blue-500/30 rounded-lg transition-colors",children:[e.jsx("span",{className:"material-symbols-outlined text-blue-400 text-sm",children:"engineering"}),e.jsx("span",{className:"text-xs font-bold text-blue-400",children:"Make Washer"})]}),e.jsxs("button",{onClick:async()=>{if(window.confirm(`âš ï¸ Promote ${z.name} to Admin? This gives full access to the system.`)){F(z.id,{role:"admin",status:"Active"});try{const{NotificationService:r}=await Hs(async()=>{const{NotificationService:a}=await import("./NotificationService-zFEosYM1-1769119750716.js");return{NotificationService:a}},[]);await r.sendEmail(z.email,"ðŸŽ‰ You Are Now an Administrator",`Hi ${z.name},

You have been promoted to Administrator in our car wash system!

You can now log in to the Admin Panel using your existing credentials:

Email: ${z.email}

Simply log in to our app and you'll automatically be directed to the Admin Dashboard where you have full access to manage the system.

Best regards,
The Car Wash Team`)}catch(r){console.error("Error sending email:",r)}U(`${z.name} is now an Admin! Email sent.`,"success"),Ie(null)}},className:"flex items-center justify-center gap-2 p-3 bg-red-500/10 hover:bg-red-500/20 border border-red-500/30 rounded-lg transition-colors",children:[e.jsx("span",{className:"material-symbols-outlined text-red-400 text-sm",children:"admin_panel_settings"}),e.jsx("span",{className:"text-xs font-bold text-red-400",children:"Make Admin"})]})]}),z.role!=="client"&&e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsxs("button",{onClick:()=>{window.confirm(`Demote ${z.name} back to Client?`)&&(F(z.id,{role:"client"}),U(`${z.name} is now a Client`,"info"),Ie(null))},className:"w-full flex items-center justify-center gap-2 p-3 bg-slate-500/10 hover:bg-slate-500/20 border border-slate-500/30 rounded-lg transition-colors",children:[e.jsx("span",{className:"material-symbols-outlined text-slate-400 text-sm",children:"person"}),e.jsx("span",{className:"text-xs font-bold text-slate-400",children:"Demote to Client"})]}),e.jsxs("button",{onClick:()=>{window.confirm(`âš ï¸ DELETE ${z.name}? This action cannot be undone!`)&&(f(z.id),U(`${z.name} has been deleted`,"info"),Ie(null))},className:"w-full flex items-center justify-center gap-2 p-3 bg-red-500/10 hover:bg-red-500/20 border border-red-500/30 rounded-lg transition-colors",children:[e.jsx("span",{className:"material-symbols-outlined text-red-400 text-sm",children:"delete_forever"}),e.jsx("span",{className:"text-xs font-bold text-red-400",children:"Delete User"})]})]})]})]}),e.jsx("h3",{className:"text-sm font-bold text-slate-400 uppercase mb-4",children:"Order History"}),e.jsxs("div",{className:"space-y-3",children:[Es(z.name).map(r=>e.jsxs("div",{onClick:()=>ne(r),className:"bg-surface-dark p-3 rounded-lg border border-white/5 cursor-pointer hover:bg-white/10 transition-colors",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-bold",children:r.date}),e.jsx("span",{className:"text-xs",children:r.status})]}),e.jsx("div",{className:"text-sm text-slate-400",children:r.service}),e.jsxs("div",{className:"text-right font-bold text-sm",children:["$",r.price]})]},r.id)),Es(z.name).length===0&&e.jsx("div",{className:"text-slate-500 text-center",children:"No history available"})]})]})]}),b&&e.jsx("div",{className:"absolute inset-0 bg-black/90 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-surface-dark w-full max-w-2xl rounded-2xl border border-white/10 shadow-2xl flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold text-lg",children:["Order Details #",b.id]}),e.jsx("button",{onClick:()=>ne(null),children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase mb-2",children:"Client Info"}),e.jsx("p",{className:"font-bold text-lg",children:b.clientName}),e.jsx("p",{className:"text-sm text-slate-300",children:"123 Main St (Mock Address)"}),e.jsx("p",{className:"text-sm text-slate-300",children:"+1 (555) 000-0000"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-slate-400 uppercase mb-2",children:"Service Info"}),e.jsx("p",{className:"font-bold",children:b.service}),e.jsxs("p",{className:"text-sm text-slate-300",children:[b.vehicle," (",b.vehicleType,")"]}),e.jsxs("p",{className:"text-sm font-bold text-primary mt-1",children:["$",b.price]})]})]}),e.jsx("div",{children:e.jsx(Ns,{order:b})})]})]})}),e.jsx(oe,{active:g.ADMIN_CLIENTS,navigate:u})]})}if(n===g.ADMIN_PAYROLL){const s=(()=>{const x=[],M=new Date,i=M.getDay()||7,o=new Date(M);o.setDate(M.getDate()-(i-1)),o.setHours(0,0,0,0);for(let w=0;w<12;w++){const W=new Date(o);W.setDate(W.getDate()-w*7);const J=new Date(W);J.setDate(J.getDate()+6);const K=`${W.toLocaleDateString(void 0,{month:"short",day:"numeric"})} - ${J.toLocaleDateString(void 0,{month:"short",day:"numeric"})}`;x.push({value:W.getTime(),label:w===0?`Current Week (${K})`:K})}return x})(),r=(()=>{const x=new Date(qe),M=new Date(qe);M.setDate(M.getDate()+6),M.setHours(23,59,59,999);const i=h.filter(W=>{let J=0;if(W.completedAt)J=ie(W.completedAt).getTime();else{let R=W.date;if(R==="Today")R=new Date().toISOString().split("T")[0];else if(R==="Tomorrow"){const V=new Date;V.setDate(V.getDate()+1),R=V.toISOString().split("T")[0]}J=ie(R).getTime()}return J>=x.getTime()&&J<=M.getTime()&&(W.status==="Completed"||W.status==="Cancelled")}),o=[];return y.filter(W=>W.role==="washer").forEach(W=>{const J=i.filter(ee=>ee.washerId===W.id);if(J.length===0)return;const K=re.reduce((ee,he)=>ee+(he.percentage||0),0);let R=0,V=0,E=0,Q=0;const Ce=J.map(ee=>{const he=ee.price||0,xe=ee.tip||0;let de=0,ue=0;return ee.status==="Completed"&&(ue=he*K/100,de=he-ue+xe,R+=he,V+=xe,E+=ue,Q+=de),{...ee,calculatedNet:de,calculatedDeduction:ue}}),je=`week_${x.toISOString().split("T")[0]}`,Z=ce.find(ee=>ee.washerId===W.id&&ee.periodId===je);o.push({washer:W,gross:R,tips:V,deductions:E,net:Q,jobCount:J.length,isPaid:!!Z,payment:Z,orders:Ce})}),o})(),a=async x=>{if(!window.confirm(`Confirm payment of $${x.net.toFixed(2)} to ${x.washer.name}?`))return;const M=new Date(qe),i=`week_${M.toISOString().split("T")[0]}`;try{await st(Fe(ae,"payments"),{washerId:x.washer.id,washerName:x.washer.name,periodId:i,weekStart:M.toISOString(),amount:x.net,paidDate:new Date().toISOString(),paidBy:pe.id||"admin",status:"Paid",orderIds:x.orders.map(o=>o.id)}),U("Payment recorded successfully","success")}catch(o){console.error(o),U("Error recording payment","error")}},D=r.filter(x=>!x.isPaid).reduce((x,M)=>x+M.net,0),$=r.filter(x=>x.isPaid).reduce((x,M)=>x+M.net,0);return e.jsxs("div",{className:`flex h-full bg-background-dark text-white ${q?"flex-row":"flex-col"}`,children:[q&&e.jsx(ke,{}),e.jsx("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[e.jsxs("header",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Payroll & Payouts"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Manage team payments"})]}),e.jsx("select",{value:qe,onChange:x=>Dt(Number(x.target.value)),className:"bg-surface-dark border border-white/10 rounded-lg px-4 py-2 text-sm text-white focus:outline-none focus:border-primary",children:s.map(x=>e.jsx("option",{value:x.value,children:x.label},x.value))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsx("div",{className:"text-slate-400 text-xs uppercase font-bold mb-1",children:"To Pay (This Week)"}),e.jsxs("div",{className:"text-2xl font-bold text-yellow-400",children:["$",D.toFixed(2)]}),e.jsx("div",{className:"text-xs text-slate-500",children:"Unpaid balance"})]}),e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsx("div",{className:"text-slate-400 text-xs uppercase font-bold mb-1",children:"Paid (This Week)"}),e.jsxs("div",{className:"text-2xl font-bold text-teal-400",children:["$",$.toFixed(2)]}),e.jsx("div",{className:"text-xs text-slate-500",children:"Already disbursed"})]})]}),e.jsxs("div",{className:"flex border-b border-white/10",children:[e.jsx("button",{onClick:()=>$s("pending"),className:`px-6 py-3 text-sm font-bold border-b-2 transition-colors ${ps==="pending"?"border-primary text-white":"border-transparent text-slate-400 hover:text-white"}`,children:"Weekly Payouts"}),e.jsx("button",{onClick:()=>$s("history"),className:`px-6 py-3 text-sm font-bold border-b-2 transition-colors ${ps==="history"?"border-primary text-white":"border-transparent text-slate-400 hover:text-white"}`,children:"Payment History"})]}),ps==="pending"?e.jsx("div",{className:"space-y-4",children:r.length===0?e.jsxs("div",{className:"text-center py-12 text-slate-500 bg-surface-dark rounded-xl border border-white/5",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-50",children:"money_off"}),e.jsx("p",{children:"No completed jobs found for this week."})]}):r.map((x,M)=>e.jsxs("div",{className:"bg-surface-dark rounded-xl border border-white/5 overflow-hidden",children:[e.jsxs("div",{className:"p-4 flex flex-col md:flex-row justify-between items-center gap-4 cursor-pointer hover:bg-white/5 transition-colors",onClick:()=>It(us===x.washer.id?null:x.washer.id),children:[e.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[e.jsxs("div",{className:"w-10 h-10 rounded-full bg-slate-700 flex items-center justify-center font-bold text-white relative",children:[x.washer.name.charAt(0),e.jsx("div",{className:"absolute -bottom-1 -right-1 bg-surface-dark rounded-full",children:e.jsx("span",{className:`material-symbols-outlined text-sm ${us===x.washer.id?"rotate-180":""} transition-transform`,children:"expand_more"})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-white",children:x.washer.name}),e.jsxs("div",{className:"text-xs text-slate-400",children:[x.jobCount," Orders (Inc. Cancelled) â€¢ Gross: $",x.gross.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex items-center gap-6 w-full md:w-auto justify-between md:justify-end",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-400",children:"Net Pay"}),e.jsxs("div",{className:"text-xl font-bold text-white",children:["$",x.net.toFixed(2)]}),e.jsxs("div",{className:"text-[10px] text-slate-500",children:["Tips: $",x.tips.toFixed(2)]})]}),x.isPaid?e.jsxs("div",{className:"px-4 py-2 bg-teal-500/20 text-teal-400 rounded-lg text-sm font-bold flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"check_circle"}),"Paid"]}):e.jsx("button",{onClick:i=>{i.stopPropagation(),a(x)},className:"px-4 py-2 bg-primary hover:bg-primary-dark text-white rounded-lg text-sm font-bold transition-colors shadow-lg shadow-primary/20",children:"Mark Paid"})]})]}),us===x.washer.id&&e.jsx("div",{className:"border-t border-white/10 bg-black/20 p-4",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-slate-500 border-b border-white/10",children:[e.jsx("th",{className:"pb-2 font-normal",children:"Order #"}),e.jsx("th",{className:"pb-2 font-normal",children:"Status"}),e.jsx("th",{className:"pb-2 font-normal",children:"Date"}),e.jsx("th",{className:"pb-2 font-normal text-right",children:"Price"}),e.jsx("th",{className:"pb-2 font-normal text-right",children:"Fee (App)"}),e.jsx("th",{className:"pb-2 font-normal text-right",children:"Tip"}),e.jsx("th",{className:"pb-2 font-normal text-right text-teal-400",children:"Net Pay"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:x.orders.map(i=>e.jsxs("tr",{className:"text-slate-300 hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"py-3 flex items-center gap-2",children:e.jsxs("span",{className:"font-mono bg-white/10 px-1 rounded text-[10px] text-slate-400",children:["#",i.id.substring(0,8)]})}),e.jsx("td",{className:"py-3",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase ${i.status==="Completed"?"bg-green-500/20 text-green-400":i.status==="Cancelled"?"bg-red-500/20 text-red-400":"bg-slate-700 text-slate-300"}`,children:i.status})}),e.jsx("td",{className:"py-3 text-xs text-slate-500",children:ie(i.completedAt||i.date).toLocaleDateString()}),e.jsxs("td",{className:"py-3 text-right text-slate-400",children:["$",(i.price||0).toFixed(2)]}),e.jsxs("td",{className:"py-3 text-right text-red-400/70",children:["-$",(i.calculatedDeduction||0).toFixed(2)]}),e.jsxs("td",{className:"py-3 text-right text-yellow-400/70",children:["+$",(i.tip||0).toFixed(2)]}),e.jsxs("td",{className:"py-3 text-right font-bold text-teal-400",children:["$",(i.calculatedNet||0).toFixed(2)]})]},i.id))})]})})]},M))}):e.jsx("div",{className:"space-y-4",children:ce.length===0?e.jsx("div",{className:"text-center py-12 text-slate-500",children:"No payment history found."}):ce.map(x=>e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-white",children:x.washerName}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Week of ",new Date(x.periodId.replace("week_","")).toLocaleDateString()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold text-teal-400",children:["$",x.amount.toFixed(2)]}),e.jsxs("div",{className:"text-[10px] text-slate-500",children:["Paid: ",new Date(x.paidDate).toLocaleDateString()]})]})]},x.id))})]})})]})}if(n===g.ADMIN_ANALYTICS)return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Analytics"}),e.jsx("div",{className:"bg-surface-dark p-1 rounded-lg flex border border-white/10 mb-6",children:["day","week","month","year"].map(s=>e.jsx("button",{onClick:()=>ht(s),className:`flex-1 py-2 rounded-md font-bold text-sm transition-colors uppercase ${we===s?"bg-primary text-white shadow":"text-slate-400 hover:text-white"}`,children:s},s))}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-slate-400 text-xs uppercase font-bold",children:"Total Revenue"}),e.jsx("span",{className:"material-symbols-outlined text-green-400",children:"payments"})]}),e.jsxs("div",{className:"text-3xl font-bold text-green-400",children:["$",Xe.grossRevenue.toFixed(2)]}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Gross income (",we,")"]})]}),e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-slate-400 text-xs uppercase font-bold",children:"Washer Pay"}),e.jsx("span",{className:"material-symbols-outlined text-blue-400",children:"account_balance_wallet"})]}),e.jsxs("div",{className:"text-3xl font-bold text-blue-400",children:["$",Xe.washerPayout.toFixed(2)]}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Washer Share (Net + Tips)"})]}),e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-slate-400 text-xs uppercase font-bold",children:"App Profit"}),e.jsx("span",{className:"material-symbols-outlined text-purple-400",children:"savings"})]}),e.jsxs("div",{className:"text-3xl font-bold text-purple-400",children:["$",Xe.appProfit.toFixed(2)]}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Total Admin Fees"})]}),e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-slate-400 text-xs uppercase font-bold",children:"Orders"}),e.jsx("span",{className:"material-symbols-outlined text-white",children:"list_alt"})]}),e.jsx("div",{className:"text-3xl font-bold text-white",children:Xe.completedCount}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Completed (",we,")"]})]})]}),e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsx("h3",{className:"font-bold mb-4",children:"Recent Feedback"}),e.jsx("div",{className:"space-y-4",children:h.filter(s=>s.rating&&s.review).slice(0,3).length>0?h.filter(s=>s.rating&&s.review).slice(0,3).map(s=>e.jsxs("div",{className:"border-b border-white/5 pb-3 last:border-0",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"font-bold text-sm",children:s.clientName}),e.jsx("div",{className:"flex text-yellow-400 text-xs",children:Array.from({length:s.rating||0}).map((r,a)=>e.jsx("span",{className:"material-symbols-outlined text-sm",children:"star"},a))})]}),e.jsxs("p",{className:"text-xs text-slate-400",children:['"',s.review,'"']})]},s.id)):e.jsx("p",{className:"text-center text-slate-500 text-sm",children:"No feedback yet"})})]})]}),e.jsx(oe,{active:g.ADMIN_ANALYTICS,navigate:u})]});if(n===g.ADMIN_PRICING)return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white items-center",children:[e.jsxs("div",{className:"w-full max-w-5xl flex flex-col h-full",children:[e.jsxs("header",{className:"px-4 py-6 border-b border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>u(g.ADMIN_DASHBOARD),className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Services & Pricing"})]}),e.jsxs("button",{onClick:_t,className:"bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded-lg text-xs font-bold flex items-center gap-1",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"}),e.jsx("span",{className:"hidden sm:inline",children:"Add New"})]})]}),e.jsxs("div",{className:"bg-surface-dark p-1 rounded-lg flex border border-white/10",children:[e.jsx("button",{onClick:()=>Ae("packages"),className:`flex-1 py-2 rounded-md font-bold text-sm transition-colors ${le==="packages"?"bg-primary text-white shadow":"text-slate-400 hover:text-white"}`,children:"Packages"}),e.jsx("button",{onClick:()=>Ae("addons"),className:`flex-1 py-2 rounded-md font-bold text-sm transition-colors ${le==="addons"?"bg-primary text-white shadow":"text-slate-400 hover:text-white"}`,children:"Add-ons"}),e.jsx("button",{onClick:()=>Ae("vehicleTypes"),className:`flex-1 py-2 rounded-md font-bold text-sm transition-colors ${le==="vehicleTypes"?"bg-primary text-white shadow":"text-slate-400 hover:text-white"}`,children:"Vehicle Types"}),e.jsx("button",{onClick:()=>Ae("settings"),className:`px-4 py-2 rounded-md font-bold text-sm transition-colors flex items-center justify-center ${le==="settings"?"bg-primary text-white shadow":"text-slate-400 hover:text-white"}`,children:e.jsx("span",{className:"material-symbols-outlined text-lg",children:"settings"})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 py-6 pb-24 space-y-4",children:[le==="packages"&&e.jsx("div",{className:"mb-6 flex gap-2",children:e.jsxs("button",{onClick:async()=>{confirm("This will RESET all packages to defaults (Basic, Premium, Deluxe) with new pricing structure. Continue?")&&(await oa(),U("Packages seeded successfully!","success"))},className:"bg-purple-500/20 text-purple-400 px-4 py-2 rounded-lg text-sm font-bold hover:bg-purple-500/30 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined",children:"database"}),"Seed Default Packages"]})}),le==="packages"&&k.map(s=>e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5 flex gap-4 items-start group",children:[e.jsx("div",{className:"w-20 h-20 rounded-lg bg-cover bg-center shrink-0",style:{backgroundImage:`url("${s.image||"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='150' height='150' viewBox='0 0 150 150'%3E%3Crect width='100%25' height='100%25' fill='%231a2431'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-family='Inter,sans-serif' font-size='14' fill='%23a0aec0'%3ENo Image%3C/text%3E%3C/svg%3E"}")`}}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"font-bold text-lg",children:s.name}),e.jsxs("span",{className:"text-primary font-bold text-lg",children:["$",s.price.Sedan,"+"]})]}),e.jsx("p",{className:"text-sm text-slate-400 mt-1 line-clamp-2",children:s.description}),e.jsx("div",{className:"flex items-center gap-4 mt-3",children:e.jsxs("span",{className:"text-xs text-slate-500 flex items-center gap-1",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"schedule"})," ",s.duration]})})]}),e.jsxs("div",{className:"flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>Ps(s),className:"p-2 bg-white/10 rounded-lg hover:bg-white/20",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),e.jsx("button",{onClick:()=>Ms(s.id),className:"p-2 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500/20",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]},s.id)),le==="addons"&&j.map(s=>e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5 flex items-center justify-between group",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:s.name}),e.jsx("p",{className:"text-sm text-slate-400",children:s.description}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsxs("span",{className:"text-xs text-slate-500 flex items-center gap-1",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"schedule"})," ",s.duration]})})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("span",{className:"text-primary font-bold text-lg",children:["$",s.price.Sedan,"+"]}),e.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>Ps(s),className:"p-2 bg-white/10 rounded-lg hover:bg-white/20",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),e.jsx("button",{onClick:()=>Ms(s.id),className:"p-2 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500/20",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]})]},s.id)),le==="vehicleTypes"&&e.jsx("div",{className:"mb-6 flex gap-2",children:e.jsxs("button",{onClick:async()=>{confirm("This will reset vehicle types to default. Continue?")&&(await da(),U("Vehicle types seeded!","success"))},className:"bg-purple-500/20 text-purple-400 px-4 py-2 rounded-lg text-sm font-bold hover:bg-purple-500/30 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined",children:"database"}),"Seed Default Types"]})}),le==="vehicleTypes"&&p.map(s=>e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5 flex items-center justify-between group",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-white/5 flex items-center justify-center overflow-hidden p-2",children:fs(s.icon)}),e.jsx("h3",{className:"font-bold text-lg",children:s.name})]}),e.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>{Ue(!1),me(s),Te({name:s.name,icon:s.icon||"directions_car"})},className:"p-2 bg-white/10 rounded-lg hover:bg-white/20",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"edit"})}),e.jsx("button",{onClick:()=>{window.confirm("Delete this vehicle type?")&&I(s.id)},className:"p-2 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500/20",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]},s.id)),le==="settings"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-surface-dark p-6 rounded-xl border border-white/5",children:[e.jsxs("h3",{className:"font-bold text-lg mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-primary",children:"percent"}),"Global Order Deductions"]}),e.jsx("p",{className:"text-sm text-slate-400 mb-6",children:"These fees are automatically deducted from the Total Order Price before calculating Washer payout."}),e.jsxs("div",{className:"space-y-4",children:[re.map((s,r)=>e.jsxs("div",{className:"flex items-center gap-3 bg-white/5 p-4 rounded-xl border border-white/10",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center font-bold",children:"%"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"text",value:s.name,onChange:a=>_s(r,"name",a.target.value),className:"font-bold bg-transparent outline-none w-full text-white"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Deduction"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",value:s.percentage,onChange:a=>_s(r,"percentage",parseFloat(a.target.value)),className:"font-bold text-xl bg-transparent outline-none text-right w-16 text-white"}),e.jsx("span",{className:"font-bold text-xl text-white",children:"%"}),e.jsx("button",{onClick:()=>At(r),className:"p-2 hover:bg-white/10 rounded-lg text-red-400",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"delete"})})]})]},r)),e.jsxs("button",{onClick:St,className:"w-full py-3 border border-dashed border-white/20 rounded-xl text-slate-400 hover:text-white hover:border-white/40 font-bold text-sm flex items-center justify-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined",children:"add"}),"Add New Fee"]}),e.jsx("div",{className:"pt-4 border-t border-white/10 flex justify-end",children:e.jsx("button",{onClick:Ct,className:"bg-primary px-6 py-2 rounded-lg font-bold hover:bg-primary-dark text-white",children:"Save Changes"})}),e.jsxs("div",{className:"pt-8 mt-8 border-t border-white/10",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-2",children:[te.t("language")," / Idioma"]}),e.jsx("p",{className:"text-sm text-slate-400 mb-4",children:"Choose your preferred language / Elige tu idioma preferido"}),e.jsxs("div",{className:"flex gap-4 max-w-md",children:[e.jsx("button",{onClick:()=>{te.setLanguage("en"),window.location.reload()},className:`flex-1 py-3 rounded-xl border-2 font-bold transition-all ${te.language==="en"?"border-primary bg-primary/10 text-primary":"border-white/5 bg-white/5 text-slate-400"}`,children:"English"}),e.jsx("button",{onClick:()=>{te.setLanguage("es"),window.location.reload()},className:`flex-1 py-3 rounded-xl border-2 font-bold transition-all ${te.language==="es"?"border-primary bg-primary/10 text-primary":"border-white/5 bg-white/5 text-slate-400"}`,children:"EspaÃ±ol"})]})]})]})]})})]})]}),bt&&e.jsx("div",{className:"absolute inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-surface-dark w-full max-w-sm rounded-2xl border border-white/10 shadow-2xl p-6 text-center",children:[e.jsx("h3",{className:"text-xl font-bold mb-6",children:"What would you like to add?"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>Fs("packages"),className:"w-full py-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl font-bold flex items-center justify-center gap-2 transition-colors",children:[e.jsx("span",{className:"material-symbols-outlined text-primary",children:"inventory_2"})," Service Package"]}),e.jsxs("button",{onClick:()=>Fs("addons"),className:"w-full py-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl font-bold flex items-center justify-center gap-2 transition-colors",children:[e.jsx("span",{className:"material-symbols-outlined text-purple-400",children:"extension"})," Add-on Service"]}),e.jsxs("button",{onClick:()=>{const s=`vt_${Date.now()}`;Ae("vehicleTypes"),ze(!1),Ue(!0),me({id:s,name:"New Vehicle Type"}),Te({name:"",icon:"directions_car"})},className:"w-full py-4 bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl font-bold flex items-center justify-center gap-2 transition-colors",children:[e.jsx("span",{className:"material-symbols-outlined text-slate-300",children:"directions_car"})," Vehicle Type"]})]}),e.jsx("button",{onClick:()=>ze(!1),className:"mt-6 text-slate-400 text-sm hover:text-white",children:"Cancel"})]})}),se&&e.jsx("div",{className:"absolute inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-surface-dark w-full max-w-md rounded-2xl border border-white/10 shadow-2xl flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold text-lg",children:[ut?"Add New":"Edit"," ",le==="packages"?"Package":"Add-on"]}),e.jsx("button",{onClick:()=>me(null),children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto space-y-4",children:le==="vehicleTypes"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase mb-1",children:"Vehicle Type Name"}),e.jsx("input",{type:"text",value:ve.name,onChange:s=>Te({...ve,name:s.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 h-10 text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase mb-1",children:"Icon (URL or Material Symbol)"}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"text",value:ve.icon,onChange:s=>Te({...ve,icon:s.target.value}),className:"flex-1 bg-white/5 border border-white/10 rounded-lg px-3 h-10 text-white",placeholder:"e.g. directions_car or /assets/sedan.png"}),e.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/10 flex items-center justify-center overflow-hidden p-1",children:ve.icon&&fs(ve.icon)})]}),e.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase mb-2",children:"Quick Select"}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:[{i:"/assets/vehicles/sedan.webp",l:"Sedan"},{i:"/assets/vehicles/suv.webp",l:"SUV"},{i:"/assets/vehicles/pickup.webp",l:"Pickup"},{i:"/assets/vehicles/van.webp",l:"Van"},{i:"/assets/vehicles/trailer.webp",l:"Trailer"},{i:"/assets/vehicles/trailer_box.webp",l:"Trl Box"},{i:"two_wheeler",l:"Moto"},{i:"sports_motorsports",l:"Sport"},{i:"agriculture",l:"Tractor"},{i:"directions_bus",l:"Bus"}].map(s=>e.jsxs("button",{onClick:()=>Te({...ve,icon:s.i}),className:`p-2 rounded-lg border flex flex-col items-center gap-1 ${ve.icon===s.i?"bg-primary/20 border-primary":"bg-white/5 border-white/10 hover:bg-white/10"}`,children:[e.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:fs(s.i)}),e.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:s.l})]},s.i))}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-white/10",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase mb-3",children:"Prices for this Vehicle Type"}),e.jsxs("div",{className:"space-y-1 bg-white/5 rounded-xl p-2 max-h-64 overflow-y-auto",children:[k.length===0&&j.length===0&&e.jsx("div",{className:"text-center text-slate-500 py-4 text-xs",children:"No services found."}),e.jsx("h4",{className:"text-[9px] font-bold text-slate-600 uppercase px-2 py-1 mt-2",children:"Packages"}),k.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-white/5 transition-colors border border-transparent hover:border-white/5",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[e.jsx("span",{className:"text-sm font-bold block text-white truncate",children:s.name}),e.jsx("span",{className:"text-[10px] text-slate-500 block",children:s.duration||"No duration"})]}),e.jsxs("div",{className:"flex items-center bg-black/40 rounded-lg border border-white/10 focus-within:border-primary transition-colors overflow-hidden w-24",children:[e.jsx("span",{className:"pl-3 text-slate-500 text-sm",children:"$"}),e.jsx("input",{type:"number",value:De[s.id]||0,onChange:r=>is({...De,[s.id]:parseFloat(r.target.value)||0}),className:"w-full bg-transparent p-2 text-right font-bold text-white outline-none text-sm",placeholder:"0"})]})]},s.id)),e.jsx("h4",{className:"text-[9px] font-bold text-slate-600 uppercase px-2 py-1 mt-4",children:"Add-ons"}),j.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-white/5 transition-colors border border-transparent hover:border-white/5",children:[e.jsx("div",{className:"flex-1 min-w-0 pr-4",children:e.jsx("span",{className:"text-sm font-bold block text-white truncate",children:s.name})}),e.jsxs("div",{className:"flex items-center bg-black/40 rounded-lg border border-white/10 focus-within:border-primary transition-colors overflow-hidden w-24",children:[e.jsx("span",{className:"pl-3 text-slate-500 text-sm",children:"$"}),e.jsx("input",{type:"number",value:De[s.id]||0,onChange:r=>is({...De,[s.id]:parseFloat(r.target.value)||0}),className:"w-full bg-transparent p-2 text-right font-bold text-white outline-none text-sm",placeholder:"0"})]})]},s.id))]}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-2 text-center",children:"Updating these prices will actively modify the Pricing structure for all selected Services."})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase mb-1",children:"Name"}),e.jsx("input",{type:"text",value:se.name,onChange:s=>me({...se,name:s.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 h-10 text-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase mb-1",children:"Prices per Vehicle Type"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:(p&&p.length>0?p:[]).map(s=>{var r;return e.jsxs("div",{className:"flex items-center gap-2 bg-white/5 p-2 rounded-lg border border-white/10",children:[e.jsx("div",{className:"flex flex-col flex-1 min-w-0",children:e.jsx("span",{className:"text-[10px] font-bold text-slate-400 truncate uppercase",children:s.name})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("input",{type:"number",value:((r=se.price)==null?void 0:r[s.id])||0,onChange:a=>me({...se,price:{...se.price,[s.id]:parseFloat(a.target.value)||0}}),className:"w-16 bg-transparent text-right font-bold focus:outline-none text-white text-sm"}),e.jsx("span",{className:"text-slate-500 text-xs",children:"$"})]})]},s.id)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase mb-1",children:"Duration"}),e.jsx("input",{type:"text",value:se.duration||"",onChange:s=>me({...se,duration:s.target.value}),placeholder:"e.g. 30m",className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 h-10 text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase mb-1",children:"Description"}),e.jsx("textarea",{rows:3,value:se.description,onChange:s=>me({...se,description:s.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-lg p-3 text-sm text-white"})]}),(le==="packages"||le==="addons")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-400 uppercase mb-1",children:"Image"}),mt?e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-white/5 rounded-lg border border-white/10",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-primary border-t-transparent animate-spin"}),e.jsx("span",{className:"text-sm text-slate-300",children:"Uploading image..."})]}):e.jsxs("div",{className:"space-y-3",children:[se.image&&e.jsxs("div",{className:"relative w-full h-32 rounded-lg overflow-hidden border border-white/10 group",children:[e.jsx("img",{src:se.image,alt:"Service Item",className:"w-full h-full object-cover"}),e.jsx("button",{onClick:()=>me({...se,image:""}),className:"absolute top-2 right-2 p-1 bg-red-500 rounded-full text-white opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("span",{className:"material-symbols-outlined text-sm",children:"close"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("label",{className:"flex-1 cursor-pointer bg-white/5 border border-white/10 hover:bg-white/10 border-dashed rounded-lg p-3 flex flex-col items-center justify-center gap-2 transition-colors",children:[e.jsx("span",{className:"material-symbols-outlined text-slate-400",children:"cloud_upload"}),e.jsx("span",{className:"text-xs text-slate-400 font-bold uppercase",children:"Upload Photo"}),e.jsx("input",{type:"file",accept:"image/*",onChange:$t,className:"hidden"})]}),e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",value:se.image||"",onChange:s=>me({...se,image:s.target.value}),className:"w-full h-full bg-white/5 border border-white/10 rounded-lg px-3 text-white text-xs",placeholder:"Or paste URL..."})})]})]})]})]})}),e.jsx("div",{className:"p-4 border-t border-white/10",children:e.jsx("button",{onClick:Tt,className:"w-full bg-primary h-12 rounded-xl font-bold hover:bg-primary-dark transition-colors",children:"Save"})})]})}),e.jsx(oe,{active:g.ADMIN_PRICING,navigate:u})]});const Ot=s=>{ge({...s,password:""}),Ee(!0)};if(n===g.ADMIN_DASHBOARD)return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white",children:[e.jsx("div",{className:"px-4 mb-4",children:e.jsxs("div",{className:"flex bg-surface-dark rounded-lg p-1 border border-white/10",children:[e.jsx("button",{onClick:()=>Is("live"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-colors ${Oe==="live"?"bg-primary text-white":"text-slate-400 hover:text-white"}`,children:"Live Orders"}),e.jsx("button",{onClick:()=>Is("history"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-colors ${Oe==="history"?"bg-primary text-white":"text-slate-400 hover:text-white"}`,children:"History"})]})}),e.jsxs("div",{className:"space-y-3 px-4 pb-20 overflow-y-auto",children:[Ke.filter(s=>Oe==="live"?s.status!=="Completed"&&s.status!=="Cancelled":s.status==="Completed"||s.status==="Cancelled").map(s=>e.jsxs("div",{onClick:()=>ne(s),className:"bg-surface-dark p-4 rounded-xl border border-white/5 cursor-pointer hover:bg-white/5 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-xs font-bold px-2 py-0.5 rounded-full mb-1 inline-block ${s.status==="Pending"?"bg-green-500/20 text-green-500":s.status==="Cancelled"?"bg-red-500/20 text-red-500":"bg-primary/20 text-primary"}`,children:s.status}),e.jsx("h3",{className:"font-bold",children:s.service}),e.jsx("p",{className:"text-sm text-slate-400",children:s.clientName||"Unknown Client"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold",children:["$",s.price]}),e.jsx("p",{className:"text-xs text-slate-500",children:s.time})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 mt-2",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"directions_car"}),s.vehicle||"Unknown Vehicle"]})]},s.id)),Ke.filter(s=>Oe==="live"?s.status!=="Completed"&&s.status!=="Cancelled":s.status==="Completed"||s.status==="Cancelled").length===0&&e.jsx("div",{className:"text-center py-10 text-slate-500",children:e.jsxs("p",{children:["No orders found in ",Oe," view."]})})]}),b&&e.jsx("div",{className:"absolute inset-0 bg-black/90 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-surface-dark w-full max-w-4xl rounded-2xl border border-white/10 shadow-2xl flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold text-lg",children:["Order #",b.id.substring(0,8),"... - ",b.status]}),e.jsx("button",{onClick:()=>ne(null),className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase mb-3 px-1 border-l-2 border-primary",children:"Customer"}),e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5",children:[e.jsx("p",{className:"font-bold text-lg text-white",children:b.clientName}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:b.address}),e.jsxs("div",{className:"flex items-center gap-2 mt-3 text-primary text-sm font-bold",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"call"}),b.clientPhone||"No phone"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase mb-3 px-1 border-l-2 border-blue-500",children:"Service"}),e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5",children:[e.jsx("p",{className:"font-bold text-white",children:b.service}),e.jsxs("p",{className:"text-sm text-slate-300",children:[b.vehicle," (",b.vehicleType,")"]}),e.jsxs("div",{className:"flex items-center gap-2 mt-3 text-slate-400 text-xs",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"schedule"}),b.date," at ",b.time]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase mb-3 px-1 border-l-2 border-purple-500",children:"Assigned Washer"}),b.washerId?e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/5 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-700 overflow-hidden",children:b.washerAvatar?e.jsx("img",{src:b.washerAvatar,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-slate-500",children:"person"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white text-sm",children:b.washerName}),e.jsx("button",{onClick:()=>{const s=y.find(r=>r.id===b.washerId);s&&(He(s),ne(null))},className:"text-[10px] text-primary hover:underline font-bold",children:"View Profile"})]})]}):e.jsx("div",{className:"bg-amber-500/10 p-4 rounded-xl border border-amber-500/20 text-center",children:e.jsx("p",{className:"text-xs text-amber-500 font-bold uppercase",children:"Unassigned"})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase mb-3 px-1 border-l-2 border-green-500",children:"Earnings Breakdown"}),e.jsxs("div",{className:"bg-white/5 rounded-2xl border border-white/5 overflow-hidden",children:[e.jsxs("div",{className:"p-5 border-b border-white/5 bg-white/5",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm text-slate-400",children:"Total Price"}),e.jsxs("span",{className:"text-2xl font-black text-white",children:["$",(Ls=b.price)==null?void 0:Ls.toFixed(2)]})]}),b.tip>0&&e.jsxs("div",{className:"flex justify-between items-center text-amber-400 text-xs font-bold",children:[e.jsx("span",{children:"+ Customer Tip"}),e.jsxs("span",{children:["$",b.tip.toFixed(2)]})]})]}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-emerald-400",children:"Washer Earnings (77%)"}),e.jsx("p",{className:"text-[10px] text-slate-500",children:"Sent direct to bank"})]}),e.jsxs("span",{className:"text-lg font-bold text-white",children:["$",((b.price||0)*.77+(b.tip||0)).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center border-t border-white/5 pt-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-300",children:"Platform Fee (20%)"}),e.jsx("p",{className:"text-[10px] text-slate-500",children:"App maintenance"})]}),e.jsxs("span",{className:"text-sm font-bold text-slate-400",children:["$",((b.price||0)*.2).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center bg-black/20 p-3 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-slate-500",children:"Processing Fee (3%)"}),e.jsx("p",{className:"text-[9px] text-slate-600",children:"Stripe commissions"})]}),e.jsxs("span",{className:"text-xs font-bold text-slate-500",children:["$",((b.price||0)*.03).toFixed(2)]})]})]})]}),e.jsxs("div",{className:"p-4 bg-primary/10 border border-primary/20 rounded-xl",children:[e.jsx("p",{className:"text-[10px] text-primary font-bold uppercase mb-1",children:"Payment Status"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-primary text-sm",children:"verified_user"}),e.jsx("span",{className:"text-sm font-bold text-white",children:"Paid via Stripe"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase px-1 border-l-2 border-orange-500",children:"Evidence"}),e.jsx(Ns,{order:b})]})]})})]})}),os&&e.jsx("div",{className:"absolute inset-0 bg-black/90 z-[60] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-surface-dark w-full max-w-2xl rounded-2xl border border-white/10 flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Modify Services"}),e.jsx("button",{onClick:()=>cs(null),children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsx("div",{className:"p-4 overflow-y-auto flex-1 space-y-6",children:Se.map((s,r)=>{const a=k,D=s.vehicleType||"Sedan",$=k.find(i=>i.id===s.packageId),x=j.filter(i=>s.addonIds.includes(i.id)),M=(($==null?void 0:$.price[D])||0)+x.reduce((i,o)=>i+(o.price[D]||0),0);return e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4 pb-4 border-b border-white/5",children:[e.jsx("div",{className:"w-16 h-16 rounded-lg bg-cover bg-center border border-white/10",style:{backgroundImage:`url("${s.vehicleImage}")`}}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-lg",children:s.vehicleModel}),e.jsxs("div",{className:"text-xs text-slate-400",children:[s.vehiclePlate," â€¢ ",s.vehicleColor]}),e.jsx("div",{className:"text-xs text-primary font-bold mt-1 uppercase",children:D})]}),e.jsxs("div",{className:"ml-auto text-xl font-bold",children:["$",M]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"text-xs text-slate-400 uppercase font-bold block mb-2",children:"Package"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:a.map(i=>e.jsxs("button",{onClick:()=>{const o=[...Se];o[r].packageId=i.id,xs(o)},className:`p-3 rounded-lg border text-left transition-all ${s.packageId===i.id?"bg-primary/20 border-primary text-white":"bg-black/20 border-white/10 text-slate-400 hover:bg-white/5"}`,children:[e.jsx("div",{className:"font-bold text-sm",children:i.name}),e.jsxs("div",{className:"text-xs opacity-70",children:["$",i.price[D]]})]},i.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-400 uppercase font-bold block mb-2",children:"Add-ons"}),e.jsx("div",{className:"space-y-2",children:j.map(i=>{const o=s.addonIds.includes(i.id);return e.jsxs("button",{onClick:()=>{const w=[...Se];o?w[r].addonIds=w[r].addonIds.filter(W=>W!==i.id):w[r].addonIds.push(i.id),xs(w)},className:`w-full p-3 rounded-lg border flex justify-between items-center transition-all ${o?"bg-primary/10 border-primary/50 text-white":"bg-black/20 border-white/10 text-slate-400 hover:bg-white/5"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${o?"bg-primary border-primary":"border-slate-600"}`,children:o&&e.jsx("span",{className:"material-symbols-outlined text-[10px]",children:"check"})}),e.jsx("span",{className:"text-sm font-medium",children:i.name})]}),e.jsxs("span",{className:"text-xs font-bold",children:["+$",i.price[D]]})]},i.id)})})]})]},r)})}),e.jsxs("div",{className:"p-4 border-t border-white/10 bg-surface-dark",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("span",{className:"text-slate-400 font-bold",children:"New Total"}),e.jsxs("span",{className:"text-2xl font-bold text-primary",children:["$",Se.reduce((s,r)=>{const a=r.vehicleType||"Sedan",D=k.find(M=>M.id===r.packageId),$=(D==null?void 0:D.price[a])||0,x=j.filter(M=>r.addonIds.includes(M.id)).reduce((M,i)=>M+(i.price[a]||0),0);return s+$+x},0).toFixed(2)]})]}),e.jsx("button",{onClick:()=>{const s=Se.reduce((r,a)=>{const D=a.vehicleType||"Sedan",$=k.find(i=>i.id===a.packageId),x=($==null?void 0:$.price[D])||0,M=j.filter(i=>a.addonIds.includes(i.id)).reduce((i,o)=>i+(o.price[D]||0),0);return r+x+M},0);S(os.id,{vehicleConfigs:Se,price:s}),cs(null),b&&b.id===os.id&&ne({...b,vehicleConfigs:Se,price:s}),U("Services updated successfully","success")},className:"w-full h-12 bg-primary rounded-xl font-bold hover:bg-primary-dark transition-colors",children:"Save Changes"})]})]})}),Ve&&e.jsx("div",{className:"absolute inset-0 bg-background-dark z-[70] flex flex-col",children:e.jsx(js,{washerId:Ve.id,orders:h,team:y,globalFees:re,navigate:u,onBack:()=>He(null),onViewOrder:s=>{ne(s)}})}),e.jsx(oe,{active:g.ADMIN_DASHBOARD,navigate:u})]});if(n===g.ADMIN_TEAM){const s=y.filter(a=>a.role==="washer"&&a.status!=="Blocked"),r=ct||[];return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white",children:[e.jsxs("header",{className:"p-4 border-b border-white/5 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Team Management ðŸ›¡ï¸"}),e.jsxs("p",{className:"text-xs text-slate-400",children:[s.length," Active â€¢ ",r.length," Pending"]})]}),e.jsxs("button",{onClick:()=>{ge({name:"",email:"",password:"",role:"washer",driverLicense:"",insuranceNumber:"",vehiclePlate:"",vehicleModel:""}),Ee(!0)},className:"bg-primary hover:bg-primary-dark text-black px-4 py-2 rounded-lg font-bold text-sm flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"add"}),"Add Member"]})]}),e.jsx("div",{className:"px-4 mt-4",children:e.jsxs("div",{className:"flex bg-surface-dark rounded-lg p-1 border border-white/10",children:[e.jsx("button",{onClick:()=>Ts("active"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-colors ${ms==="active"?"bg-primary text-white":"text-slate-400 hover:text-white"}`,children:"Active Team"}),e.jsxs("button",{onClick:()=>Ts("pending"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-colors ${ms==="pending"?"bg-primary text-white":"text-slate-400 hover:text-white"}`,children:["Requests ",r.length>0&&e.jsx("span",{className:"ml-1 bg-red-500 text-white text-[10px] px-1.5 rounded-full",children:r.length})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 pb-20 space-y-3",children:ms==="active"?s.map(a=>{var D;return e.jsxs("div",{onClick:()=>He(a),className:"bg-surface-dark p-4 rounded-xl border border-white/5 flex items-center justify-between cursor-pointer hover:bg-white/5 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center overflow-hidden",children:a.avatar?e.jsx("img",{src:a.avatar,className:"w-full h-full object-cover"}):e.jsx("span",{className:"material-symbols-outlined text-slate-400",children:"person"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold",children:a.name}),e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded border ${a.role==="admin"?"border-purple-500 text-purple-400 bg-purple-500/10":"border-blue-500 text-blue-400 bg-blue-500/10"}`,children:a.role.toUpperCase()}),a.role==="washer"&&e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded border ${a.isAvailable?"border-green-500 text-green-400 bg-green-500/10":"border-slate-500 text-slate-400 bg-slate-500/10"}`,children:a.isAvailable?"AVAILABLE":"OFFLINE"})]}),e.jsx("p",{className:"text-xs text-slate-400",children:a.email}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsxs("span",{className:"text-[10px] bg-white/5 px-1.5 rounded text-slate-400",children:["Jobs: ",a.completedJobs||0]}),e.jsxs("span",{className:"text-[10px] bg-white/5 px-1.5 rounded text-slate-400",children:["Rating: ",((D=a.rating)==null?void 0:D.toFixed(1))||"N/A"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Ot(a),className:"p-2 text-slate-400 hover:text-white bg-white/5 hover:bg-white/10 rounded-lg transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",children:"edit"})}),e.jsx("button",{onClick:()=>m(a.id),className:`p-2 rounded-lg transition-colors ${a.status==="Blocked"?"text-red-400 bg-red-500/10 border border-red-500/20":"text-slate-400 hover:text-white bg-white/5 hover:bg-white/10"}`,children:e.jsx("span",{className:"material-symbols-outlined",children:a.status==="Blocked"?"lock":"lock_open"})}),e.jsx("button",{onClick:()=>{window.confirm(`Convert ${a.name} back to Client? They will lose team access.`)&&(F(a.id,{role:"client"}),U(`${a.name} is now a Client`,"info"))},className:"p-2 text-slate-400 hover:text-white bg-white/5 hover:bg-white/10 rounded-lg transition-colors",title:"Demote to Client",children:e.jsx("span",{className:"material-symbols-outlined",children:"person"})}),e.jsx("button",{onClick:()=>f(a.id),className:"p-2 text-red-400 hover:text-red-300 bg-red-500/10 hover:bg-red-500/20 rounded-lg transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",children:"delete"})})]})]},a.id)}):r.length===0?e.jsxs("div",{className:"text-center py-10 text-slate-500",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl mb-2 opacity-50",children:"inbox"}),e.jsx("p",{children:"No pending applications"})]}):r.map(a=>e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-500/10 flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-blue-400",children:"badge"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:a.name}),e.jsx("p",{className:"text-sm text-slate-400",children:a.email}),e.jsx("p",{className:"text-sm text-slate-400",children:a.phone||"No phone"})]})]}),e.jsx("span",{className:"bg-blue-500 text-white text-xs font-bold px-2 py-1 rounded",children:"APPLICANT"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4 text-xs text-slate-300 bg-black/20 p-3 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 block",children:"Experience:"})," ",a.experience||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 block",children:"Location:"})," ",a.city,", ",a.state]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 block",children:"Vehicle:"})," ",a.vehicleModel]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-500 block",children:"SSN:"})," ",a.ssn?"***-**-"+a.ssn.slice(-4):"N/A"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>O(a.id),className:"flex-1 py-2 rounded-lg border border-red-500/30 text-red-400 font-bold hover:bg-red-500/10 transition-colors",children:"Reject"}),e.jsx("button",{onClick:()=>P(a.id,a),className:"flex-1 py-2 rounded-lg bg-green-500 text-black font-bold hover:bg-green-400 transition-colors",children:"Request"})]})]},a.id))}),ft&&e.jsx("div",{className:"absolute inset-0 bg-black/80 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-surface-dark w-full max-w-md rounded-2xl border border-white/10 p-6 shadow-2xl animate-in zoom-in-95",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:H.id?"Edit Member":"Add New Member"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"text",placeholder:"Full Name",value:H.name,onChange:a=>ge({...H,name:a.target.value,id:H.id||""}),className:"w-full bg-black/30 border border-white/10 rounded-lg p-3 text-white focus:border-primary focus:outline-none"}),e.jsx("input",{type:"email",placeholder:"Email Address",value:H.email,onChange:a=>ge({...H,email:a.target.value,id:H.id||""}),className:"w-full bg-black/30 border border-white/10 rounded-lg p-3 text-white focus:border-primary focus:outline-none"}),!H.id&&e.jsx("input",{type:"password",placeholder:"Temporary Password",value:H.password,onChange:a=>ge({...H,password:a.target.value,id:H.id||""}),className:"w-full bg-black/30 border border-white/10 rounded-lg p-3 text-white focus:border-primary focus:outline-none"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 uppercase mb-1",children:"Role"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ge({...H,role:"washer",id:H.id||""}),className:`flex-1 py-2 rounded-lg border transition-colors ${H.role==="washer"?"bg-primary/20 border-primary text-white":"border-white/10 text-slate-400"}`,children:"Washer"}),e.jsx("button",{onClick:()=>ge({...H,role:"admin",id:H.id||""}),className:`flex-1 py-2 rounded-lg border transition-colors ${H.role==="admin"?"bg-purple-500/20 border-purple-500 text-white":"border-white/10 text-slate-400"}`,children:"Admin"})]})]}),H.role==="washer"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",placeholder:"Vehicle Plate",value:H.vehiclePlate||"",onChange:a=>ge({...H,vehiclePlate:a.target.value,id:H.id||""}),className:"w-full bg-black/30 border border-white/10 rounded-lg p-3 text-white focus:border-primary focus:outline-none"}),e.jsx("input",{type:"text",placeholder:"License Number",value:H.driverLicense||"",onChange:a=>ge({...H,driverLicense:a.target.value,id:H.id||""}),className:"w-full bg-black/30 border border-white/10 rounded-lg p-3 text-white focus:border-primary focus:outline-none"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>Ee(!1),className:"flex-1 py-3 rounded-xl bg-white/5 hover:bg-white/10 font-bold",children:"Cancel"}),e.jsx("button",{onClick:()=>{H.id?(F(H.id,H),U("Member profile updated","success"),Ee(!1)):Mt()},className:"flex-1 py-3 rounded-xl bg-primary text-black font-bold hover:bg-primary-dark",children:H.id?"Save Changes":"Create Member"})]})]})}),Ve&&e.jsx("div",{className:"absolute inset-0 bg-background-dark z-[70] flex flex-col",children:e.jsx(js,{washerId:Ve.id,orders:h,team:y,globalFees:re,navigate:u,onBack:()=>He(null),onViewOrder:a=>{ne(a)}})}),e.jsx(oe,{active:g.ADMIN_TEAM,navigate:u})]})}if(n===g.ADMIN_PAYROLL){const s=h.filter(o=>o.status==="Completed"&&o.washerId),r=hs.map(o=>{const w=s.filter(V=>V.washerId===o.id);let W=0,J=0;w.forEach(V=>{let E=0;V.vehicleConfigs?V.vehicleConfigs.forEach(Z=>{var he;const ee=k.find(xe=>xe.id===Z.packageId);ee&&Z.vehicleType&&(E+=ee.price[Z.vehicleType]||0),(he=Z.addonIds)==null||he.forEach(xe=>{const de=j.find(ue=>ue.id===xe);de&&Z.vehicleType&&(E+=de.price[Z.vehicleType]||0)})}):E=V.price||0;const Q=re.reduce((Z,ee)=>Z+ee.percentage,0),Ce=E*Q/100,je=E-Ce;W+=je,V.tip&&(J+=V.tip)});const K=Y.filter(V=>V.washerId===o.id&&V.status==="pending"),R=K.reduce((V,E)=>V+E.amount,0);return{washer:o,completedJobs:w.length,baseEarnings:W,tips:J,bonuses:R,totalEarnings:W+J+R,orders:w,bonusList:K}}).filter(o=>o.completedJobs>0),a=r.reduce((o,w)=>o+w.totalEarnings,0),D=r.reduce((o,w)=>o+w.completedJobs,0),$=r.reduce((o,w)=>o+w.tips,0),x=r.reduce((o,w)=>o+w.bonuses,0),M=async o=>{try{await rt({washerId:o.washer.id,washerName:o.washer.name,periodId:`week_${new Date().toISOString().split("T")[0]}`,baseEarnings:o.baseEarnings,tips:o.tips,bonuses:o.bonuses,deductions:0,totalPaid:o.totalEarnings,completedJobs:o.completedJobs,paidDate:new Date().toISOString(),paidBy:pe.id,paidByName:pe.name,notes:As,orderIds:o.orders.map(w=>w.id),paymentMethod:Ss});for(const w of o.bonusList)await fe(w.id,{status:"applied",appliedToPeriodId:`week_${new Date().toISOString().split("T")[0]}`});U(`Payment of $${o.totalEarnings.toFixed(2)} recorded for ${o.washer.name}`,"success"),ds(null),Ds("")}catch{U("Error recording payment","error")}},i=()=>{const o=r.map(E=>({"Washer Name":E.washer.name,Email:E.washer.email,Jobs:E.completedJobs,"Base Earnings":E.baseEarnings.toFixed(2),Tips:E.tips.toFixed(2),Bonuses:E.bonuses.toFixed(2),Total:E.totalEarnings.toFixed(2)})),w=Object.keys(o[0]).join(","),W=o.map(E=>Object.values(E).join(",")),J=[w,...W].join(`
`),K=new Blob([J],{type:"text/csv"}),R=window.URL.createObjectURL(K),V=document.createElement("a");V.href=R,V.download=`payroll_${new Date().toISOString().split("T")[0]}.csv`,V.click(),window.URL.revokeObjectURL(R)};return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white",children:[e.jsxs("header",{className:"p-4 border-b border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>u(g.ADMIN_DASHBOARD),className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Washer Payroll"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Manage payments & bonuses"})]})]}),e.jsxs("button",{onClick:i,className:"bg-white/5 hover:bg-white/10 transition-colors px-4 py-2 rounded-lg font-bold flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"download"}),"Export CSV"]})]}),e.jsxs("button",{onClick:()=>u(g.ADMIN_DASHBOARD),className:"w-full mt-2 bg-primary/10 border border-primary/20 hover:bg-primary/20 transition-colors px-4 py-2 rounded-lg font-bold flex items-center justify-center gap-2 text-sm",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"card_giftcard"}),"Manage Bonuses"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 pb-20",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsx("p",{className:"text-xs text-slate-400 uppercase font-bold mb-1",children:"Total Payroll"}),e.jsxs("p",{className:"text-2xl font-bold text-green-400",children:["$",a.toFixed(2)]})]}),e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsx("p",{className:"text-xs text-slate-400 uppercase font-bold mb-1",children:"Total Jobs"}),e.jsx("p",{className:"text-2xl font-bold",children:D})]}),e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsx("p",{className:"text-xs text-slate-400 uppercase font-bold mb-1",children:"Total Tips"}),e.jsxs("p",{className:"text-2xl font-bold text-amber-400",children:["$",$.toFixed(2)]})]}),e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsx("p",{className:"text-xs text-slate-400 uppercase font-bold mb-1",children:"Total Bonuses"}),e.jsxs("p",{className:"text-2xl font-bold text-green-400",children:["$",x.toFixed(2)]})]})]}),e.jsx("div",{className:"space-y-4",children:r.length===0?e.jsxs("div",{className:"text-center py-12 text-slate-500",children:[e.jsx("span",{className:"material-symbols-outlined text-6xl mb-4 opacity-20",children:"payments"}),e.jsx("p",{children:"No completed jobs this week"})]}):r.map(o=>e.jsxs("div",{className:"bg-surface-dark rounded-xl p-5 border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/20 flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-primary",children:"person"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:o.washer.name}),e.jsx("p",{className:"text-xs text-slate-400",children:o.washer.email})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-slate-400 uppercase font-bold",children:"Total to Pay"}),e.jsxs("p",{className:"text-2xl font-bold text-green-400",children:["$",o.totalEarnings.toFixed(2)]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-black/20 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Jobs"}),e.jsx("p",{className:"text-lg font-bold text-green-400",children:o.completedJobs})]}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Base"}),e.jsxs("p",{className:"text-lg font-bold",children:["$",o.baseEarnings.toFixed(2)]})]}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Tips"}),e.jsxs("p",{className:"text-lg font-bold text-amber-400",children:["$",o.tips.toFixed(2)]})]}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:"Bonuses"}),e.jsxs("p",{className:"text-lg font-bold text-green-400",children:["+$",o.bonuses.toFixed(2)]})]})]}),o.bonusList.length>0&&e.jsxs("div",{className:"mb-4 p-3 bg-green-500/10 border border-green-500/20 rounded-lg",children:[e.jsx("p",{className:"text-xs font-bold text-green-400 mb-2",children:"Pending Bonuses:"}),o.bonusList.map(w=>e.jsxs("div",{className:"text-xs text-slate-300 flex justify-between",children:[e.jsxs("span",{children:["â€¢ ",w.reason]}),e.jsxs("span",{className:"text-green-400",children:["+$",w.amount.toFixed(2)]})]},w.id))]}),vt===o.washer.id?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("select",{value:Ss,onChange:w=>yt(w.target.value),className:"w-full bg-black/20 border border-white/10 rounded-lg px-4 py-2 text-white text-sm",children:[e.jsx("option",{value:"transfer",children:"Bank Transfer"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"check",children:"Check"}),e.jsx("option",{value:"other",children:"Other"})]}),e.jsx("input",{type:"text",value:As,onChange:w=>Ds(w.target.value),placeholder:"Payment notes (optional)",className:"w-full bg-black/20 border border-white/10 rounded-lg px-4 py-2 text-white text-sm"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ds(null),className:"flex-1 bg-white/5 hover:bg-white/10 transition-colors rounded-lg py-2 font-bold text-sm",children:"Cancel"}),e.jsxs("button",{onClick:()=>M(o),className:"flex-1 bg-primary hover:bg-primary-dark transition-colors rounded-lg py-2 font-bold flex items-center justify-center gap-2 text-sm",children:[e.jsx("span",{className:"material-symbols-outlined text-sm",children:"check_circle"}),"Confirm Payment"]})]})]}):e.jsxs("button",{onClick:()=>ds(o.washer.id),className:"w-full bg-primary hover:bg-primary-dark transition-colors rounded-lg py-3 font-bold flex items-center justify-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined",children:"check_circle"}),"Mark as Paid"]})]},o.washer.id))})]}),e.jsx(oe,{active:g.ADMIN_PAYROLL,navigate:u})]})}if(n===g.ADMIN_SETTINGS)return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white",children:[e.jsxs("header",{className:"p-4 border-b border-white/5 flex items-center gap-3",children:[e.jsx("button",{onClick:()=>u(g.ADMIN_DASHBOARD),className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Settings"}),e.jsx("p",{className:"text-xs text-slate-400",children:"App configuration"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 pb-20 space-y-4",children:[e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400 text-xs uppercase font-bold",children:"Support Phone Number"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Displayed to washers in Help & Support"})]}),e.jsx("span",{className:"material-symbols-outlined text-primary",children:"phone"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"tel",value:N,onChange:s=>C(s.target.value),className:"flex-1 bg-black/30 border border-white/10 rounded-lg py-2 px-3 text-white placeholder:text-slate-500 focus:border-primary focus:outline-none transition-colors",placeholder:"+1 (555) 123-4567"}),e.jsx("button",{onClick:()=>U("Support phone number updated!","success"),className:"bg-primary hover:bg-primary-dark px-4 py-2 rounded-lg font-bold text-sm transition-colors",children:"Save"})]})]}),e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400 text-xs uppercase font-bold",children:"Report Email"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Receive daily financial reports"})]}),e.jsx("span",{className:"material-symbols-outlined text-primary",children:"mail"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"email",value:it||"",onChange:s=>ys&&ys(s.target.value),className:"flex-1 bg-black/30 border border-white/10 rounded-lg py-2 px-3 text-white placeholder:text-slate-500 focus:border-primary focus:outline-none transition-colors",placeholder:"reports@company.com"}),e.jsx("button",{onClick:()=>U("Report email updated!","success"),className:"bg-primary hover:bg-primary-dark px-4 py-2 rounded-lg font-bold text-sm transition-colors",children:"Save"})]})]}),e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-primary text-xs uppercase font-bold",children:"Manual Notifications Control"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Send notifications manually (Bypasses rules)"})]}),e.jsx("span",{className:"material-symbols-outlined text-primary",children:"campaign"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:async()=>{if(window.confirm("Do you want to send WEATHER notifications?")){const s=prompt("Enter temperature (F):","75");if(s===null)return;const r=prompt("Enter message:","â˜€ï¸ Perfect weather today! Great day to wash your car.");if(r===null)return;try{U("Sending weather notifications...","info");const D=await Js(Ys,"sendWeatherNotificationsManual")({temperature:parseInt(s),message:r});U(`Success: ${D.data.success} sent, ${D.data.failed} failed`,"success")}catch(a){console.error(a),U("Failed to send notifications: "+a.message,"error")}}},className:"bg-gradient-to-r from-orange-500/20 to-yellow-500/20 hover:from-orange-500/30 hover:to-yellow-500/30 border border-orange-500/30 rounded-xl p-4 flex items-center gap-3 transition-all",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-500/20 flex items-center justify-center text-orange-400",children:e.jsx("span",{className:"material-symbols-outlined",children:"sunny"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-bold text-orange-400",children:"Send Weather Alert"}),e.jsx("p",{className:"text-[10px] text-slate-400",children:"Send custom weather blast"})]})]}),e.jsxs("button",{onClick:async()=>{if(window.confirm("Do you want to send INACTIVITY reminders?")){const s=prompt("Minimum inactivity days:","14");if(s===null)return;try{U("Sending inactivity reminders...","info");const a=await Js(Ys,"sendInactivityRemindersManual")({minDays:parseInt(s)});U(`Success: ${a.data.success} sent, ${a.data.failed} failed`,"success")}catch(r){console.error(r),U("Failed to send reminders: "+r.message,"error")}}},className:"bg-gradient-to-r from-blue-500/20 to-purple-500/20 hover:from-blue-500/30 hover:to-purple-500/30 border border-blue-500/30 rounded-xl p-4 flex items-center gap-3 transition-all",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-400",children:e.jsx("span",{className:"material-symbols-outlined",children:"history"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-bold text-blue-400",children:"Send Inactivity"}),e.jsx("p",{className:"text-[10px] text-slate-400",children:"Remind inactive clients"})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-sm font-bold text-slate-400 uppercase",children:"Quick Access"}),e.jsxs("button",{onClick:()=>u(g.ADMIN_SERVICE_AREA),className:"w-full bg-surface-dark hover:bg-white/5 p-4 rounded-xl border border-white/5 flex items-center justify-between transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-500/10 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-blue-400",children:"location_on"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-bold",children:"Rango de trabajo"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Configure Service Radius"})]})]}),e.jsx("span",{className:"material-symbols-outlined text-slate-500 group-hover:text-primary group-hover:translate-x-1 transition-all",children:"arrow_forward"})]}),e.jsxs("button",{onClick:()=>u(g.ADMIN_PAYROLL),className:"w-full bg-surface-dark hover:bg-white/5 p-4 rounded-xl border border-white/5 flex items-center justify-between transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-primary",children:"payments"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-bold",children:"Washer Payroll"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Manage payments and bonuses"})]})]}),e.jsx("span",{className:"material-symbols-outlined text-slate-500 group-hover:text-primary group-hover:translate-x-1 transition-all",children:"arrow_forward"})]}),e.jsxs("button",{onClick:()=>u(g.ADMIN_DISCOUNTS),className:"w-full bg-surface-dark hover:bg-white/5 p-4 rounded-xl border border-white/5 flex items-center justify-between transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-500/10 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-purple-400",children:"discount"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-bold",children:"Discount Codes"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Manage promotional discounts"})]})]}),e.jsx("span",{className:"material-symbols-outlined text-slate-500 group-hover:text-primary group-hover:translate-x-1 transition-all",children:"arrow_forward"})]}),e.jsxs("button",{onClick:()=>u(g.ADMIN_FINANCIAL_REPORTS),className:"w-full bg-surface-dark hover:bg-white/5 p-4 rounded-xl border border-white/5 flex items-center justify-between transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-500/10 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-green-400",children:"assessment"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-bold",children:"Financial Reports"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Metrics and tax exports"})]})]}),e.jsx("span",{className:"material-symbols-outlined text-slate-500 group-hover:text-primary group-hover:translate-x-1 transition-all",children:"arrow_forward"})]}),e.jsxs("button",{onClick:()=>u(g.ADMIN_ISSUES),className:"w-full bg-surface-dark hover:bg-white/5 p-4 rounded-xl border border-white/5 flex items-center justify-between transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-red-500/10 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-red-400",children:"report_problem"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-bold",children:"Support Issues"}),e.jsx("p",{className:"text-xs text-slate-400",children:"View and manage client reports"})]})]}),e.jsx("span",{className:"material-symbols-outlined text-slate-500 group-hover:text-primary group-hover:translate-x-1 transition-all",children:"arrow_forward"})]})]})]}),e.jsx(oe,{active:g.ADMIN_SETTINGS,navigate:u})]});if(n===g.ADMIN_SERVICE_AREA)return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white",children:[e.jsxs("header",{className:"p-4 border-b border-white/5 flex items-center gap-3",children:[e.jsx("button",{onClick:()=>u(g.ADMIN_DASHBOARD),className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Rango de trabajo"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Configure operational area"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 pb-20",children:e.jsx(ra,{serviceArea:dt,onSave:async s=>{await nt(s),U("Service area updated successfully","success"),u(g.ADMIN_DASHBOARD)}})}),e.jsx(oe,{active:g.ADMIN_DASHBOARD,navigate:u})]});if(n===g.ADMIN_FINANCIAL_REPORTS){const s=["January","February","March","April","May","June","July","August","September","October","November","December"],a=(()=>{const $={totalRevenue:0,washerPayments:0,adminCommission:0,orderCount:0,breakdown:s.map(x=>({month:x,totalRevenue:0,washerPayments:0,adminCommission:0,orderCount:0})),washerPayouts:{},transactions:[]};try{const x=s.map(R=>({month:R,totalRevenue:0,washerPayments:0,adminCommission:0,orderCount:0})),M={},i=[];if(!h||!Array.isArray(h))return $;let o=0,w=0,W=0,J=0;return h.filter(R=>R.status==="Completed").forEach(R=>{var V;try{const E=ie(R.createdAt||R.date);if(isNaN(E.getTime())||E.getFullYear()!==Pe)return;const Q=R.basePrice||R.price||0,Ce=R.tip||0,je=Q+Ce;let Z=0,ee=0;R.vehicleConfigs&&Array.isArray(R.vehicleConfigs)?R.vehicleConfigs.forEach(de=>{var Bs,Ws;const ue=k==null?void 0:k.find(_e=>_e.id===de.packageId);if(ue&&de.vehicleType){const _e=((Bs=ue.price)==null?void 0:Bs[de.vehicleType])||0,$e=ue.washerCommission||80;Z+=_e*$e/100,ee+=_e*(100-$e)/100}(Ws=de.addonIds)==null||Ws.forEach(_e=>{var Us;const $e=j==null?void 0:j.find(Ze=>Ze.id===_e);if($e&&de.vehicleType){const Ze=((Us=$e.price)==null?void 0:Us[de.vehicleType])||0,zs=$e.washerCommission||80;Z+=Ze*zs/100,ee+=Ze*(100-zs)/100}})}):(Z=Q*.8,ee=Q*.2),Z+=Ce,o+=je,w+=Z,W+=ee,J++;const he=E.getMonth();x[he].totalRevenue+=je,x[he].washerPayments+=Z,x[he].adminCommission+=ee,x[he].orderCount++;const xe=((V=R.assignedTo)==null?void 0:V[0])||R.washerId;if(xe){if(!M[xe]){const de=y.find(ue=>ue.id===xe);M[xe]={name:de?de.name:"Unknown Washer",amount:0,jobs:0}}M[xe].amount+=Z,M[xe].jobs+=1}i.push({id:R.id,date:E.toLocaleDateString(),clientName:R.clientName||"Client",amount:je,washerPay:Z,washerId:xe})}catch(E){console.warn("Skipping malformed order:",R.id,E)}}),i.sort((R,V)=>new Date(V.date).getTime()-new Date(R.date).getTime()),{totalRevenue:o,washerPayments:w,adminCommission:W,orderCount:J,breakdown:x,washerPayouts:M,transactions:i}}catch(x){return console.error("Critical error in financial report calculation",x),$}})(),D=()=>{const x=[["FINANCIAL REPORT",`YEAR ${Pe}`],["Generated",new Date().toLocaleDateString()],[""],["SUMMARY"],["Total Revenue",`$${a.totalRevenue.toFixed(2)}`],["Washer Payments",`$${a.washerPayments.toFixed(2)}`],["Net Profit",`$${a.adminCommission.toFixed(2)}`],["Total Orders",a.orderCount.toString()],[""],["MONTHLY BREAKDOWN"],["Month","Orders","Revenue","Washer Pay","Net Profit"],...a.breakdown.map(w=>[w.month,w.orderCount.toString(),`$${w.totalRevenue.toFixed(2)}`,`$${w.washerPayments.toFixed(2)}`,`$${w.adminCommission.toFixed(2)}`]),[""],["WASHER PAYOUTS"],["Washer Name","Jobs Completed","Total Payout"],...Object.entries(a.washerPayouts).map(([,w])=>[w.name,w.jobs.toString(),`$${w.amount.toFixed(2)}`]),[""],["TRANSACTION HISTORY"],["Date","Order ID","Client","Total Amount","Washer Pay"],...a.transactions.map(w=>[w.date,w.id,w.clientName,`$${w.amount.toFixed(2)}`,`$${w.washerPay.toFixed(2)}`])].map(w=>w.join(",")).join(`
`),M=new Blob([x],{type:"text/csv"}),i=window.URL.createObjectURL(M),o=document.createElement("a");o.href=i,o.download=`financial-report-${Pe}.csv`,o.click(),U("Report exported successfully","success")};return e.jsxs("div",{className:"flex flex-col h-full bg-background-dark text-white",children:[e.jsxs("header",{className:"p-4 border-b border-white/5 flex items-center gap-3",children:[e.jsx("button",{onClick:()=>u(g.ADMIN_DASHBOARD),className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10 transition-colors",children:e.jsx("span",{className:"material-symbols-outlined",children:"arrow_back"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Financial Reports"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Tax documents & metrics"})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 pb-20 space-y-4",children:[e.jsxs("div",{className:"bg-surface-dark p-4 rounded-xl border border-white/5",children:[e.jsx("label",{className:"block text-sm font-bold mb-2",children:"Select Year"}),e.jsx("select",{value:Pe,onChange:$=>pt(parseInt($.target.value)),className:"w-full bg-black/30 border border-white/10 rounded-lg px-4 py-2 text-white",children:[2023,2024,2025,2026].map($=>e.jsx("option",{value:$,children:$},$))})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2 border-b border-white/10 pb-4",children:[e.jsx("h2",{className:"text-xs font-bold text-slate-500 uppercase",children:"Annual Summary"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"bg-surface-dark p-3 rounded-xl border border-white/5 text-center",children:[e.jsx("span",{className:"text-xs text-green-400 font-bold block",children:"Revenue"}),e.jsxs("span",{className:"text-sm font-bold text-white",children:["$",a.totalRevenue.toFixed(0)]})]}),e.jsxs("div",{className:"bg-surface-dark p-3 rounded-xl border border-white/5 text-center",children:[e.jsx("span",{className:"text-xs text-blue-400 font-bold block",children:"Washer"}),e.jsxs("span",{className:"text-sm font-bold text-white",children:["$",a.washerPayments.toFixed(0)]})]}),e.jsxs("div",{className:"bg-surface-dark p-3 rounded-xl border border-white/5 text-center",children:[e.jsx("span",{className:"text-xs text-purple-400 font-bold block",children:"Profit"}),e.jsxs("span",{className:"text-sm font-bold text-white",children:["$",a.adminCommission.toFixed(0)]})]})]})]}),e.jsxs("div",{className:"bg-surface-dark rounded-xl border border-white/5 overflow-hidden",children:[e.jsxs("div",{className:"p-3 bg-black/20 border-b border-white/5 flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-sm",children:"Monthly Breakdown"}),e.jsxs("span",{className:"text-xs text-slate-500",children:["Jan - Dec ",Pe]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-400 border-b border-white/5",children:[e.jsx("th",{className:"p-3 font-medium",children:"Month"}),e.jsx("th",{className:"p-3 font-medium text-right",children:"Orders"}),e.jsx("th",{className:"p-3 font-medium text-right",children:"Revenue"}),e.jsx("th",{className:"p-3 font-medium text-right",children:"Profit"})]})}),e.jsx("tbody",{children:a.breakdown.map($=>e.jsxs("tr",{className:"border-b border-white/5 last:border-0 hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"p-3 font-medium text-slate-300",children:$.month}),e.jsx("td",{className:"p-3 text-right text-slate-400",children:$.orderCount}),e.jsxs("td",{className:"p-3 text-right text-green-400/80",children:["$",$.totalRevenue.toFixed(0)]}),e.jsxs("td",{className:"p-3 text-right text-purple-400/80 font-bold",children:["$",$.adminCommission.toFixed(0)]})]},$.month))})]})})]}),e.jsxs("div",{className:"bg-surface-dark rounded-xl border border-white/5 overflow-hidden",children:[e.jsxs("div",{className:"p-3 bg-black/20 border-b border-white/5 flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-sm text-blue-400",children:"Washer Payouts"}),e.jsxs("span",{className:"text-xs text-slate-500",children:["Total Paid: $",a.washerPayments.toFixed(0)]})]}),e.jsx("div",{className:"overflow-x-auto max-h-60 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-400 border-b border-white/5",children:[e.jsx("th",{className:"p-3 font-medium",children:"Washer Name"}),e.jsx("th",{className:"p-3 font-medium text-right",children:"Jobs"}),e.jsx("th",{className:"p-3 font-medium text-right",children:"Total Payout"})]})}),e.jsx("tbody",{children:Object.entries(a.washerPayouts).length>0?Object.entries(a.washerPayouts).map(([$,x])=>e.jsxs("tr",{className:"border-b border-white/5 last:border-0 hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"p-3 font-medium text-slate-300",children:x.name}),e.jsx("td",{className:"p-3 text-right text-slate-400",children:x.jobs}),e.jsxs("td",{className:"p-3 text-right text-blue-400 font-bold",children:["$",x.amount.toFixed(2)]})]},$)):e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"p-4 text-center text-slate-500",children:"No washer data available"})})})]})})]}),e.jsxs("div",{className:"bg-surface-dark rounded-xl border border-white/5 overflow-hidden",children:[e.jsxs("div",{className:"p-3 bg-black/20 border-b border-white/5 flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-sm text-amber-400",children:"Transaction History"}),e.jsxs("span",{className:"text-xs text-slate-500",children:[a.transactions.length," Transactions"]})]}),e.jsx("div",{className:"overflow-x-auto max-h-80 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-slate-400 border-b border-white/5",children:[e.jsx("th",{className:"p-3 font-medium",children:"Date"}),e.jsx("th",{className:"p-3 font-medium",children:"Client"}),e.jsx("th",{className:"p-3 font-medium text-right",children:"Total"}),e.jsx("th",{className:"p-3 font-medium text-right",children:"Washer Pay"})]})}),e.jsx("tbody",{children:a.transactions.length>0?a.transactions.map(($,x)=>e.jsxs("tr",{className:"border-b border-white/5 last:border-0 hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"p-3 font-medium text-slate-300 text-xs",children:$.date}),e.jsx("td",{className:"p-3 text-slate-400 text-xs",children:$.clientName}),e.jsxs("td",{className:"p-3 text-right text-green-400/80 font-mono text-xs",children:["$",$.amount.toFixed(2)]}),e.jsxs("td",{className:"p-3 text-right text-blue-400/80 font-mono text-xs",children:["$",$.washerPay.toFixed(2)]})]},x)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-4 text-center text-slate-500",children:"No transactions found"})})})]})})]}),e.jsxs("button",{onClick:D,className:"w-full bg-primary hover:bg-primary-dark transition-colors p-4 rounded-xl flex items-center justify-center gap-2 font-bold mt-4",children:[e.jsx("span",{className:"material-symbols-outlined",children:"download"}),"Export Full Report (CSV)"]}),e.jsx("p",{className:"text-center text-xs text-slate-500 mt-2",children:"Includes Monthly, Washer, and Transaction details"})]}),e.jsx(oe,{active:g.ADMIN_FINANCIAL_REPORTS,navigate:u})]})}return n===g.ADMIN_DISCOUNTS?e.jsx(Zt,{discounts:G,navigate:u,currentUser:pe,createDiscount:tt,updateDiscount:at,deleteDiscount:lt,showToast:U}):n==="ADMIN_BONUSES"?e.jsx(sa,{bonuses:Y,team:y,navigate:u,currentUser:pe,createBonus:Ne,updateBonus:fe,deleteBonus:Le,showToast:U}):n===g.ADMIN_ISSUES?e.jsx(ca,{currentUser:pe,navigate:u}):n===g.ADMIN_FINANCIAL_REPORTS?e.jsxs("div",{className:`flex h-full bg-background-dark ${q?"flex-row":"flex-col"}`,children:[q&&e.jsx(ke,{}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(xa,{orders:h,team:y,navigate:u})}),!q&&e.jsx(oe,{active:n,navigate:u})]}):n===g.ADMIN_WASHER_EARNINGS?e.jsxs("div",{className:`flex h-full bg-background-dark ${q?"flex-row":"flex-col"}`,children:[q&&e.jsx(ke,{}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(ma,{orders:h,team:y,navigate:(s,r)=>{r&&kt(r),u(s)}})}),!q&&e.jsx(oe,{active:n,navigate:u})]}):n===g.ADMIN_WASHER_HISTORY?e.jsxs("div",{className:`flex h-full bg-background-dark ${q?"flex-row":"flex-col"}`,children:[q&&e.jsx(ke,{}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(js,{washerId:wt,orders:h,team:y,globalFees:re,navigate:u,onBack:()=>u(g.ADMIN_WASHER_EARNINGS),onViewOrder:s=>ne(s)})}),!q&&e.jsx(oe,{active:n,navigate:u})]}):n===g.ADMIN_APP_EARNINGS?e.jsxs("div",{className:`flex h-full bg-background-dark ${q?"flex-row":"flex-col"}`,children:[q&&e.jsx(ke,{}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(ha,{orders:h})}),!q&&e.jsx(oe,{active:n,navigate:u})]}):n===g.ADMIN_TAX_REPORTS?e.jsxs("div",{className:`flex h-full bg-background-dark ${q?"flex-row":"flex-col"}`,children:[q&&e.jsx(ke,{}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(pa,{orders:h,team:y})}),!q&&e.jsx(oe,{active:n,navigate:u})]}):n===g.ADMIN_QUOTES?e.jsxs("div",{className:`flex h-full bg-background-dark ${q?"flex-row":"flex-col"}`,children:[q&&e.jsx(ke,{}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(ua,{navigate:u})}),!q&&e.jsx(oe,{active:n,navigate:u})]}):e.jsx("div",{className:"text-white",children:"Screen not found"})};export{La as AdminScreens};
